/* Shield UI 1.7.44 Trial Version | Copyright 2013-2022 Shield UI Ltd. | http://www.shieldui.com/eula | Expires on Tue, 13 Sep 2022 03:00:24 GMT */
function f(e){this.ok=!1,e=(e=(e="#"==e.charAt(0)?e.substr(1,6):e).replace(/ /g,"")).toLowerCase();var t,u={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(t in u)e==t&&(e=u[t]);for(var c=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],n=0;n<c.length;n++){var i=c[n].re,r=c[n].process,i=i.exec(e);i&&(channels=r(i),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:255<this.r?255:this.r,this.g=this.g<0||isNaN(this.g)?0:255<this.g?255:this.g,this.b=this.b<0||isNaN(this.b)?0:255<this.b?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return"#"+(e=1==e.length?"0"+e:e)+(t=1==t.length?"0"+t:t)+(n=1==n.length?"0"+n:n)},this.getHelpXML=function(){for(var e,t=new Array,n=0;n<c.length;n++)for(var i=c[n].example,r=0;r<i.length;r++)t[t.length]=i[r];for(e in u)t[t.length]=e;var a=document.createElement("ul");a.setAttribute("id","rgbcolor-examples");for(n=0;n<t.length;n++)try{var s=document.createElement("li"),o=new f(t[n]),l=document.createElement("div"),h=(l.style.cssText="margin: 3px; border: 1px solid black; background:"+o.toHex()+"; color:"+o.toHex(),l.appendChild(document.createTextNode("test")),document.createTextNode(" "+t[n]+" -> "+o.toRGB()+" -> "+o.toHex()));s.appendChild(l),s.appendChild(h),a.appendChild(s)}catch(e){}return a}}!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(h){var u,c,e=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],t="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],f=Array.prototype.slice;if(h.event.fixHooks)for(var n=e.length;n;)h.event.fixHooks[e[--n]]=h.event.mouseHooks;var d=h.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],i,!1);else this.onmousewheel=i;h.data(this,"mousewheel-line-height",d.getLineHeight(this)),h.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],i,!1);else this.onmousewheel=null;h.removeData(this,"mousewheel-line-height"),h.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var e=h(e),t=e["offsetParent"in h.fn?"offsetParent":"parent"]();return t.length||(t=h("body")),parseInt(t.css("fontSize"),10)||parseInt(e.css("fontSize"),10)||16},getPageHeight:function(e){return h(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function i(e){var t,n=e||window.event,i=f.call(arguments,1),r=0,a=0,s=0,o=0,l=0;if((e=h.event.fix(n)).type="mousewheel","detail"in n&&(s=-1*n.detail),"wheelDelta"in n&&(s=n.wheelDelta),"wheelDeltaY"in n&&(s=n.wheelDeltaY),"wheelDeltaX"in n&&(a=-1*n.wheelDeltaX),"axis"in n&&n.axis===n.HORIZONTAL_AXIS&&(a=-1*s,s=0),r=0===s?a:s,"deltaY"in n&&(r=s=-1*n.deltaY),"deltaX"in n&&(a=n.deltaX,0===s&&(r=-1*a)),0!==s||0!==a)return 1===n.deltaMode?(r*=t=h.data(this,"mousewheel-line-height"),s*=t,a*=t):2===n.deltaMode&&(r*=t=h.data(this,"mousewheel-page-height"),s*=t,a*=t),t=Math.max(Math.abs(s),Math.abs(a)),(!c||t<c)&&g(n,c=t)&&(c/=40),g(n,t)&&(r/=40,a/=40,s/=40),r=Math[1<=r?"floor":"ceil"](r/c),a=Math[1<=a?"floor":"ceil"](a/c),s=Math[1<=s?"floor":"ceil"](s/c),d.settings.normalizeOffset&&this.getBoundingClientRect&&(n=this.getBoundingClientRect(),o=e.clientX-n.left,l=e.clientY-n.top),e.deltaX=a,e.deltaY=s,e.deltaFactor=c,e.offsetX=o,e.offsetY=l,e.deltaMode=0,i.unshift(e,r,a,s),u&&clearTimeout(u),u=setTimeout(p,200),(h.event.dispatch||h.event.handle).apply(this,i)}function p(){c=null}function g(e,t){return d.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}h.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),function(){this.canvg=function(e,t,n){if(null==e&&null==t&&null==n)for(var r=document.getElementsByTagName("svg"),a=0;a<r.length;a++){var s=r[a],o=document.createElement("canvas"),l=(o.width=s.clientWidth,o.height=s.clientHeight,s.parentNode.insertBefore(o,s),s.parentNode.removeChild(s),document.createElement("div"));l.appendChild(s),canvg(o,l.innerHTML)}else{n=n||{},null!=(e="string"==typeof e?document.getElementById(e):e).svg&&e.svg.stop();(P={FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,init:function(e){P.Definitions={},P.Styles={},P.Animations=[],P.Images=[],P.ctx=e,P.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(e,t){this.viewPorts.push({width:e,height:t})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(e){return null!=e&&"number"==typeof e?e:"x"==e?this.width():"y"==e?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}}}).init(),P.ImagesLoaded=function(){for(var e=0;e<P.Images.length;e++)if(!P.Images[e].loaded)return!1;return!0},P.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},P.compressSpaces=function(e){return e.replace(/[\s\r\t\n]+/gm," ")},P.ajax=function(e){var t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return t?(t.open("GET",e,!1),t.send(null),t.responseText):null},P.parseXml=function(e){var t;return window.DOMParser?(new DOMParser).parseFromString(e,"text/xml"):(e=e.replace(/<!DOCTYPE svg[^>]*>/,""),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e),t)},P.Property=function(e,t){this.name=e,this.value=t},P.Property.prototype.getValue=function(){return this.value},P.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},P.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var e=parseFloat(this.value);return(this.value+"").match(/%$/)&&(e/=100),e},P.Property.prototype.valueOrDefault=function(e){return this.hasValue()?this.value:e},P.Property.prototype.numValueOrDefault=function(e){return this.hasValue()?this.numValue():e},P.Property.prototype.addOpacity=function(e){var t,n=this.value;return null!=e&&""!=e&&"string"==typeof this.value&&(t=new f(this.value)).ok&&(n="rgba("+t.r+", "+t.g+", "+t.b+", "+e+")"),new P.Property(this.name,n)},P.Property.prototype.getDefinition=function(){var e=this.value.match(/#([^\)']+)/);return e=(e=e&&e[1])||this.value,P.Definitions[e]},P.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},P.Property.prototype.getFillStyleDefinition=function(e,t){var n=this.getDefinition();return null!=n&&n.createGradient?n.createGradient(P.ctx,e,t):null!=n&&n.createPattern?n.createPattern(P.ctx,e):null},P.Property.prototype.getDPI=function(e){return 96},P.Property.prototype.getEM=function(e){var t=12,n=new P.Property("fontSize",P.Font.Parse(P.ctx.font).fontSize);return t=n.hasValue()?n.toPixels(e):t},P.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},P.Property.prototype.toPixels=function(e,t){if(!this.hasValue())return 0;var n=this.value+"";if(n.match(/em$/))return this.numValue()*this.getEM(e);if(n.match(/ex$/))return this.numValue()*this.getEM(e)/2;if(n.match(/px$/))return this.numValue();if(n.match(/pt$/))return this.numValue()*this.getDPI(e)*(1/72);if(n.match(/pc$/))return 15*this.numValue();if(n.match(/cm$/))return this.numValue()*this.getDPI(e)/2.54;if(n.match(/mm$/))return this.numValue()*this.getDPI(e)/25.4;if(n.match(/in$/))return this.numValue()*this.getDPI(e);if(n.match(/%$/))return this.numValue()*P.ViewPort.ComputeSize(e);n=this.numValue();return t&&n<1?n*P.ViewPort.ComputeSize(e):n},P.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/s$/)?1e3*this.numValue():(e.match(/ms$/),this.numValue())},P.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/deg$/)?this.numValue()*(Math.PI/180):e.match(/grad$/)?this.numValue()*(Math.PI/200):e.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)},P.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(e,t,n,i,r,a){a=null!=a?this.Parse(a):this.CreateFont("","","","","",P.ctx.font);return{fontFamily:r||a.fontFamily,fontSize:i||a.fontSize,fontStyle:e||a.fontStyle,fontWeight:n||a.fontWeight,fontVariant:t||a.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var s=this;this.Parse=function(e){for(var t={},n=P.trim(P.compressSpaces(e||"")).split(" "),i={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},r="",a=0;a<n.length;a++)i.fontStyle||-1==s.Styles.indexOf(n[a])?i.fontVariant||-1==s.Variants.indexOf(n[a])?i.fontWeight||-1==s.Weights.indexOf(n[a])?i.fontSize?"inherit"!=n[a]&&(r+=n[a]):("inherit"!=n[a]&&(t.fontSize=n[a].split("/")[0]),i.fontStyle=i.fontVariant=i.fontWeight=i.fontSize=!0):("inherit"!=n[a]&&(t.fontWeight=n[a]),i.fontStyle=i.fontVariant=i.fontWeight=!0):("inherit"!=n[a]&&(t.fontVariant=n[a]),i.fontStyle=i.fontVariant=!0):("inherit"!=n[a]&&(t.fontStyle=n[a]),i.fontStyle=!0);return""!=r&&(t.fontFamily=r),t}},P.ToNumberArray=function(e){for(var t=P.trim(P.compressSpaces((e||"").replace(/,/g," "))).split(" "),n=0;n<t.length;n++)t[n]=parseFloat(t[n]);return t},P.Point=function(e,t){this.x=e,this.y=t},P.Point.prototype.angleTo=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},P.Point.prototype.applyTransform=function(e){var t=this.x*e[0]+this.y*e[2]+e[4],e=this.x*e[1]+this.y*e[3]+e[5];this.x=t,this.y=e},P.CreatePoint=function(e){e=P.ToNumberArray(e);return new P.Point(e[0],e[1])},P.CreatePath=function(e){for(var t=P.ToNumberArray(e),n=[],i=0;i<t.length;i+=2)n.push(new P.Point(t[i],t[i+1]));return n},P.BoundingBox=function(e,t,n,r){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(e,t){null!=e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),null!=t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},this.addX=function(e){this.addPoint(e,null)},this.addY=function(e){this.addPoint(null,e)},this.addBoundingBox=function(e){this.addPoint(e.x1,e.y1),this.addPoint(e.x2,e.y2)},this.addQuadraticCurve=function(e,t,n,i,r,a){n=e+2/3*(n-e),i=t+2/3*(i-t);this.addBezierCurve(e,t,n,n+1/3*(r-e),i,i+1/3*(a-t),r,a)},this.addBezierCurve=function(e,t,n,r,a,s,o,l){var h=[e,t],u=[n,r],c=[a,s],f=[o,l];for(this.addPoint(h[0],h[1]),this.addPoint(f[0],f[1]),i=0;i<=1;i++){function d(e){return Math.pow(1-e,3)*h[i]+3*Math.pow(1-e,2)*e*u[i]+3*(1-e)*Math.pow(e,2)*c[i]+Math.pow(e,3)*f[i]}var p,g=6*h[i]-12*u[i]+6*c[i],m=-3*h[i]+9*u[i]-9*c[i]+3*f[i],x=3*u[i]-3*h[i];0==m?0==g||0<(p=-x/g)&&p<1&&(0==i&&this.addX(d(p)),1==i&&this.addY(d(p))):(p=Math.pow(g,2)-4*x*m)<0||(0<(x=(-g+Math.sqrt(p))/(2*m))&&x<1&&(0==i&&this.addX(d(x)),1==i&&this.addY(d(x))),0<(x=(-g-Math.sqrt(p))/(2*m))&&x<1&&(0==i&&this.addX(d(x)),1==i&&this.addY(d(x))))}},this.isPointInBox=function(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2},this.addPoint(e,t),this.addPoint(n,r)},P.Transform=function(e){for(var t=this,n=(this.Type={},this.Type.translate=function(e){this.p=P.CreatePoint(e),this.apply=function(e){e.translate(this.p.x||0,this.p.y||0)},this.applyToPoint=function(e){e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(e){e=P.ToNumberArray(e);this.angle=new P.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(e){e.translate(this.cx,this.cy),e.rotate(this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.applyToPoint=function(e){var t=this.angle.toRadians();e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),e.applyTransform([Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0]),e.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(e){this.p=P.CreatePoint(e),this.apply=function(e){e.scale(this.p.x||1,this.p.y||this.p.x||1)},this.applyToPoint=function(e){e.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(e){this.m=P.ToNumberArray(e),this.apply=function(e){e.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.applyToPoint=function(e){e.applyTransform(this.m)}},this.Type.SkewBase=function(e){this.base=t.Type.matrix,this.base(e),this.angle=new P.Property("angle",e)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(e){this.base=t.Type.SkewBase,this.base(e),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(e){this.base=t.Type.SkewBase,this.base(e),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(e)},this.applyToPoint=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].applyToPoint(e)},P.trim(P.compressSpaces(e)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)),i=0;i<n.length;i++){var r=n[i].split("(")[0],a=n[i].split("(")[1].replace(")",""),a=new this.Type[r](a);a.type=r,this.transforms.push(a)}},P.AspectRatio=function(e,t,n,i,r,a,s,o,l,h){var u=(t=(t=P.compressSpaces(t)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",t=t.split(" ")[1]||"meet",c=n/i,f=r/a,d=Math.min(c,f),p=Math.max(c,f);"meet"==t&&(i*=d,a*=d),"slice"==t&&(i*=p,a*=p),l=new P.Property("refX",l),h=new P.Property("refY",h),l.hasValue()&&h.hasValue()?e.translate(-d*l.toPixels("x"),-d*h.toPixels("y")):(u.match(/^xMid/)&&("meet"==t&&d==f||"slice"==t&&p==f)&&e.translate(n/2-i/2,0),u.match(/YMid$/)&&("meet"==t&&d==c||"slice"==t&&p==c)&&e.translate(0,r/2-a/2),u.match(/^xMax/)&&("meet"==t&&d==f||"slice"==t&&p==f)&&e.translate(n-i,0),u.match(/YMax$/)&&("meet"==t&&d==c||"slice"==t&&p==c)&&e.translate(0,r-a)),"none"==u?e.scale(c,f):"meet"==t?e.scale(d,d):"slice"==t&&e.scale(p,p),e.translate(null==s?0:-s,null==o?0:-o)},P.Element={},P.EmptyProperty=new P.Property("EMPTY",""),P.Element.ElementBase=function(e){if(this.attributes={},this.styles={},this.children=[],this.attribute=function(e,t){var n=this.attributes[e];return null!=n?n:(1==t&&(n=new P.Property(e,""),this.attributes[e]=n),n||P.EmptyProperty)},this.style=function(e,t){var n=this.styles[e];if(null!=n)return n;var i=this.attribute(e);if(null!=i&&i.hasValue())return this.styles[e]=i;i=this.parent;if(null!=i){i=i.style(e);if(null!=i&&i.hasValue())return i}return 1==t&&(n=new P.Property(e,""),this.styles[e]=n),n||P.EmptyProperty},this.render=function(e){var t;"none"!=this.style("display").value&&"hidden"!=this.attribute("visibility").value&&(e.save(),this.attribute("mask").hasValue()?null!=(t=this.attribute("mask").getDefinition())&&t.apply(e,this):this.style("filter").hasValue()?null!=(t=this.style("filter").getDefinition())&&t.apply(e,this):(this.setContext(e),this.renderChildren(e),this.clearContext(e)),e.restore())},this.setContext=function(e){},this.clearContext=function(e){},this.renderChildren=function(e){for(var t=0;t<this.children.length;t++)this.children[t].render(e)},this.addChild=function(e,t){var n=e;((n=t?P.CreateElement(e):n).parent=this).children.push(n)},null!=e&&1==e.nodeType){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];1==n.nodeType&&this.addChild(n,!0),this.captureTextNodes&&3==n.nodeType&&this.addChild(new P.Element.tspan(n),!1)}for(t=0;t<e.attributes.length;t++){var i=e.attributes[t];this.attributes[i.nodeName]=new P.Property(i.nodeName,i.nodeValue)}if(null!=(l=P.Styles[e.nodeName]))for(var r in l)this.styles[r]=l[r];if(this.attribute("class").hasValue())for(var a=P.compressSpaces(this.attribute("class").value).split(" "),s=0;s<a.length;s++){if(null!=(l=P.Styles["."+a[s]]))for(var r in l)this.styles[r]=l[r];if(null!=(l=P.Styles[e.nodeName+"."+a[s]]))for(var r in l)this.styles[r]=l[r]}if(this.attribute("id").hasValue())if(null!=(l=P.Styles["#"+this.attribute("id").value]))for(var r in l)this.styles[r]=l[r];if(this.attribute("style").hasValue())for(var o,l=this.attribute("style").value.split(";"),t=0;t<l.length;t++)""!=P.trim(l[t])&&(o=l[t].split(":"),r=P.trim(o[0]),o=P.trim(o[1]),this.styles[r]=new P.Property(r,o));this.attribute("id").hasValue()&&null==P.Definitions[this.attribute("id").value]&&(P.Definitions[this.attribute("id").value]=this)}},P.Element.RenderedElementBase=function(e){this.base=P.Element.ElementBase,this.base(e),this.setContext=function(e){var t,n,i;this.style("fill").isUrlDefinition()?null!=(i=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")))&&(e.fillStyle=i):this.style("fill").hasValue()&&("currentColor"==(n=this.style("fill")).value&&(n.value=this.style("color").value),e.fillStyle="none"==n.value?"rgba(0,0,0,0)":n.value),this.style("fill-opacity").hasValue()&&(n=(n=new P.Property("fill",e.fillStyle)).addOpacity(this.style("fill-opacity").value),e.fillStyle=n.value),this.style("stroke").isUrlDefinition()?null!=(i=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")))&&(e.strokeStyle=i):this.style("stroke").hasValue()&&("currentColor"==(t=this.style("stroke")).value&&(t.value=this.style("color").value),e.strokeStyle="none"==t.value?"rgba(0,0,0,0)":t.value),this.style("stroke-opacity").hasValue()&&(t=(t=new P.Property("stroke",e.strokeStyle)).addOpacity(this.style("stroke-opacity").value),e.strokeStyle=t.value),this.style("stroke-width").hasValue()&&(n=this.style("stroke-width").toPixels(),e.lineWidth=0==n?.001:n),this.style("stroke-linecap").hasValue()&&(e.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(e.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(e.miterLimit=this.style("stroke-miterlimit").value),void 0!==e.font&&(e.font=P.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()&&new P.Transform(this.attribute("transform").value).apply(e),this.attribute("clip-path").hasValue()&&null!=(i=this.attribute("clip-path").getDefinition())&&i.apply(e),this.style("opacity").hasValue()&&(e.globalAlpha=this.style("opacity").numValue())}},P.Element.RenderedElementBase.prototype=new P.Element.ElementBase,P.Element.PathElementBase=function(e){this.base=P.Element.RenderedElementBase,this.base(e),this.path=function(e){return null!=e&&e.beginPath(),new P.BoundingBox},this.renderChildren=function(e){this.path(e),P.Mouse.checkPath(this,e),""!=e.fillStyle&&e.fill(),""!=e.strokeStyle&&e.stroke();var t=this.getMarkers();if(null!=t){if(this.style("marker-start").isUrlDefinition()&&(n=this.style("marker-start").getDefinition()).render(e,t[0][0],t[0][1]),this.style("marker-mid").isUrlDefinition())for(var n=this.style("marker-mid").getDefinition(),i=1;i<t.length-1;i++)n.render(e,t[i][0],t[i][1]);this.style("marker-end").isUrlDefinition()&&(n=this.style("marker-end").getDefinition()).render(e,t[t.length-1][0],t[t.length-1][1])}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},P.Element.PathElementBase.prototype=new P.Element.RenderedElementBase,P.Element.svg=function(e){this.base=P.Element.RenderedElementBase,this.base(e),this.baseClearContext=this.clearContext,this.clearContext=function(e){this.baseClearContext(e),P.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(e){e.strokeStyle="rgba(0,0,0,0)",e.lineCap="butt",e.lineJoin="miter",e.miterLimit=4,this.baseSetContext(e),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),e.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var t,n,i,r=P.ViewPort.width(),a=P.ViewPort.height();this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root&&(r=this.attribute("width").toPixels("x"),a=this.attribute("height").toPixels("y"),t=n=0,this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(n=-this.attribute("refX").toPixels("x"),t=-this.attribute("refY").toPixels("y")),e.beginPath(),e.moveTo(n,t),e.lineTo(r,t),e.lineTo(r,a),e.lineTo(n,a),e.closePath(),e.clip()),P.ViewPort.SetCurrent(r,a),this.attribute("viewBox").hasValue()&&(n=(t=P.ToNumberArray(this.attribute("viewBox").value))[0],i=t[1],r=t[2],a=t[3],P.AspectRatio(e,this.attribute("preserveAspectRatio").value,P.ViewPort.width(),r,P.ViewPort.height(),a,n,i,this.attribute("refX").value,this.attribute("refY").value),P.ViewPort.RemoveCurrent(),P.ViewPort.SetCurrent(t[2],t[3]))}},P.Element.svg.prototype=new P.Element.RenderedElementBase,P.Element.rect=function(e){this.base=P.Element.PathElementBase,this.base(e),this.path=function(e){var t=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y"),a=this.attribute("rx").toPixels("x"),s=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(s=a),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(a=s),a=Math.min(a,i/2),s=Math.min(s,r/2),null!=e&&(e.beginPath(),e.moveTo(t+a,n),e.lineTo(t+i-a,n),e.quadraticCurveTo(t+i,n,t+i,n+s),e.lineTo(t+i,n+r-s),e.quadraticCurveTo(t+i,n+r,t+i-a,n+r),e.lineTo(t+a,n+r),e.quadraticCurveTo(t,n+r,t,n+r-s),e.lineTo(t,n+s),e.quadraticCurveTo(t,n,t+a,n),e.closePath()),new P.BoundingBox(t,n,t+i,n+r)}},P.Element.rect.prototype=new P.Element.PathElementBase,P.Element.circle=function(e){this.base=P.Element.PathElementBase,this.base(e),this.path=function(e){var t=this.attribute("cx").toPixels("x"),n=this.attribute("cy").toPixels("y"),i=this.attribute("r").toPixels();return null!=e&&(e.beginPath(),e.arc(t,n,i,0,2*Math.PI,!0),e.closePath()),new P.BoundingBox(t-i,n-i,t+i,n+i)}},P.Element.circle.prototype=new P.Element.PathElementBase,P.Element.ellipse=function(e){this.base=P.Element.PathElementBase,this.base(e),this.path=function(e){var t=(Math.sqrt(2)-1)/3*4,n=this.attribute("rx").toPixels("x"),i=this.attribute("ry").toPixels("y"),r=this.attribute("cx").toPixels("x"),a=this.attribute("cy").toPixels("y");return null!=e&&(e.beginPath(),e.moveTo(r,a-i),e.bezierCurveTo(r+t*n,a-i,r+n,a-t*i,r+n,a),e.bezierCurveTo(r+n,a+t*i,r+t*n,a+i,r,a+i),e.bezierCurveTo(r-t*n,a+i,r-n,a+t*i,r-n,a),e.bezierCurveTo(r-n,a-t*i,r-t*n,a-i,r,a-i),e.closePath()),new P.BoundingBox(r-n,a-i,r+n,a+i)}},P.Element.ellipse.prototype=new P.Element.PathElementBase,P.Element.line=function(e){this.base=P.Element.PathElementBase,this.base(e),this.getPoints=function(){return[new P.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new P.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(e){var t=this.getPoints();return null!=e&&(e.beginPath(),e.moveTo(t[0].x,t[0].y),e.lineTo(t[1].x,t[1].y)),new P.BoundingBox(t[0].x,t[0].y,t[1].x,t[1].y)},this.getMarkers=function(){var e=this.getPoints(),t=e[0].angleTo(e[1]);return[[e[0],t],[e[1],t]]}},P.Element.line.prototype=new P.Element.PathElementBase,P.Element.polyline=function(e){this.base=P.Element.PathElementBase,this.base(e),this.points=P.CreatePath(this.attribute("points").value),this.path=function(e){var t=new P.BoundingBox(this.points[0].x,this.points[0].y);null!=e&&(e.beginPath(),e.moveTo(this.points[0].x,this.points[0].y));for(var n=1;n<this.points.length;n++)t.addPoint(this.points[n].x,this.points[n].y),null!=e&&e.lineTo(this.points[n].x,this.points[n].y);return t},this.getMarkers=function(){for(var e=[],t=0;t<this.points.length-1;t++)e.push([this.points[t],this.points[t].angleTo(this.points[t+1])]);return e.push([this.points[this.points.length-1],e[e.length-1][1]]),e}},P.Element.polyline.prototype=new P.Element.PathElementBase,P.Element.polygon=function(e){this.base=P.Element.polyline,this.base(e),this.basePath=this.path,this.path=function(e){var t=this.basePath(e);return null!=e&&(e.lineTo(this.points[0].x,this.points[0].y),e.closePath()),t}},P.Element.polygon.prototype=new P.Element.polyline,P.Element.path=function(e){this.base=P.Element.PathElementBase,this.base(e);e=this.attribute("d").value;e=(e=(e=(e=(e=(e=(e=(e=e.replace(/,/gm," ")).replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2")).replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2")).replace(/(\.[0-9]*)(\.)/gm,"$1 $2")).replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=P.compressSpaces(e),e=P.trim(e),this.PathParser=new function(e){this.tokens=e.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new P.Point(0,0),this.control=new P.Point(0,0),this.current=new P.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var e=new P.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(e)},this.getAsControlPoint=function(){var e=this.getPoint();return this.control=e},this.getAsCurrentPoint=function(){var e=this.getPoint();return this.current=e},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()?this.current:new P.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(e){return this.isRelativeCommand()&&(e.x+=this.current.x,e.y+=this.current.y),e},this.addMarker=function(e,t,n){null!=n&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(e,null==t?null:t.angleTo(e))},this.addMarkerAngle=function(e,t){this.points.push(e),this.angles.push(t)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var e=0;e<this.angles.length;e++)if(null==this.angles[e])for(var t=e+1;t<this.angles.length;t++)if(null!=this.angles[t]){this.angles[e]=this.angles[t];break}return this.angles}}(e),this.path=function(e){var t=this.PathParser,n=(t.reset(),new P.BoundingBox);for(null!=e&&e.beginPath();!t.isEnd();)switch(t.nextCommand(),t.command){case"M":case"m":var i=t.getAsCurrentPoint();for(t.addMarker(i),n.addPoint(i.x,i.y),null!=e&&e.moveTo(i.x,i.y),t.start=t.current;!t.isCommandOrEnd();){i=t.getAsCurrentPoint();t.addMarker(i,t.start),n.addPoint(i.x,i.y),null!=e&&e.lineTo(i.x,i.y)}break;case"L":case"l":for(;!t.isCommandOrEnd();){var r=t.current,i=t.getAsCurrentPoint();t.addMarker(i,r),n.addPoint(i.x,i.y),null!=e&&e.lineTo(i.x,i.y)}break;case"H":case"h":for(;!t.isCommandOrEnd();){var a=new P.Point((t.isRelativeCommand()?t.current.x:0)+t.getScalar(),t.current.y);t.addMarker(a,t.current),t.current=a,n.addPoint(t.current.x,t.current.y),null!=e&&e.lineTo(t.current.x,t.current.y)}break;case"V":case"v":for(;!t.isCommandOrEnd();){a=new P.Point(t.current.x,(t.isRelativeCommand()?t.current.y:0)+t.getScalar());t.addMarker(a,t.current),t.current=a,n.addPoint(t.current.x,t.current.y),null!=e&&e.lineTo(t.current.x,t.current.y)}break;case"C":case"c":for(;!t.isCommandOrEnd();){var s=t.current,o=t.getPoint(),l=t.getAsControlPoint(),h=t.getAsCurrentPoint();t.addMarker(h,l,o),n.addBezierCurve(s.x,s.y,o.x,o.y,l.x,l.y,h.x,h.y),null!=e&&e.bezierCurveTo(o.x,o.y,l.x,l.y,h.x,h.y)}break;case"S":case"s":for(;!t.isCommandOrEnd();){s=t.current,o=t.getReflectedControlPoint(),l=t.getAsControlPoint(),h=t.getAsCurrentPoint();t.addMarker(h,l,o),n.addBezierCurve(s.x,s.y,o.x,o.y,l.x,l.y,h.x,h.y),null!=e&&e.bezierCurveTo(o.x,o.y,l.x,l.y,h.x,h.y)}break;case"Q":case"q":for(;!t.isCommandOrEnd();){s=t.current,l=t.getAsControlPoint(),h=t.getAsCurrentPoint();t.addMarker(h,l,l),n.addQuadraticCurve(s.x,s.y,l.x,l.y,h.x,h.y),null!=e&&e.quadraticCurveTo(l.x,l.y,h.x,h.y)}break;case"T":case"t":for(;!t.isCommandOrEnd();){s=t.current,l=t.getReflectedControlPoint(),h=(t.control=l,t.getAsCurrentPoint());t.addMarker(h,l,l),n.addQuadraticCurve(s.x,s.y,l.x,l.y,h.x,h.y),null!=e&&e.quadraticCurveTo(l.x,l.y,h.x,h.y)}break;case"A":case"a":for(;!t.isCommandOrEnd();){function u(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(v(e,t))}var s=t.current,c=t.getScalar(),f=t.getScalar(),d=t.getScalar()*(Math.PI/180),p=t.getScalar(),g=t.getScalar(),h=t.getAsCurrentPoint(),m=new P.Point(Math.cos(d)*(s.x-h.x)/2+Math.sin(d)*(s.y-h.y)/2,-Math.sin(d)*(s.x-h.x)/2+Math.cos(d)*(s.y-h.y)/2),x=Math.pow(m.x,2)/Math.pow(c,2)+Math.pow(m.y,2)/Math.pow(f,2),x=(1<x&&(c*=Math.sqrt(x),f*=Math.sqrt(x)),(p==g?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(f,2)-Math.pow(c,2)*Math.pow(m.y,2)-Math.pow(f,2)*Math.pow(m.x,2))/(Math.pow(c,2)*Math.pow(m.y,2)+Math.pow(f,2)*Math.pow(m.x,2)))),p=(isNaN(x)&&(x=0),new P.Point(x*c*m.y/f,x*-f*m.x/c)),x=new P.Point((s.x+h.x)/2+Math.cos(d)*p.x-Math.sin(d)*p.y,(s.y+h.y)/2+Math.sin(d)*p.x+Math.cos(d)*p.y),y=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},v=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(y(e)*y(t))},b=u([1,0],[(m.x-p.x)/c,(m.y-p.y)/f]),w=[(m.x-p.x)/c,(m.y-p.y)/f],m=[(-m.x-p.x)/c,(-m.y-p.y)/f],p=u(w,m),_=(v(w,m)<=-1&&(p=Math.PI),1-g?1:-1),w=b+(p=1<=v(w,m)?0:p)/2*_,m=new P.Point(x.x+c*Math.cos(w),x.y+f*Math.sin(w));t.addMarkerAngle(m,w-_*Math.PI/2),t.addMarkerAngle(h,w-_*Math.PI),n.addPoint(h.x,h.y),null!=e&&(v=f<c?c:f,m=f<c?1:c/f,w=f<c?f/c:1,e.translate(x.x,x.y),e.rotate(d),e.scale(m,w),e.arc(0,0,v,b,b+p,1-g),e.scale(1/m,1/w),e.rotate(-d),e.translate(-x.x,-x.y))}break;case"Z":case"z":null!=e&&e.closePath(),t.current=t.start}return n},this.getMarkers=function(){for(var e=this.PathParser.getMarkerPoints(),t=this.PathParser.getMarkerAngles(),n=[],i=0;i<e.length;i++)n.push([e[i],t[i]]);return n}},P.Element.path.prototype=new P.Element.PathElementBase,P.Element.pattern=function(e){this.base=P.Element.ElementBase,this.base(e),this.createPattern=function(e,t){var n=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),r=new P.Element.svg,a=(r.attributes.viewBox=new P.Property("viewBox",this.attribute("viewBox").value),r.attributes.width=new P.Property("width",n+"px"),r.attributes.height=new P.Property("height",i+"px"),r.attributes.transform=new P.Property("transform",this.attribute("patternTransform").value),r.children=this.children,document.createElement("canvas")),s=(a.width=n,a.height=i,a.getContext("2d"));this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&s.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var o=-1;o<=1;o++)for(var l=-1;l<=1;l++)s.save(),s.translate(o*a.width,l*a.height),r.render(s),s.restore();return e.createPattern(a,"repeat")}},P.Element.pattern.prototype=new P.Element.ElementBase,P.Element.marker=function(e){this.base=P.Element.ElementBase,this.base(e),this.baseRender=this.render,this.render=function(e,t,n){e.translate(t.x,t.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&e.rotate(n),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&e.scale(e.lineWidth,e.lineWidth),e.save();var i=new P.Element.svg;i.attributes.viewBox=new P.Property("viewBox",this.attribute("viewBox").value),i.attributes.refX=new P.Property("refX",this.attribute("refX").value),i.attributes.refY=new P.Property("refY",this.attribute("refY").value),i.attributes.width=new P.Property("width",this.attribute("markerWidth").value),i.attributes.height=new P.Property("height",this.attribute("markerHeight").value),i.attributes.fill=new P.Property("fill",this.attribute("fill").valueOrDefault("black")),i.attributes.stroke=new P.Property("stroke",this.attribute("stroke").valueOrDefault("none")),i.children=this.children,i.render(e),e.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&e.scale(1/e.lineWidth,1/e.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&e.rotate(-n),e.translate(-t.x,-t.y)}},P.Element.marker.prototype=new P.Element.ElementBase,P.Element.defs=function(e){this.base=P.Element.ElementBase,this.base(e),this.render=function(e){}},P.Element.defs.prototype=new P.Element.ElementBase,P.Element.GradientBase=function(e){this.base=P.Element.ElementBase,this.base(e),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var t=0;t<this.children.length;t++){var n=this.children[t];"stop"==n.type&&this.stops.push(n)}this.getGradient=function(){},this.createGradient=function(e,t,n){function i(e){return n.hasValue()?new P.Property("color",e).addOpacity(n.value).value:e}var r=this,a=(this.attribute("xlink:href").hasValue()&&(r=this.attribute("xlink:href").getDefinition()),this.getGradient(e,t));if(null==a)return i(r.stops[r.stops.length-1].color);for(var s,o=0;o<r.stops.length;o++)a.addColorStop(r.stops[o].offset,i(r.stops[o].color));return this.attribute("gradientTransform").hasValue()?(e=P.ViewPort.viewPorts[0],(t=new P.Element.rect).attributes.x=new P.Property("x",-P.MAX_VIRTUAL_PIXELS/3),t.attributes.y=new P.Property("y",-P.MAX_VIRTUAL_PIXELS/3),t.attributes.width=new P.Property("width",P.MAX_VIRTUAL_PIXELS),t.attributes.height=new P.Property("height",P.MAX_VIRTUAL_PIXELS),(s=new P.Element.g).attributes.transform=new P.Property("transform",this.attribute("gradientTransform").value),s.children=[t],(t=new P.Element.svg).attributes.x=new P.Property("x",0),t.attributes.y=new P.Property("y",0),t.attributes.width=new P.Property("width",e.width),t.attributes.height=new P.Property("height",e.height),t.children=[s],(s=document.createElement("canvas")).width=e.width,s.height=e.height,(e=s.getContext("2d")).fillStyle=a,t.render(e),e.createPattern(s,"no-repeat")):a}},P.Element.GradientBase.prototype=new P.Element.ElementBase,P.Element.linearGradient=function(e){this.base=P.Element.GradientBase,this.base(e),this.getGradient=function(e,t){var t=t.getBoundingBox(),n=(this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0),"objectBoundingBox"==this.gradientUnits?t.x()+t.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x")),i="objectBoundingBox"==this.gradientUnits?t.y()+t.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),r="objectBoundingBox"==this.gradientUnits?t.x()+t.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),t="objectBoundingBox"==this.gradientUnits?t.y()+t.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return n==r&&i==t?null:e.createLinearGradient(n,i,r,t)}},P.Element.linearGradient.prototype=new P.Element.GradientBase,P.Element.radialGradient=function(e){this.base=P.Element.GradientBase,this.base(e),this.getGradient=function(e,t){var t=t.getBoundingBox(),n=(this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%"),"objectBoundingBox"==this.gradientUnits?t.x()+t.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x")),i="objectBoundingBox"==this.gradientUnits?t.y()+t.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),r=n,a=i,t=(this.attribute("fx").hasValue()&&(r="objectBoundingBox"==this.gradientUnits?t.x()+t.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(a="objectBoundingBox"==this.gradientUnits?t.y()+t.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y")),"objectBoundingBox"==this.gradientUnits?(t.width()+t.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels());return e.createRadialGradient(r,a,0,n,i,t)}},P.Element.radialGradient.prototype=new P.Element.GradientBase,P.Element.stop=function(e){this.base=P.Element.ElementBase,this.base(e),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),1<this.offset&&(this.offset=1);e=this.style("stop-color");this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity").value)),this.color=e.value},P.Element.stop.prototype=new P.Element.ElementBase,P.Element.AnimateBase=function(e){this.base=P.Element.ElementBase,this.base(e),P.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var e=this.attribute("attributeType").value,t=this.attribute("attributeName").value;return"CSS"==e?this.parent.style(t,!0):this.parent.attribute(t,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(e){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"!=this.attribute("repeatCount").value&&"indefinite"!=this.attribute("repeatDur").value)return"remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed&&(this.removed=!0,this.getProperty().value=this.initialValue,!0);this.duration=0}this.duration=this.duration+e;var t,e=!1;return this.begin<this.duration&&(t=this.calcValue(),this.attribute("type").hasValue()&&(t=this.attribute("type").value+"("+t+")"),this.getProperty().value=t,e=!0),e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var e,t,n,i={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};return this.values.hasValue()?(e=i.progress*(this.values.value.length-1),t=Math.floor(e),n=Math.ceil(e),i.from=new P.Property("from",parseFloat(this.values.value[t])),i.to=new P.Property("to",parseFloat(this.values.value[n])),i.progress=(e-t)/(n-t)):(i.from=this.from,i.to=this.to),i}},P.Element.AnimateBase.prototype=new P.Element.ElementBase,P.Element.animate=function(e){this.base=P.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress();return e.from.numValue()+(e.to.numValue()-e.from.numValue())*e.progress+this.initialUnits}},P.Element.animate.prototype=new P.Element.AnimateBase,P.Element.animateColor=function(e){this.base=P.Element.AnimateBase,this.base(e),this.calcValue=function(){var e,t,n=this.progress(),i=new f(n.from.value),r=new f(n.to.value);return i.ok&&r.ok?(e=i.r+(r.r-i.r)*n.progress,t=i.g+(r.g-i.g)*n.progress,r=i.b+(r.b-i.b)*n.progress,"rgb("+parseInt(e,10)+","+parseInt(t,10)+","+parseInt(r,10)+")"):this.attribute("from").value}},P.Element.animateColor.prototype=new P.Element.AnimateBase,P.Element.animateTransform=function(e){this.base=P.Element.AnimateBase,this.base(e),this.calcValue=function(){for(var e=this.progress(),t=P.ToNumberArray(e.from.value),n=P.ToNumberArray(e.to.value),i="",r=0;r<t.length;r++)i+=t[r]+(n[r]-t[r])*e.progress+" ";return i}},P.Element.animateTransform.prototype=new P.Element.animate,P.Element.font=function(e){this.base=P.Element.ElementBase,this.base(e),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var t=0;t<this.children.length;t++){var n=this.children[t];"font-face"==n.type?(this.fontFace=n).style("font-family").hasValue()&&(P.Definitions[n.style("font-family").value]=this):"missing-glyph"==n.type?this.missingGlyph=n:"glyph"==n.type&&(""!=n.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[n.unicode]&&(this.glyphs[n.unicode]=[]),this.glyphs[n.unicode][n.arabicForm]=n):this.glyphs[n.unicode]=n)}},P.Element.font.prototype=new P.Element.ElementBase,P.Element.fontface=function(e){this.base=P.Element.ElementBase,this.base(e),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},P.Element.fontface.prototype=new P.Element.ElementBase,P.Element.missingglyph=function(e){this.base=P.Element.path,this.base(e),this.horizAdvX=0},P.Element.missingglyph.prototype=new P.Element.path,P.Element.glyph=function(e){this.base=P.Element.path,this.base(e),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},P.Element.glyph.prototype=new P.Element.path,P.Element.text=function(e){this.captureTextNodes=!0,this.base=P.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.style("dominant-baseline").hasValue()&&(e.textBaseline=this.style("dominant-baseline").value),this.style("alignment-baseline").hasValue()&&(e.textBaseline=this.style("alignment-baseline").value)},this.renderChildren=function(e){this.textAnchor=this.style("text-anchor").valueOrDefault("start"),this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y");for(var t=0;t<this.children.length;t++)this.renderChild(e,this,t)},this.renderChild=function(e,t,n){var i=t.children[n],t=(i.attribute("x").hasValue()?i.x=i.attribute("x").toPixels("x"):(this.attribute("dx").hasValue()&&(this.y+=this.attribute("dx").toPixels("x")),i.attribute("dx").hasValue()&&(this.x+=i.attribute("dx").toPixels("x")),i.x=this.x),i.measureText(e));if("start"!=this.textAnchor&&(0==n||i.attribute("x").hasValue())){for(var r=t,a=n+1;a<this.children.length;a++){var s=this.children[a];if(s.attribute("x").hasValue())break;r+=s.measureText(e)}i.x-="end"==this.textAnchor?r:r/2}this.x=i.x+t,i.attribute("y").hasValue()?i.y=i.attribute("y").toPixels("y"):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),i.attribute("dy").hasValue()&&(this.y+=i.attribute("dy").toPixels("y")),i.y=this.y),this.y=i.y,i.render(e);for(n=0;n<i.children.length;n++)this.renderChild(e,i,n)}},P.Element.text.prototype=new P.Element.RenderedElementBase,P.Element.TextElementBase=function(e){this.base=P.Element.RenderedElementBase,this.base(e),this.getGlyph=function(e,t,n){var i,r=t[n],a=null;return e.isArabic?(i="isolated",(0==n||" "==t[n-1])&&n<t.length-2&&" "!=t[n+1]&&(i="terminal"),0<n&&" "!=t[n-1]&&n<t.length-2&&" "!=t[n+1]&&(i="medial"),0<n&&" "!=t[n-1]&&(n==t.length-1||" "==t[n+1])&&(i="initial"),void 0!==e.glyphs[r]&&null==(a=e.glyphs[r][i])&&"glyph"==e.glyphs[r].type&&(a=e.glyphs[r])):a=e.glyphs[r],a=null==a?e.missingGlyph:a},this.renderChildren=function(e){var t=this.parent.style("font-family").getDefinition();if(null!=t)for(var n=this.parent.style("font-size").numValueOrDefault(P.Font.Parse(P.ctx.font).fontSize),i=this.parent.style("font-style").valueOrDefault(P.Font.Parse(P.ctx.font).fontStyle),r=this.getText(),a=(t.isRTL&&(r=r.split("").reverse().join("")),P.ToNumberArray(this.parent.attribute("dx").value)),s=0;s<r.length;s++){var o=this.getGlyph(t,r,s),l=n/t.fontFace.unitsPerEm,h=(e.translate(this.x,this.y),e.scale(l,-l),e.lineWidth);e.lineWidth=e.lineWidth*t.fontFace.unitsPerEm/n,"italic"==i&&e.transform(1,0,.4,1,0,0),o.render(e),"italic"==i&&e.transform(1,0,-.4,1,0,0),e.lineWidth=h,e.scale(1/l,-1/l),e.translate(-this.x,-this.y),this.x+=n*(o.horizAdvX||t.horizAdvX)/t.fontFace.unitsPerEm,void 0===a[s]||isNaN(a[s])||(this.x+=a[s])}else""!=e.fillStyle&&e.fillText(P.compressSpaces(this.getText()),this.x,this.y),""!=e.strokeStyle&&e.strokeText(P.compressSpaces(this.getText()),this.x,this.y)},this.getText=function(){},this.measureText=function(e){var t=this.parent.style("font-family").getDefinition();if(null!=t){for(var n=this.parent.style("font-size").numValueOrDefault(P.Font.Parse(P.ctx.font).fontSize),i=0,r=this.getText(),a=(t.isRTL&&(r=r.split("").reverse().join("")),P.ToNumberArray(this.parent.attribute("dx").value)),s=0;s<r.length;s++)i+=(this.getGlyph(t,r,s).horizAdvX||t.horizAdvX)*n/t.fontFace.unitsPerEm,void 0===a[s]||isNaN(a[s])||(i+=a[s]);return i}var o=P.compressSpaces(this.getText());if(!e.measureText)return 10*o.length;e.save(),this.setContext(e);o=e.measureText(o).width;return e.restore(),o}},P.Element.TextElementBase.prototype=new P.Element.RenderedElementBase,P.Element.tspan=function(e){this.captureTextNodes=!0,this.base=P.Element.TextElementBase,this.base(e),this.text=e.nodeValue||e.text||"",this.getText=function(){return this.text}},P.Element.tspan.prototype=new P.Element.TextElementBase,P.Element.tref=function(e){this.base=P.Element.TextElementBase,this.base(e),this.getText=function(){var e=this.attribute("xlink:href").getDefinition();if(null!=e)return e.children[0].getText()}},P.Element.tref.prototype=new P.Element.TextElementBase,P.Element.a=function(e){this.base=P.Element.TextElementBase,this.base(e),this.hasText=!0;for(var t=0;t<e.childNodes.length;t++)3!=e.childNodes[t].nodeType&&(this.hasText=!1);this.text=this.hasText?e.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(e){var t;this.hasText?(this.baseRenderChildren(e),t=new P.Property("fontSize",P.Font.Parse(P.ctx.font).fontSize),P.Mouse.checkBoundingBox(this,new P.BoundingBox(this.x,this.y-t.toPixels("y"),this.x+this.measureText(e),this.y))):((t=new P.Element.g).children=this.children,t.parent=this,t.render(e))},this.onclick=function(){window.open(this.attribute("xlink:href").value)},this.onmousemove=function(){P.ctx.canvas.style.cursor="pointer"}},P.Element.a.prototype=new P.Element.TextElementBase,P.Element.image=function(e){this.base=P.Element.RenderedElementBase,this.base(e);var t,n=this.attribute("xlink:href").value,a=n.match(/\.svg$/);P.Images.push(this),this.loaded=!1,a?(this.img=P.ajax(n),this.loaded=!0):(this.img=document.createElement("img"),(t=this).img.onload=function(){t.loaded=!0},this.img.onerror=function(){console&&console.log('ERROR: image "'+n+'" not found'),t.loaded=!0},this.img.src=n),this.renderChildren=function(e){var t=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");0!=i&&0!=r&&(e.save(),a?e.drawSvg(this.img,t,n,i,r):(e.translate(t,n),P.AspectRatio(e,this.attribute("preserveAspectRatio").value,i,this.img.width,r,this.img.height,0,0),e.drawImage(this.img,0,0)),e.restore())},this.getBoundingBox=function(){var e=this.attribute("x").toPixels("x"),t=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");return new P.BoundingBox(e,t,e+n,t+i)}},P.Element.image.prototype=new P.Element.RenderedElementBase,P.Element.g=function(e){this.base=P.Element.RenderedElementBase,this.base(e),this.getBoundingBox=function(){for(var e=new P.BoundingBox,t=0;t<this.children.length;t++)e.addBoundingBox(this.children[t].getBoundingBox());return e}},P.Element.g.prototype=new P.Element.RenderedElementBase,P.Element.symbol=function(e){this.base=P.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){var t,n,i;this.baseSetContext(e),this.attribute("viewBox").hasValue()&&(n=(t=P.ToNumberArray(this.attribute("viewBox").value))[0],i=t[1],width=t[2],height=t[3],P.AspectRatio(e,this.attribute("preserveAspectRatio").value,this.attribute("width").toPixels("x"),width,this.attribute("height").toPixels("y"),height,n,i),P.ViewPort.SetCurrent(t[2],t[3]))}},P.Element.symbol.prototype=new P.Element.RenderedElementBase,P.Element.style=function(e){this.base=P.Element.ElementBase,this.base(e);for(var t="",n=0;n<e.childNodes.length;n++)t+=e.childNodes[n].nodeValue;t=t.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");for(var i=(t=P.compressSpaces(t)).split("}"),n=0;n<i.length;n++)if(""!=P.trim(i[n]))for(var r=i[n].split("{"),a=r[0].split(","),s=r[1].split(";"),o=0;o<a.length;o++){var l=P.trim(a[o]);if(""!=l){for(var h={},u=0;u<s.length;u++){var c=s[u].indexOf(":"),f=s[u].substr(0,c),c=s[u].substr(c+1,s[u].length-c);null!=f&&null!=c&&(h[P.trim(f)]=new P.Property(P.trim(f),P.trim(c)))}if(P.Styles[l]=h,"@font-face"==l)for(var d=h["font-family"].value.replace(/"/g,""),p=h.src.value.split(","),g=0;g<p.length;g++)if(0<p[g].indexOf('format("svg")'))for(var m=p[g].indexOf("url"),x=p[g].indexOf(")",m),x=p[g].substr(m+5,x-m-6),y=P.parseXml(P.ajax(x)).getElementsByTagName("font"),v=0;v<y.length;v++){var b=P.CreateElement(y[v]);P.Definitions[d]=b}}}},P.Element.style.prototype=new P.Element.ElementBase,P.Element.use=function(e){this.base=P.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.attribute("x").hasValue()&&e.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&e.translate(0,this.attribute("y").toPixels("y"))},this.getDefinition=function(){var e=this.attribute("xlink:href").getDefinition();return this.attribute("width").hasValue()&&(e.attribute("width",!0).value=this.attribute("width").value),this.attribute("height").hasValue()&&(e.attribute("height",!0).value=this.attribute("height").value),e},this.path=function(e){var t=this.getDefinition();null!=t&&t.path(e)},this.renderChildren=function(e){var t,n=this.getDefinition();null!=n&&(t=n.parent,n.parent=null,n.render(e),n.parent=t)}},P.Element.use.prototype=new P.Element.RenderedElementBase,P.Element.mask=function(e){this.base=P.Element.ElementBase,this.base(e),this.apply=function(e,t){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),a=this.attribute("height").toPixels("y"),s=t.attribute("mask").value,o=(t.attribute("mask").value="",document.createElement("canvas")),l=(o.width=n+r,o.height=i+a,o.getContext("2d")),h=(this.renderChildren(l),document.createElement("canvas")),u=(h.width=n+r,h.height=i+a,h.getContext("2d"));t.render(u),u.globalCompositeOperation="destination-in",u.fillStyle=l.createPattern(o,"no-repeat"),u.fillRect(0,0,n+r,i+a),e.fillStyle=u.createPattern(h,"no-repeat"),e.fillRect(0,0,n+r,i+a),t.attribute("mask").value=s},this.render=function(e){}},P.Element.mask.prototype=new P.Element.ElementBase,P.Element.clipPath=function(e){this.base=P.Element.ElementBase,this.base(e),this.apply=function(e){for(var t=0;t<this.children.length;t++)this.children[t].path&&(this.children[t].path(e),e.clip())},this.render=function(e){}},P.Element.clipPath.prototype=new P.Element.ElementBase,P.Element.filter=function(e){this.base=P.Element.ElementBase,this.base(e),this.apply=function(e,t){var n=t.getBoundingBox(),i=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),a=("image"!=t.type&&0!=i&&0!=r||(i=n.x1,r=n.y1),this.attribute("width").toPixels("x")),s=this.attribute("height").toPixels("y"),n=("image"!=t.type&&0!=a&&0!=s||(a=n.width(),s=n.height()),t.style("filter").value),o=(t.style("filter").value="","image"==t.type?0:.2),l=o*a,h=o*s,o=document.createElement("canvas"),u=(o.width=a+2*l,o.height=s+2*h,o.getContext("2d"));u.translate(l-i,h-r),t.render(u);for(var c=0;c<this.children.length;c++)this.children[c].apply(u,0,0,a+2*l,s+2*h);e.drawImage(o,0,0,a+2*l,s+2*h,i-l,r-h,a+2*l,s+2*h),t.style("filter",!0).value=n},this.render=function(e){}},P.Element.filter.prototype=new P.Element.ElementBase,P.Element.feColorMatrix=function(e){function o(e,t,n,i,r,a){return e[n*i*4+4*t+a]}function l(e,t,n,i,r,a,s){e[n*i*4+4*t+a]=s}this.base=P.Element.ElementBase,this.base(e),this.apply=function(e,t,n,i,r){for(var a=e.getImageData(0,0,i,r),n=0;n<r;n++)for(t=0;t<i;t++){var s=(o(a.data,t,n,i,0,0)+o(a.data,t,n,i,0,1)+o(a.data,t,n,i,0,2))/3;l(a.data,t,n,i,0,0,s),l(a.data,t,n,i,0,1,s),l(a.data,t,n,i,0,2,s)}e.clearRect(0,0,i,r),e.putImageData(a,0,0)}},P.Element.filter.prototype=new P.Element.feColorMatrix,P.Element.feGaussianBlur=function(e){function a(e,t,n,i,r){for(var a,s=0;s<r;s++)for(var o=0;o<i;o++)for(var l=e[s*i*4+4*o+3]/255,h=0;h<4;h++){for(var u=n[0]*(0==l?255:e[s*i*4+4*o+h])*(0==l||3==h?1:l),c=1;c<n.length;c++){var f=p(e,Math.max(o-c,0),s,i,0,3)/255,d=p(e,Math.min(o+c,i-1),s,i,0,3)/255;u+=n[c]*((0==f?255:p(e,Math.max(o-c,0),s,i,0,h))*(0==f||3==h?1:f)+(0==d?255:p(e,Math.min(o+c,i-1),s,i,0,h))*(0==d||3==h?1:d))}a=u,t[o*r*4+4*s+h]=a}}function p(e,t,n,i,r,a){return e[n*i*4+4*t+a]}function s(e,t,n,i){var r=e.getImageData(0,0,t,n),i=function(e){for(var t=0,n=1;n<e.length;n++)t+=Math.abs(e[n]);for(t=2*t+Math.abs(e[0]),n=0;n<e.length;n++)e[n]/=t;return e}(function(e){e=Math.max(e,.01);var t=Math.ceil(4*e)+1;mask=[];for(var n=0;n<t;n++)mask[n]=Math.exp(n/e*-.5*(n/e));return mask}(i));tmp=[],a(r.data,tmp,i,t,n),a(tmp,r.data,i,n,t),e.clearRect(0,0,t,n),e.putImageData(r,0,0)}this.base=P.Element.ElementBase,this.base(e),this.apply=function(e,t,n,i,r){s(e,i,r,this.attribute("stdDeviation").numValue())}},P.Element.filter.prototype=new P.Element.feGaussianBlur,P.Element.title=function(e){},P.Element.title.prototype=new P.Element.ElementBase,P.Element.desc=function(e){},P.Element.desc.prototype=new P.Element.ElementBase,P.Element.MISSING=function(e){console&&console.log("ERROR: Element '"+e.nodeName+"' not yet implemented.")},P.Element.MISSING.prototype=new P.Element.ElementBase,P.CreateElement=function(e){var t=(t=e.nodeName.replace(/^[^:]+:/,"")).replace(/\-/g,""),n=null;return(n=new(void 0!==P.Element[t]?P.Element[t]:P.Element.MISSING)(e)).type=e.nodeName,n},P.load=function(e,t){P.loadXml(e,P.ajax(t))},P.loadXml=function(e,t){P.loadXmlDoc(e,P.parseXml(t))},P.loadXmlDoc=function(a,e){P.init(a);function t(e){for(var t=a.canvas;t;)e.x-=t.offsetLeft,e.y-=t.offsetTop,t=t.offsetParent;return window.scrollX&&(e.x+=window.scrollX),window.scrollY&&(e.y+=window.scrollY),e}function n(){P.ViewPort.Clear(),a.canvas.parentNode&&P.ViewPort.SetCurrent(a.canvas.parentNode.clientWidth,a.canvas.parentNode.clientHeight),1!=P.opts.ignoreDimensions&&(s.style("width").hasValue()&&(a.canvas.width=s.style("width").toPixels("x"),a.canvas.style.width=a.canvas.width+"px"),s.style("height").hasValue()&&(a.canvas.height=s.style("height").toPixels("y"),a.canvas.style.height=a.canvas.height+"px"));var e,t,n,i=a.canvas.clientWidth||a.canvas.width,r=a.canvas.clientHeight||a.canvas.height;1==P.opts.ignoreDimensions&&s.style("width").hasValue()&&s.style("height").hasValue()&&(i=s.style("width").toPixels("x"),r=s.style("height").toPixels("y")),P.ViewPort.SetCurrent(i,r),null!=P.opts.offsetX&&(s.attribute("x",!0).value=P.opts.offsetX),null!=P.opts.offsetY&&(s.attribute("y",!0).value=P.opts.offsetY),null!=P.opts.scaleWidth&&null!=P.opts.scaleHeight&&(t=e=1,n=P.ToNumberArray(s.attribute("viewBox").value),s.attribute("width").hasValue()?e=s.attribute("width").toPixels("x")/P.opts.scaleWidth:isNaN(n[2])||(e=n[2]/P.opts.scaleWidth),s.attribute("height").hasValue()?t=s.attribute("height").toPixels("y")/P.opts.scaleHeight:isNaN(n[3])||(t=n[3]/P.opts.scaleHeight),s.attribute("width",!0).value=P.opts.scaleWidth,s.attribute("height",!0).value=P.opts.scaleHeight,s.attribute("viewBox",!0).value="0 0 "+i*e+" "+r*t,s.attribute("preserveAspectRatio",!0).value="none"),1!=P.opts.ignoreClear&&a.clearRect(0,0,i,r),s.render(a),o&&(o=!1,"function"==typeof P.opts.renderCallback&&P.opts.renderCallback())}1!=P.opts.ignoreMouse&&(a.canvas.onclick=function(e){e=t(new P.Point((null!=e?e:event).clientX,(null!=e?e:event).clientY));P.Mouse.onclick(e.x,e.y)},a.canvas.onmousemove=function(e){e=t(new P.Point((null!=e?e:event).clientX,(null!=e?e:event).clientY));P.Mouse.onmousemove(e.x,e.y)});var s=P.CreateElement(e.documentElement),o=s.root=!0,i=!0;P.ImagesLoaded()&&(i=!1,n()),P.intervalID=setInterval(function(){var e=!1;if(i&&P.ImagesLoaded()&&(e=!(i=!1)),1!=P.opts.ignoreMouse&&(e|=P.Mouse.hasEvents()),1!=P.opts.ignoreAnimation)for(var t=0;t<P.Animations.length;t++)e|=P.Animations[t].update(1e3/P.FRAMERATE);(e="function"==typeof P.opts.forceRedraw&&1==P.opts.forceRedraw()?!0:e)&&(n(),P.Mouse.runEvents())},1e3/P.FRAMERATE)},P.stop=function(){P.intervalID&&clearInterval(P.intervalID)},P.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(e,t){this.events.push({type:"onclick",x:e,y:t,run:function(e){e.onclick&&e.onclick()}})},this.onmousemove=function(e,t){this.events.push({type:"onmousemove",x:e,y:t,run:function(e){e.onmousemove&&e.onmousemove()}})},this.eventElements=[],this.checkPath=function(e,t){for(var n=0;n<this.events.length;n++){var i=this.events[n];t.isPointInPath&&t.isPointInPath(i.x,i.y)&&(this.eventElements[n]=e)}},this.checkBoundingBox=function(e,t){for(var n=0;n<this.events.length;n++){var i=this.events[n];t.isPointInBox(i.x,i.y)&&(this.eventElements[n]=e)}},this.runEvents=function(){P.ctx.canvas.style.cursor="";for(var e=0;e<this.events.length;e++)for(var t=this.events[e],n=this.eventElements[e];n;)t.run(n),n=n.parent;this.events=[],this.eventElements=[]}};var P,h=P,n=(1==e.childNodes.length&&"OBJECT"==e.childNodes[0].nodeName||(e.svg=h),h.opts=n,e.getContext("2d"));void 0!==t.documentElement?h.loadXmlDoc(n,t):"<"==t.substr(0,1)?h.loadXml(n,t):h.load(n,t)}}}(),window.CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(e,t,n,i,r){canvg(this.canvas,e,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:t,offsetY:n,scaleWidth:i,scaleHeight:r})}),function(e){var l,h,u,t,o,s,c,f,d,p,M,k,g,m,E,S,T,i,F,D,B,x,y,v,A,N,I,O,R,b,w,r=function(e){return new r.prototype.init(e)};"undefined"!=typeof require&&"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=r:e.Globalize=r,r.cultures={},(r.prototype={constructor:r,init:function(e){return this.cultures=r.cultures,this.cultureSelector=e,this}}).init.prototype=r.prototype,r.cultures.default={name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",NaN:"NaN",negativeInfinity:"-Infinity",positiveInfinity:"Infinity",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}},messages:{}},r.cultures.default.calendar=r.cultures.default.calendars.standard,r.cultures.en=r.cultures.default,r.cultureSelector="en",l=/^0x[a-f0-9]+$/i,h=/^[+\-]?infinity$/i,u=/^[+\-]?\d*\.?\d*(e[+\-]?\d+)?$/,t=/^\s+|\s+$/g,o=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},s=function(e,t){return e.substr(e.length-t.length)===t},c=function(){var e,t,n,i,r,a=arguments[0]||{},s=1,o=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[1]||{},s=2),"object"==typeof a||d(a)||(a={});s<o;s++)if(null!=(e=arguments[s]))for(t in e)r=a[t],a!==(n=e[t])&&(l&&n&&(p(n)||(i=f(n)))?(r=i?(i=!1,r&&f(r)?r:[]):r&&p(r)?r:{},a[t]=c(l,r,n)):void 0!==n&&(a[t]=n));return a},f=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},d=function(e){return"[object Function]"===Object.prototype.toString.call(e)},p=function(e){return"[object Object]"===Object.prototype.toString.call(e)},M=function(e,t){return 0===e.indexOf(t)},k=function(e){return(e+"").replace(t,"")},g=function(e){return isNaN(e)?NaN:Math[e<0?"ceil":"floor"](e)},m=function(e,t,n){for(var i=e.length;i<t;i+=1)e=n?"0"+e:e+"0";return e},E=function(e,t){for(var n=0,i=!1,r=0,a=e.length;r<a;r++){var s=e.charAt(r);switch(s){case"'":i?t.push("'"):n++,i=!1;break;case"\\":i&&t.push("\\"),i=!i;break;default:t.push(s),i=!1}}return n},S=function(e,t){var e=e.patterns,n=(t=t||"F").length;if(1===n){if(!(e=e[t]))throw"Invalid date format string '"+t+"'.";t=e}else 2===n&&"%"===t.charAt(0)&&(t=t.charAt(1));return t},T=function(e,t,n){var i,r,a=n.calendar,s=a.convert;if(!t||!t.length||"i"===t)return r=n&&n.name.length?s?T(e,a.patterns.F,n):(n=new Date(e.getTime()),i=D(e,a.eras),n.setFullYear(B(e,a,i)),n.toLocaleString()):e.toString();var o=a.eras,l="s"===t;t=S(a,t),r=[];var h,u,c,f,d=["0","00","000"],p=/([^d]|^)(d|dd)([^d]|$)/g,g=0,m=F();function x(e,t){var n,e=e+"";return 1<t&&e.length<t?(n=d[t-2]+e).substr(n.length-t,t):e}function y(e,t){if(f)return f[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:throw"Invalid part value "+t}}for(!l&&s&&(f=s.fromGregorian(e));;){var v=m.lastIndex,b=m.exec(t),v=t.slice(v,b?b.index:t.length);if(g+=E(v,r),!b)break;if(g%2)r.push(b[0]);else{var w=b[0],_=w.length;switch(w){case"ddd":case"dddd":var P=3===_?a.days.namesAbbr:a.days.names;r.push(P[e.getDay()]);break;case"d":case"dd":u=!0,r.push(x(y(e,2),_));break;case"MMM":case"MMMM":var C=y(e,1);r.push((a.monthsGenitive&&(u||c||(u=p.test(t),c=!0),u)?a.monthsGenitive:a.months)[3===_?"namesAbbr":"names"][C]);break;case"M":case"MM":r.push(x(y(e,1)+1,_));break;case"y":case"yy":case"yyyy":C=f?f[0]:B(e,a,D(e,o),l),_<4&&(C%=100),r.push(x(C,_));break;case"h":case"hh":0===(h=e.getHours()%12)&&(h=12),r.push(x(h,_));break;case"H":case"HH":r.push(x(e.getHours(),_));break;case"m":case"mm":r.push(x(e.getMinutes(),_));break;case"s":case"ss":r.push(x(e.getSeconds(),_));break;case"t":case"tt":C=e.getHours()<12?a.AM?a.AM[0]:" ":a.PM?a.PM[0]:" ",r.push(1===_?C.charAt(0):C);break;case"f":case"ff":case"fff":r.push(x(e.getMilliseconds(),3).substr(0,_));break;case"z":case"zz":h=e.getTimezoneOffset()/60,r.push((h<=0?"+":"-")+x(Math.floor(Math.abs(h)),_));break;case"zzz":h=e.getTimezoneOffset()/60,r.push((h<=0?"+":"-")+x(Math.floor(Math.abs(h)),2)+":"+x(Math.abs(e.getTimezoneOffset()%60),2));break;case"g":case"gg":a.eras&&r.push(a.eras[D(e,o)].name);break;case"/":r.push(a["/"]);break;default:throw"Invalid date format pattern '"+w+"'."}}}return r.join("")},v=function(e,t,n){var i=n.groupSizes,r=i[0],a=1,s=Math.pow(10,t),s=Math.round(e*s)/s,o=(e=s=isFinite(s)?s:e)+"",l="",s=o.split(/e/i),e=1<s.length?parseInt(s[1],10):0;o=(s=(o=s[0]).split("."))[0],l=1<s.length?s[1]:"",0<e?(o+=(l=m(l,e,!1)).slice(0,e),l=l.substr(e)):e<0&&(l=(o=m(o,(e=-e)+1,!0)).slice(-e,o.length)+l,o=o.slice(0,-e));for(var l=0<t?n["."]+(l.length>t?l.slice(0,t):m(l,t)):"",h=o.length-1,u=n[","],c="";0<=h;){if(0===r||h<r)return o.slice(0,h+1)+(c.length?u+c+l:l);c=o.slice(h-r+1,h+1)+(c.length?u+c:""),h-=r,a<i.length&&(r=i[a],a++)}return o.slice(0,h+1)+u+c+l},i=function(e,t,n){if(!isFinite(e))return e===1/0?n.numberFormat.positiveInfinity:e===-1/0?n.numberFormat.negativeInfinity:n.numberFormat.NaN;if(!t||"i"===t)return n.name.length?e.toLocaleString():e.toString();t=t||"D";var i,r,a=n.numberFormat,s=Math.abs(e),o=-1,l=(1<t.length&&(o=parseInt(t.slice(1),10)),t.charAt(0).toUpperCase());switch(l){case"D":i="n",s=g(s),-1!==o&&(s=m(""+s,o,!0)),e<0&&(s="-"+s);break;case"N":r=a;case"C":r=r||a.currency;case"P":r=r||a.percent,i=e<0?r.pattern[0]:r.pattern[1]||"n",-1===o&&(o=r.decimals),s=v(s*("P"===l?100:1),o,r);break;default:throw"Bad number format specifier: "+l}for(var h=/n|\$|-|%/g,u="";;){var c=h.lastIndex,f=h.exec(i);if(u+=i.slice(c,f?f.index:i.length),!f)break;switch(f[0]){case"n":u+=s;break;case"$":u+=a.currency.symbol;break;case"-":/[1-9]/.test(s)&&(u+=a["-"]);break;case"%":u+=a.percent.symbol}}return u},F=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},D=function(e,t){if(!t)return 0;for(var n,i=e.getTime(),r=0,a=t.length;r<a;r++)if(null===(n=t[r].start)||n<=i)return r;return 0},B=function(e,t,n,i){e=e.getFullYear();return!i&&t.eras&&(e-=t.eras[n].offset),e},A=function(e,t){var n,i;return t<100&&(n=new Date,i=D(n),n=B(n,e,i),(i="string"==typeof(i=e.twoDigitYearMax)?(new Date).getFullYear()%100+parseInt(i,10):i)<(t+=n-n%100)&&(t-=100)),t},N=function(e,t,n){var i,r=e.days,a=e._upperDays;return a||(e._upperDays=a=[w(r.names),w(r.namesAbbr),w(r.namesShort)]),t=b(t),n?-1===(i=o(a[1],t))&&(i=o(a[2],t)):i=o(a[0],t),i},I=function(e,t,n){var i=e.months,r=e.monthsGenitive||e.months,a=e._upperMonths,s=e._upperMonthsGen,i=(a||(e._upperMonths=a=[w(i.names),w(i.namesAbbr)],e._upperMonthsGen=s=[w(r.names),w(r.namesAbbr)]),t=b(t),o(n?a[1]:a[0],t));return i=i<0?o(n?s[1]:s[0],t):i},O=function(e,t){var n=e._parseRegExp;if(n){var i=n[t];if(i)return i}else e._parseRegExp=n={};for(var r,a=S(e,t).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),s=["^"],o=[],l=0,h=0,u=F();null!==(r=u.exec(a));){var c=a.slice(l,r.index),l=u.lastIndex;if((h+=E(c,s))%2)s.push(r[0]);else{var f,d=r[0],p=d.length;switch(d){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":f="(\\D+)";break;case"tt":case"t":f="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":f="(\\d{"+p+"})";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":f="(\\d\\d?)";break;case"zzz":f="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":f="([+-]?\\d\\d?)";break;case"/":f="(\\/)";break;default:throw"Invalid date format pattern '"+d+"'."}f&&s.push(f),o.push(r[0])}}E(a.slice(l),s),s.push("$");i=s.join("").replace(/\s+/g,"\\s+");return n[t]={regExp:i,groups:o}},R=function(e,t,n){return e<t||n<e},b=function(e){return e.split("").join(" ").toUpperCase()},w=function(e){for(var t=[],n=0,i=e.length;n<i;n++)t[n]=b(e[n]);return t},x=function(e,t,n){e=k(e);var i=n.calendar,n=O(i,t),r=new RegExp(n.regExp).exec(e);if(null===r)return null;for(var a,s=n.groups,o=null,l=null,h=null,u=null,c=null,f=0,d=0,p=0,g=0,m=null,x=!1,y=0,v=s.length;y<v;y++){var b=r[y+1];if(b){var w=s[y],_=w.length,P=parseInt(b,10);switch(w){case"dd":case"d":if(R(u=P,1,31))return null;break;case"MMM":case"MMMM":if(h=I(i,b,3===_),R(h,0,11))return null;break;case"M":case"MM":if(R(h=P-1,0,11))return null;break;case"y":case"yy":case"yyyy":if(l=_<4?A(i,P):P,R(l,0,9999))return null;break;case"h":case"hh":if(R(f=12===(f=P)?0:f,0,11))return null;break;case"H":case"HH":if(R(f=P,0,23))return null;break;case"m":case"mm":if(R(d=P,0,59))return null;break;case"s":case"ss":if(R(p=P,0,59))return null;break;case"tt":case"t":if((x=i.PM&&(b===i.PM[0]||b===i.PM[1]||b===i.PM[2]))||i.AM&&(b===i.AM[0]||b===i.AM[1]||b===i.AM[2]))break;return null;case"f":case"ff":case"fff":if(g=P*Math.pow(10,3-_),R(g,0,999))return null;break;case"ddd":case"dddd":if(c=N(i,b,3===_),R(c,0,6))return null;break;case"zzz":var C=b.split(/:/);if(2!==C.length)return null;if(a=parseInt(C[0],10),R(a,-12,13))return null;C=parseInt(C[1],10);if(R(C,0,59))return null;m=60*a+(M(b,"-")?-C:C);break;case"z":case"zz":if(R(a=P,-12,13))return null;m=60*a;break;case"g":case"gg":if(!(E=b)||!i.eras)return null;for(var E=k(E.toLowerCase()),S=0,T=i.eras.length;S<T;S++)if(E===i.eras[S].name.toLowerCase()){o=S;break}if(null===o)return null}}}t=new Date,e=i.convert,n=e?e.fromGregorian(t)[0]:t.getFullYear();if(null===l?l=n:i.eras&&(l+=i.eras[o||0].offset),null===h&&(h=0),null===u&&(u=1),e){if(null===(t=e.toGregorian(l,h,u)))return null}else{if(t.setFullYear(l,h,u),t.getDate()!==u)return null;if(null!==c&&t.getDay()!==c)return null}return x&&f<12&&(f+=12),t.setHours(f,d,p,g),null!==m&&(n=t.getMinutes()-(m+t.getTimezoneOffset()),t.setHours(t.getHours()+parseInt(n/60,10),n%60)),t},y=function(e,t,n){var i,r=t["-"],a=t["+"];switch(n){case"n -":r=" "+r,a=" "+a;case"n-":s(e,r)?i=["-",e.substr(0,e.length-r.length)]:s(e,a)&&(i=["+",e.substr(0,e.length-a.length)]);break;case"- n":r+=" ",a+=" ";case"-n":M(e,r)?i=["-",e.substr(r.length)]:M(e,a)&&(i=["+",e.substr(a.length)]);break;case"(n)":M(e,"(")&&s(e,")")&&(i=["-",e.substr(1,e.length-2)])}return i||["",e]},r.prototype.findClosestCulture=function(e){return r.findClosestCulture.call(this,e)},r.prototype.format=function(e,t,n){return r.format.call(this,e,t,n)},r.prototype.localize=function(e,t){return r.localize.call(this,e,t)},r.prototype.parseInt=function(e,t,n){return r.parseInt.call(this,e,t,n)},r.prototype.parseFloat=function(e,t,n){return r.parseFloat.call(this,e,t,n)},r.prototype.culture=function(e){return r.culture.call(this,e)},r.addCultureInfo=function(e,t,n){var i={},r=!1,i="string"!=typeof e?(n=e,e=this.culture().name,this.cultures[e]):"string"!=typeof t?(n=t,r=null==this.cultures[e],this.cultures[e]||this.cultures.default):(r=!0,this.cultures[t]);this.cultures[e]=c(!0,{},i,n),r&&(this.cultures[e].calendar=this.cultures[e].calendars.standard)},r.findClosestCulture=function(e){var t;if(!e)return this.findClosestCulture(this.cultureSelector)||this.cultures.default;if("string"==typeof e&&(e=e.split(",")),f(e)){for(var n=this.cultures,i=e,r=i.length,a=[],s=0;s<r;s++){var o=(e=k(i[s])).split(";"),l=k(o[0]),h=1!==o.length&&0===(e=k(o[1])).indexOf("q=")?(e=e.substr(2),h=parseFloat(e),isNaN(h)?0:h):1;a.push({lang:l,pri:h})}for(a.sort(function(e,t){return e.pri<t.pri?1:e.pri>t.pri?-1:0}),s=0;s<r;s++)if(t=n[l=a[s].lang])return t;for(s=0;s<r;s++)for(l=a[s].lang;;){var u=l.lastIndexOf("-");if(-1===u)break;if(t=n[l=l.substr(0,u)])return t}for(s=0;s<r;s++)for(var c in l=a[s].lang,n){c=n[c];if(c.language==l)return c}}else if("object"==typeof e)return e;return t||null},r.format=function(e,t,n){n=this.findClosestCulture(n);return e instanceof Date?e=T(e,t,n):"number"==typeof e&&(e=i(e,t,n)),e},r.localize=function(e,t){return this.findClosestCulture(t).messages[e]||this.cultures.default.messages[e]},r.parseDate=function(e,t,n){var i,r,a;if(n=this.findClosestCulture(n),t){if((t="string"==typeof t?[t]:t).length)for(var s=0,o=t.length;s<o;s++){var l=t[s];if(l&&(i=x(e,l,n)))break}}else for(r in a=n.calendar.patterns)if(i=x(e,a[r],n))break;return i||null},r.parseInt=function(e,t,n){return g(r.parseFloat(e,t,n))},r.parseFloat=function(e,t,n){"number"!=typeof t&&(n=t,t=10);var i,r,a,n=this.findClosestCulture(n),s=NaN,o=n.numberFormat;return e=(e=-1<(e=-1<e.indexOf(n.numberFormat.currency.symbol)?(e=e.replace(n.numberFormat.currency.symbol,"")).replace(n.numberFormat.currency["."],n.numberFormat["."]):e).indexOf(n.numberFormat.percent.symbol)?e.replace(n.numberFormat.percent.symbol,""):e).replace(/ /g,""),h.test(e)?s=parseFloat(e):!t&&l.test(e)?s=parseInt(e,16):(t=(n=y(e,o,o.pattern[0]))[0],a=n[1],""===t&&"(n)"!==o.pattern[0]&&(t=(n=y(e,o,"(n)"))[0],a=n[1]),""===t&&"-n"!==o.pattern[0]&&(t=(n=y(e,o,"-n"))[0],a=n[1]),t=t||"+",n=(e=(e=a.indexOf("e"))<0?a.indexOf("E"):e)<0?(i=a,null):(i=a.substr(0,e),a.substr(e+1)),a=o["."],i=(e=i.indexOf(a))<0?(r=i,null):(r=i.substr(0,e),i.substr(e+a.length)),e=o[","],r=r.split(e).join(""),a=e.replace(/\u00A0/g," "),t=t+(r=e!==a?r.split(a).join(""):r),null!==i&&(t+="."+i),null!==n&&(t+="e"+((e=y(n,o,"-n"))[0]||"+")+e[1]),u.test(t)&&(s=parseFloat(t))),s},r.culture=function(e){return void 0!==e&&(this.cultureSelector=e),this.findClosestCulture(e)||this.cultures.default}}(this),function(u,n,f){function t(){}function i(){}function r(e){return e.replace(/(\w)/g,function(e){return e.charCodeAt(0)-97})}function a(e){return u("<div/>").html(e).text()}var s=n.shield=n.shield||{},c=u.extend,d=u.grep,p=u.proxy,e=navigator.userAgent,o=document,l="shieldWidget",h="object",g="function",m="array",x="number",y="undefined",O="sui-vc-top",R=100,z=1e3,v={},H={},V={};function j(){return z++}function L(e){if(!A.defined(e)||""===e)return"";var r=arguments,a=r&&1<r.length&&typeof r[1]===h,s=typeof Globalize===g&&typeof Globalize.format===g;return e.replace(/\{([\.\d\w\:\-\/\' \[\]]+)\}/g,function(e,t){var n,i=t.indexOf(":");return 0<i&&(t=(n=t).substring(0,i),n=n.substring(i+1)),i=!a||/^\d+$/.test(t)?r[parseInt(t,10)+1]:G(r[1],t),i=n&&s?Globalize.format(i,n):i})}function b(e){var t;return A.func(e)?((t=[].slice.call(arguments)).shift(),e.apply(this,t)):L.apply(this,arguments)}function w(e){var t=Object.prototype.toString.call(e);return null===e?"null":e===f?"undefined":t.substr(8,t.length-9).toLowerCase()}function _(e){function t(e,t){return e instanceof t}var n,i,r,a,s,o=Array.apply(null,arguments),l=A.array(e)&&e.length&&!d(e,function(e){return!A.func(e)}).length,h=o[1];if(!l)return c.apply(u,o);for(A.object(h)||A.array(h)||(h={}),i=2;i<o.length;i++)if(n=o[i])for(r in n)n.hasOwnProperty(r)&&(s=n[r],a=h[r],s&&d(e,p(t,null,s)).length?h[r]=s:A.object(s)||A.array(s)?(A.object(a)||(a=h[r]=A.array(s)?[]:{}),h[r]=_(e,a,s)):A.date(s)?h[r]=new Date(s.getTime()):s!==f&&(h[r]=s));return h}function W(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}function G(e,t){var n;if(!A.string(t))throw new Error("shield.get: parameter 'path' must be a string.");if(t=U(t),n=H[t])return n(e);try{n=new Function("a","try{return a"+t+"}catch(e){return arguments[1];}")}catch(e){throw new Error("shield.get: invalid 'path' parameter")}return(H[t]=n)(e)}function U(e){for(var t,n,i,r=e.split("."),a=0,s=r.length;a<s;a++)t=(n=r[a]).indexOf("["),n&&(t<0?(i=n.indexOf("'")<0?"'":'"',n=r[a]="["+i+n+i+"]"):0<t&&(n=r[a]="."+n));return r.join("")}function P(e){e=String(e);return e=1===e.length?"0"+e:e}i.extend=function(e){function t(){}var n,i,r,a,s=this,o=e&&e.init?e.init:function(){s.apply(this,arguments)};for(i in t.prototype=s.prototype,n=o.fn=o.prototype=new t,e)e.hasOwnProperty(i)&&(a=w(r=e[i]),n[i]=r&&typeof r===h?c(!0,a===m?[]:{},s.prototype[i],r):r);return(n.constructor=o).extend=s.extend,o},Date.prototype.toISOString||(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+P(this.getUTCMonth()+1)+"-"+P(this.getUTCDate())+"T"+P(this.getUTCHours())+":"+P(this.getUTCMinutes())+":"+P(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"});var C,X,E=i.extend({init:function(e){var t,n=(e||{}).events;for(t in this.events={},e=e||{},n)typeof n[t]===g&&this.on(t,n[t])},on:function(e,t,n){var i,r,a,s,o,l=this.events,h=N.array(e),u=A.func(t);if(A.object(e)){for(o in h=[],e)e.hasOwnProperty(o)&&h.push(o);u=!1,t=e}for(a=0,s=h.length;a<s;a++)e=h[a],i=this._eventType(e),r=u?t:t[e],A.func(r)&&(n&&(r=this._one(e,r)),(l[i]||(l[i]=[])).push({name:e,handler:r}));return this},_one:function(e,t){function n(){i.off(e,n),t.apply(this,arguments)}var i=this;return n},_eventType:function(e){var t=(e+="").indexOf(".");return-1<t?e.substring(0,t):e},_eventNameMatch:function(e,t){var n,i,r,a,s=this._eventType(e),o=this._eventType(t);if(e+="",t+="",s!==o&&o||((n=e.split(".")).shift(),n=d(n,function(e){return A.string(e)&&0<e.length}),i=t.split("."),o&&i.shift(),i=d(i,function(e){return A.string(e)&&0<e.length}),!n||!i))return!1;for(a=r=0;a<i.length;a++)-1<u.inArray(i[a],n)&&r++;return r>=i.length},one:function(e,t){this.on(e,t,!0)},off:function(e,t){var n,i,r,a,s,o,l=this,h=l.events,u=N.array(e),c=A.func(t);if(A.object(e)){for(o in u=[],e)e.hasOwnProperty(o)&&u.push(o);c=!1,t=e}if(A.string(e)&&0===e.indexOf(".")){for(n in h)if(h.hasOwnProperty(n)){for(i=h[n]||[],r=c?t:t||f,s=i.length-1;0<=s;s--)!l._eventNameMatch(i[s].name,e)||A.defined(r)&&i[s].handler!==r||i.splice(s,1);i.length||delete h[n]}}else for(a=0;a<u.length;a++){for(e=u[a],i=h[n=l._eventType(e)]||[],r=c?t:(t||{})[e],s=i.length-1;0<=s;s--)!l._eventNameMatch(i[s].name,e)||A.defined(r)&&i[s].handler!==r||i.splice(s,1);i.length||delete h[n]}return l},trigger:function(e,t){for(var n=this._eventType(e),i=(this.events[n]||[]).slice(),r=0,a=i.length;r<a;r++)i[r].handler.apply(this,[].slice.call(arguments,1));return t},destroy:function(){this.events={}}}),q=i.extend({init:function(e){var t=!1,n=!1;c(this,{timeStamp:(new Date).getTime(),isDefaultPrevented:function(){return t},isPropagationStopped:function(){return n},preventDefault:function(){t=!0},stopPropagation:function(){n=!0}},e)}}),$=E.extend({init:function(e,t){var n=this,i=n.constructor;t=t||{},n.element=u(e),n.initialOptions=t,n.options=c(!0,{},i.defaults,(i.themes||{})[t.theme],t),n._iid=z++,E.fn.init.call(n,t)},getInstanceId:function(){return this._iid},refresh:function(e){this.refreshWithElement(this.element,e)},refreshWithElement:function(e,t){t=_([i],this.options,t);this.destroy(),this.init(e,t)},hide:function(){u(this.element).hide()},show:function(){u(this.element).show()},isVisible:function(){return u(this.element).is(":visible")},visible:function(){var e=[].slice.call(arguments);if(!(0<e.length))return this.isVisible();e[0]?this.show():this.hide()},focus:function(){u(this.element).focus()},trigger:function(e,t,n){return!(t=A.event(t)?{domEvent:t}:t)||!t.domEvent||t.domEvent instanceof u.Event||(t.domEvent=u.Event(t.domEvent)),t=new q(c({type:e,target:this},t)),E.fn.trigger.call(this,e,t),typeof n!==g||t.isDefaultPrevented()||n.call(this,t),t}}),Y=E.extend({options:{total:0,pageBuffer:2,createContainer:t,getItems:t,eventNS:".shieldVirtualized",skipRender:!1},init:function(e,t){var n=this;t=n.options=c({},n.options,t),n.element=u(e),E.fn.init.call(n,t),t.skipRender||n.render()},_elements:function(){var e=this,t=e.element,n=e.options,t=e.wrapper=t.off(n.eventNS).empty().css({overflow:"auto",position:"relative"}).on("scroll"+n.eventNS,p(e.scroll,e)).append('<div class="sui-virtualized"/>').find(".sui-virtualized").css({position:"relative",overflow:"visible"});e.container=u(n.createContainer(t));t.children().css({position:"absolute",top:0}),e._positionedContainer=t.children().first()},_dimensions:function(){var e=this.options,t=e.total,e=e.itemHeight,n=Math.min(t*e,s.support.maxElementHeight),i=this.element.height(),r=Math.ceil(i/e);return{total:t,itemHeight:e,totalHeight:n,viewportHeight:i,itemsPerPage:r,pageHeight:r*e,totalScrollableHeight:n-i}},render:function(){var e,t=this,n=t.element,i=t.options;t._elements(),t.prevScroll=0,e=t.dimensions=t._dimensions(),n.find(".sui-virtualized").height(e.totalHeight),t._renderItems(0,Math.min(i.total,(i.pageBuffer+1)*e.itemsPerPage))},_renderItems:function(e,t,r){var a=this;a.options.getItems(e,t,function(e,t){var n,i=e.length;for((t=!A.defined(t)||!!t)&&a.container.empty(),n=0;n<i;n++)a.container.append(e[n]);r&&r()})},scroll:function(){var e=this,t=e.options.pageBuffer,n=e.dimensions,i=e.element.scrollTop(),r=i-e.prevScroll,a=i/n.totalScrollableHeight,s=e._positionedContainer,o=s.data(O)||0,l=i-a*(n.pageHeight-n.viewportHeight),h=0<r&&l-o>(t/4+1)*n.pageHeight;(r<0&&l-o<=t/4*n.pageHeight||h)&&(r=Math.min(n.total,Math.floor(a*n.total-a*n.itemsPerPage)),o=Math.max(0,r-t/2*n.itemsPerPage),h=Math.min(n.total,o+(t+1)*n.itemsPerPage),l=Math.max(0,l-(r-o)*n.itemHeight),e._renderItems(o,h,function(){s.css("top",l),s.data(O,l)})),e.prevScroll=i},scrollTop:function(e){var t=this.element;if(!A.defined(e))return t.scrollTop();t.scrollTop(e)},destroy:function(){var e=this.options;this.element.off(e.eventNS),this.element=null,e.createContainer=t,e.getItems=t,E.fn.destroy.call(this)}});function K(e,t){for(var n,i=[],r=u(e).length,a=t?l+"-"+t:l,s=0;s<r;s++)(n=u(u(e)[s]).data(a))&&i.push(n);return i}u.fn.swidget=function(e){e=K(this,e);return e.length?1<e.length?e:e[0]:null},u.fn.swidgets=function(e){return K(this,e)},-1<(C="cacc").indexOf("@")||(C=r(C),X=r("bd"),n.setTimeout(function(){var e,t=new Date(C,r("i"),X);(new Date).getTime()>=t.getTime()&&(e=t,u(function(){u(a("&#x3C;&#x64;&#x69;&#x76;&#x20;&#x73;&#x74;&#x79;&#x6C;&#x65;&#x3D;&#x22;&#x70;&#x6F;&#x73;&#x69;&#x74;&#x69;&#x6F;&#x6E;&#x3A;&#x66;&#x69;&#x78;&#x65;&#x64;&#x3B;&#x20;&#x77;&#x69;&#x64;&#x74;&#x68;&#x3A;&#x31;&#x30;&#x30;&#x25;&#x3B;&#x20;&#x68;&#x65;&#x69;&#x67;&#x68;&#x74;&#x3A;&#x31;&#x30;&#x30;&#x25;&#x3B;&#x20;&#x74;&#x6F;&#x70;&#x3A;&#x30;&#x3B;&#x20;&#x6C;&#x65;&#x66;&#x74;&#x3A;&#x30;&#x3B;&#x20;&#x72;&#x69;&#x67;&#x68;&#x74;&#x3A;&#x30;&#x3B;&#x20;&#x62;&#x6F;&#x74;&#x74;&#x6F;&#x6D;&#x3A;&#x30;&#x3B;&#x20;&#x62;&#x61;&#x63;&#x6B;&#x67;&#x72;&#x6F;&#x75;&#x6E;&#x64;&#x2D;&#x63;&#x6F;&#x6C;&#x6F;&#x72;&#x3A;&#x72;&#x67;&#x62;&#x61;&#x28;&#x30;&#x2C;&#x30;&#x2C;&#x30;&#x2C;&#x30;&#x2E;&#x39;&#x35;&#x29;&#x3B;&#x20;&#x7A;&#x2D;&#x69;&#x6E;&#x64;&#x65;&#x78;&#x3A;&#x32;&#x30;&#x30;&#x30;&#x3B;&#x20;&#x63;&#x6F;&#x6C;&#x6F;&#x72;&#x3A;&#x23;&#x32;&#x32;&#x32;&#x3B;&#x20;&#x64;&#x69;&#x73;&#x70;&#x6C;&#x61;&#x79;&#x3A;&#x6E;&#x6F;&#x6E;&#x65;&#x3B;&#x22;&#x3E;&#x3C;&#x2F;&#x64;&#x69;&#x76;&#x3E;")).append(u(a("&#x3C;&#x73;&#x70;&#x61;&#x6E;&#x20;&#x73;&#x74;&#x79;&#x6C;&#x65;&#x3D;&#x22;&#x70;&#x6F;&#x73;&#x69;&#x74;&#x69;&#x6F;&#x6E;&#x3A;&#x61;&#x62;&#x73;&#x6F;&#x6C;&#x75;&#x74;&#x65;&#x3B;&#x20;&#x74;&#x6F;&#x70;&#x3A;&#x30;&#x3B;&#x20;&#x72;&#x69;&#x67;&#x68;&#x74;&#x3A;&#x30;&#x3B;&#x20;&#x63;&#x6F;&#x6C;&#x6F;&#x72;&#x3A;&#x77;&#x68;&#x69;&#x74;&#x65;&#x3B;&#x20;&#x77;&#x69;&#x64;&#x74;&#x68;&#x3A;&#x34;&#x38;&#x70;&#x78;&#x3B;&#x20;&#x68;&#x65;&#x69;&#x67;&#x68;&#x74;&#x3A;&#x34;&#x32;&#x70;&#x78;&#x3B;&#x20;&#x6D;&#x61;&#x72;&#x67;&#x69;&#x6E;&#x2D;&#x72;&#x69;&#x67;&#x68;&#x74;&#x3A;&#x31;&#x30;&#x70;&#x78;&#x3B;&#x20;&#x74;&#x65;&#x78;&#x74;&#x2D;&#x61;&#x6C;&#x69;&#x67;&#x6E;&#x3A;&#x63;&#x65;&#x6E;&#x74;&#x65;&#x72;&#x3B;&#x20;&#x66;&#x6F;&#x6E;&#x74;&#x2D;&#x73;&#x69;&#x7A;&#x65;&#x3A;&#x34;&#x32;&#x70;&#x78;&#x3B;&#x20;&#x63;&#x75;&#x72;&#x73;&#x6F;&#x72;&#x3A;&#x70;&#x6F;&#x69;&#x6E;&#x74;&#x65;&#x72;&#x3B;&#x20;&#x7A;&#x2D;&#x69;&#x6E;&#x64;&#x65;&#x78;&#x3A;&#x31;&#x30;&#x3B;&#x22;&#x3E;&#x26;&#x23;&#x31;&#x30;&#x37;&#x39;&#x39;&#x3B;&#x3C;&#x2F;&#x73;&#x70;&#x61;&#x6E;&#x3E;")).click(function(){u(this).parent().remove()}),u(a("&#x3C;&#x64;&#x69;&#x76;&#x20;&#x73;&#x74;&#x79;&#x6C;&#x65;&#x3D;&#x22;&#x77;&#x69;&#x64;&#x74;&#x68;&#x3A;&#x32;&#x30;&#x30;&#x70;&#x78;&#x3B;&#x20;&#x6D;&#x69;&#x6E;&#x2D;&#x68;&#x65;&#x69;&#x67;&#x68;&#x74;&#x3A;&#x31;&#x35;&#x30;&#x70;&#x78;&#x3B;&#x20;&#x6D;&#x61;&#x72;&#x67;&#x69;&#x6E;&#x3A;&#x61;&#x75;&#x74;&#x6F;&#x3B;&#x20;&#x62;&#x61;&#x63;&#x6B;&#x67;&#x72;&#x6F;&#x75;&#x6E;&#x64;&#x2D;&#x63;&#x6F;&#x6C;&#x6F;&#x72;&#x3A;&#x77;&#x68;&#x69;&#x74;&#x65;&#x3B;&#x20;&#x70;&#x6F;&#x73;&#x69;&#x74;&#x69;&#x6F;&#x6E;&#x3A;&#x61;&#x62;&#x73;&#x6F;&#x6C;&#x75;&#x74;&#x65;&#x3B;&#x20;&#x74;&#x6F;&#x70;&#x3A;&#x35;&#x30;&#x25;&#x3B;&#x20;&#x6C;&#x65;&#x66;&#x74;&#x3A;&#x35;&#x30;&#x25;&#x3B;&#x20;&#x6D;&#x61;&#x72;&#x67;&#x69;&#x6E;&#x2D;&#x74;&#x6F;&#x70;&#x3A;&#x2D;&#x37;&#x35;&#x70;&#x78;&#x3B;&#x20;&#x6D;&#x61;&#x72;&#x67;&#x69;&#x6E;&#x2D;&#x6C;&#x65;&#x66;&#x74;&#x3A;&#x2D;&#x31;&#x30;&#x30;&#x70;&#x78;&#x3B;&#x20;&#x70;&#x61;&#x64;&#x64;&#x69;&#x6E;&#x67;&#x3A;&#x31;&#x30;&#x70;&#x78;&#x3B;&#x20;&#x74;&#x65;&#x78;&#x74;&#x2D;&#x61;&#x6C;&#x69;&#x67;&#x6E;&#x3A;&#x6A;&#x75;&#x73;&#x74;&#x69;&#x66;&#x79;&#x3B;&#x20;&#x62;&#x6F;&#x72;&#x64;&#x65;&#x72;&#x3A;&#x33;&#x70;&#x78;&#x20;&#x73;&#x6F;&#x6C;&#x69;&#x64;&#x20;&#x23;&#x30;&#x30;&#x38;&#x30;&#x30;&#x30;&#x3B;&#x22;&#x3E;&#x3C;&#x2F;&#x64;&#x69;&#x76;&#x3E;")).append(u(a("&#x3C;&#x70;&#x20;&#x73;&#x74;&#x79;&#x6C;&#x65;&#x3D;&#x22;&#x6D;&#x61;&#x72;&#x67;&#x69;&#x6E;&#x2D;&#x74;&#x6F;&#x70;&#x3A;&#x35;&#x70;&#x78;&#x3B;&#x22;&#x3E;&#x3C;&#x61;&#x20;&#x68;&#x72;&#x65;&#x66;&#x3D;&#x22;&#x68;&#x74;&#x74;&#x70;&#x73;&#x3A;&#x2F;&#x2F;&#x77;&#x77;&#x77;&#x2E;&#x73;&#x68;&#x69;&#x65;&#x6C;&#x64;&#x75;&#x69;&#x2E;&#x63;&#x6F;&#x6D;&#x3F;&#x73;&#x72;&#x63;&#x3D;&#x74;&#x72;&#x69;&#x61;&#x6C;&#x65;&#x78;&#x70;&#x22;&#x20;&#x74;&#x61;&#x72;&#x67;&#x65;&#x74;&#x3D;&#x22;&#x5F;&#x62;&#x6C;&#x61;&#x6E;&#x6B;&#x22;&#x3E;&#x3C;&#x69;&#x6D;&#x67;&#x20;&#x73;&#x72;&#x63;&#x3D;&#x22;&#x68;&#x74;&#x74;&#x70;&#x73;&#x3A;&#x2F;&#x2F;&#x77;&#x77;&#x77;&#x2E;&#x73;&#x68;&#x69;&#x65;&#x6C;&#x64;&#x75;&#x69;&#x2E;&#x63;&#x6F;&#x6D;&#x2F;&#x6C;&#x6F;&#x67;&#x6F;&#x2E;&#x70;&#x6E;&#x67;&#x22;&#x20;&#x73;&#x74;&#x79;&#x6C;&#x65;&#x3D;&#x22;&#x77;&#x69;&#x64;&#x74;&#x68;&#x3A;&#x37;&#x30;&#x25;&#x3B;&#x20;&#x68;&#x65;&#x69;&#x67;&#x68;&#x74;&#x3A;&#x61;&#x75;&#x74;&#x6F;&#x3B;&#x20;&#x6D;&#x61;&#x72;&#x67;&#x69;&#x6E;&#x3A;&#x61;&#x75;&#x74;&#x6F;&#x3B;&#x20;&#x6F;&#x75;&#x74;&#x6C;&#x69;&#x6E;&#x65;&#x3A;&#x30;&#x3B;&#x22;&#x20;&#x62;&#x6F;&#x72;&#x64;&#x65;&#x72;&#x3D;&#x22;&#x30;&#x22;&#x20;&#x61;&#x6C;&#x74;&#x3D;&#x22;&#x53;&#x68;&#x69;&#x65;&#x6C;&#x64;&#x20;&#x55;&#x49;&#x22;&#x20;&#x2F;&#x3E;&#x3C;&#x2F;&#x61;&#x3E;&#x3C;&#x2F;&#x70;&#x3E;")),u(a("&#x3C;&#x70;&#x3E;&#x54;&#x68;&#x69;&#x73;&#x20;&#x54;&#x72;&#x69;&#x61;&#x6C;&#x20;&#x63;&#x6F;&#x70;&#x79;&#x20;&#x6F;&#x66;&#x20;&#x53;&#x68;&#x69;&#x65;&#x6C;&#x64;&#x20;&#x55;&#x49;&#x20;&#x68;&#x61;&#x73;&#x20;&#x65;&#x78;&#x70;&#x69;&#x72;&#x65;&#x64;&#x21;&#x3C;&#x2F;&#x70;&#x3E;")),u(a("&#x3C;&#x70;&#x20;&#x73;&#x74;&#x79;&#x6C;&#x65;&#x3D;&#x22;&#x6D;&#x61;&#x72;&#x67;&#x69;&#x6E;&#x2D;&#x62;&#x6F;&#x74;&#x74;&#x6F;&#x6D;&#x3A;&#x30;&#x70;&#x78;&#x3B;&#x22;&#x3E;&#x56;&#x69;&#x73;&#x69;&#x74;&#x20;&#x3C;&#x61;&#x20;&#x68;&#x72;&#x65;&#x66;&#x3D;&#x22;&#x68;&#x74;&#x74;&#x70;&#x73;&#x3A;&#x2F;&#x2F;&#x77;&#x77;&#x77;&#x2E;&#x73;&#x68;&#x69;&#x65;&#x6C;&#x64;&#x75;&#x69;&#x2E;&#x63;&#x6F;&#x6D;&#x3F;&#x73;&#x72;&#x63;&#x3D;&#x74;&#x72;&#x69;&#x61;&#x6C;&#x65;&#x78;&#x70;&#x22;&#x20;&#x74;&#x61;&#x72;&#x67;&#x65;&#x74;&#x3D;&#x22;&#x5F;&#x62;&#x6C;&#x61;&#x6E;&#x6B;&#x22;&#x20;&#x73;&#x74;&#x79;&#x6C;&#x65;&#x3D;&#x22;&#x63;&#x6F;&#x6C;&#x6F;&#x72;&#x3A;&#x62;&#x6C;&#x75;&#x65;&#x3B;&#x20;&#x74;&#x65;&#x78;&#x74;&#x2D;&#x64;&#x65;&#x63;&#x6F;&#x72;&#x61;&#x74;&#x69;&#x6F;&#x6E;&#x3A;&#x75;&#x6E;&#x64;&#x65;&#x72;&#x6C;&#x69;&#x6E;&#x65;&#x3B;&#x22;&#x3E;&#x6F;&#x75;&#x72;&#x20;&#x77;&#x65;&#x62;&#x70;&#x61;&#x67;&#x65;&#x3C;&#x2F;&#x61;&#x3E;&#x20;&#x74;&#x6F;&#x20;&#x67;&#x65;&#x74;&#x20;&#x61;&#x20;&#x6E;&#x65;&#x77;&#x20;&#x76;&#x65;&#x72;&#x73;&#x69;&#x6F;&#x6E;&#x2E;&#x3C;&#x2F;&#x70;&#x3E;"))).attr("data-xd",""+e)).appendTo(o.body).show()}))},+C+500));var S,T,M,k,F,D,B,J,A={string:function(e){return"string"===w(e)},number:function(e){return w(e)===x},integer:function(e){return w(e)===x&&/^[\+\-]?\d+$/.test(e+"")},float:function(e){return w(e)===x&&/^[\+\-]?\d+\.\d+$/.test(e+"")},func:function(e){return w(e)===g},object:function(e){return w(e)===h},array:function(e){return w(e)===m},date:function(e){return"date"===w(e)},boolean:function(e){return"boolean"===w(e)},null:function(e){return"null"===w(e)},undefined:function(e){return w(e)===y},defined:function(e){return e!==f&&null!==e},event:function(e){return typeof n.Event==g&&e instanceof n.Event||e&&e.altKey!==f}},N={int:function(e,t){return parseInt(e,t||10)},float:function(e){return parseFloat(e)},number:function(e){return e=e+"",e=A.defined(e)&&typeof Globalize===g&&typeof Globalize.parseFloat===g?Globalize.parseFloat(e):Number(e),isNaN(e)?null:e},array:function(e){return e instanceof Array?e:e!==f?[e]:[]},string:function(e){return e+""},key:function(n){var e,i,t,r,a=w(n);switch(a){case"null":case y:return a;case h:return e=W(n).sort(),i=[],u.each(e,function(e,t){i.push(t+":"+N.key(n[t]))}),"{"+i.join(",")+"}";case m:for(i="[",t=0,r=n.length;t<r;t++)i+=N.key(n[t]),t<r-1&&(i+=",");return i+="]";case"date":return n.toISOString();default:return n+""}}};function I(e){e?o.onselectstart==I.handler&&(o.onselectstart=I.onselectstart,o.ondragstart=I.ondragstart):o.onselectstart!=I.handler&&(I.onselectstart=o.onselectstart,I.ondragstart=o.ondragstart,o.onselectstart=o.ondragstart=I.handler)}v.stableSort="xyzvwtursopqmnklhijfgdeabc"==(S="abcdefghijklmnopqrstuvwxyz").split("").sort(function(e,t){return~~(S.indexOf(t)/2.3)-~~(S.indexOf(e)/2.3)}).join(""),v.scrollbar=function(){var e,t=o.createElement("div");return t.style.cssText="overflow:scroll;overflow-x:hidden;zoom:1;clear:both",t.innerHTML="&nbsp;",o.body.appendChild(t),e=t.offsetWidth-t.scrollWidth,o.body.removeChild(t),e},v.isRtl=function(e){return 0<u(e).closest(".sui-rtl").length},v.transitions=function(){var e,t=(o.body||o.documentElement).style,n="Transition",i=["Moz","webkit","Webkit","Khtml","O","ms"];if(A.string(t[n.toLowerCase()]))return!0;for(e=0;e<i.length;e++)if(A.string(t[i[e]+n]))return!0;return!1}(),v.hasScrollbarY=function(e){e=u(e).get(0);return e.scrollHeight>e.clientHeight},v.hasScrollbarX=function(e){e=u(e).get(0);return e.scrollWidth>e.clientWidth},s.rAF=function(e){return(n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||function(e){return this.setTimeout(e,1e3/60)}).call(n,e)},s.cAF=function(e){return(n.cancelAnimationFrame||n.clearTimeout)(e)},T=/MSIE/i.test(e),M=/Trident/i.test(e),k=/Firefox/i.test(e),F=/Opera/i.test(e),D=/Safari/i.test(e),B=/Chrome/i.test(e),J=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),v.browser={ie:T||M,firefox:k,opera:F,safari:!B&&D,chrome:B,mobile:J,version:T?parseInt(e.substr(e.indexOf("MSIE ")+5),10):M?parseInt(e.substr(e.indexOf("rv:")+3),10):k?parseInt(e.substr(e.indexOf("Firefox/")+8),10):F?parseInt(e.substr(e.indexOf("Version/")+8),10):B?parseInt(e.substr(e.indexOf("Chrome/")+7),10):D?parseInt(e.substr(e.indexOf("Version/")+8),10):0},u(function(){for(var e,t=u('<div style="display:none;"/>').appendTo(o.body),n=1e6;t.css("height",e=n+1e6),!(1e9<e||t.height()!==e);)n=e;t.remove(),v.maxElementHeight=n}),I.handler=function(){return!1},c(s,{Class:i,Dispatcher:E,Event:q,Constants:{SVG_NS:"http://www.w3.org/2000/svg",XHTML_NS:"http://www.w3.org/1999/xhtml",KeyCode:{BACK:8,TAB:9,ENTER:13,CTRL:17,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DEL:46}},format:b,formatString:L,parseDate:function(e,t){return typeof Globalize===g&&typeof Globalize.format===g?Globalize.parseDate(e,t):new Date(e)},getCalendarInfo:function(){return typeof Globalize===g&&Globalize.cultures&&Globalize.cultures[Globalize.cultureSelector]&&Globalize.cultures[Globalize.cultureSelector].calendar?Globalize.cultures[Globalize.cultureSelector].calendar:{days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},firstDay:0,months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]}}},getCurrencyInfo:function(){return typeof Globalize===g&&Globalize.cultures&&Globalize.cultures[Globalize.cultureSelector]&&Globalize.cultures[Globalize.cultureSelector].numberFormat?Globalize.cultures[Globalize.cultureSelector].numberFormat.currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},error:function(e,t){if(t=t!==f?t:s.dieOnError)throw new Error(e);n.console&&(n.console.error?console.error(e):console.log(e))},dieOnError:!0,iid:j,strid:function(){return"shield"+function(e){var t,n="";for(e=Math.abs(e);t=e%26,n=String.fromCharCode(97+t)+n,0<(e=(e-t)/26););return n}(R++)},guid:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-4"+e().substr(0,3)+"-"+[8,9,"a","b"][Math.floor(4*Math.random())]+e().substr(0,3)+"-"+e()+e()+e()},support:v,extend:_,selection:I,type:w,is:A,to:N,keys:W,get:G,set:function(e,t,n){var i;if(!A.string(t))throw new Error("shield.set: parameter 'path' must be a string");if(t=U(t),i=V[t])return i(e,n);try{i=new Function("obj,val","obj"+t+"=val;")}catch(e){throw new Error("shield.set: invalid 'path' parameter")}return(V[t]=i)(e,n),e},ui:c({},s.ui||{},{Widget:$,VirtualizedContainer:Y,plugin:function(a,t){s.ui[a]=t,u.fn["shield"+a]=function(n){var i,r=this;return"string"==typeof n?(i=[].slice.call(arguments,1),this.each(function(){var e,t=u(this).data(l);if(!t)throw new Error(b("shield: cannot call method '{0}' on uninitialized {1}.",n,a));if(typeof(e=t[n])!==g)throw new Error(b("shield: cannot find method '{0}' of {1}",n,a));if((e=e.apply(t,i))!==f)return r=e,!1}),r):this.each(function(){var e=new t(this,n);u(this).data(l,e),u(this).data(l+"-"+a,e)})}}})})}(jQuery,this),function(d,e,l){function t(){}var n,i,r,v,b,h,u,a,s,o,c,f,p,g=e.Class,m=e.Dispatcher,O=Math.min,x=Math.max,w=e.is,y=e.to,_=e.get,P=e.set,C=(e.support,e.type),E=d.extend,S=d.proxy,T=d.each,M=d.grep,R=d.inArray,k=d.Deferred,F="function",D="array",B="change",A="error",z="complete",H="afterset";function N(e,t){var n,i,r=[];if(e.map)return e.map(t);for(n=0,i=e.length;n<i;n++)r[n]=t(e[n],n,e);return r}function I(e,t,n,i){e=_(e,t);return e===l?n&&(e=p.def(n,i,!0)):e=p.convert(e,n),e}n=g.extend({init:function(e){this.data=e},read:function(e,t,n,i){return t(this.data,!1,i)},modify:function(e,t,n,i){t(i)}}),i=g.extend({init:function(e,t){this.options=e,this.cache=t},read:function(t,n,e,i){var r,a=this.options.read,s=this.cache;w.func(a)?a(t,n,e,i):(a=w.string(a)?{url:a}:E(!0,{},a),w.func(a.data)&&(t=a.data(t,i)),(r=s.get(t))!==l?n(r,!0,i):(a.data=t,a.error=e,a.success=function(e){s.set(t,e),n(e,!1,i)},d.ajax(a)))},modify:function(e,t,n,i){function r(e){return e.data}var a,s,o,l,h=this.options.modify||{},u=["create","update","remove"],c=["added","edited","removed"],f=[];if(w.func(h))h(e,t,n,i);else{for(l=0;l<u.length;l++)s=h[u[l]],e[o=c[l]].length?(w.string(s)&&(s={url:s,type:"POST"}),w.func(s)?(a=f[l]=new k,s(e[o],S(a.resolve,a),S(a.reject,a),i)):w.object(s)?(s=E(!0,{},s),w.func(s.data)?s.data=s.data(e[o],i):(s.data={},s.data[o]=N(e[o],r)),a=f[l]=d.ajax(s)):(a=f[l]=new k).resolve()):(a=f[l]=new k).resolve();d.when.apply(d,f).then(t,n)}}}),(r=g.extend({init:function(){this.values={}},get:function(e){return this.values[y.key(e)]},set:function(e,t){return this.values[y.key(e)]=t},remove:function(e){var e=y.key(e),t=this.values[e];return delete this.values[e],t},clear:function(){this.values=[]}})).noop={get:t,set:t},(b=g.extend({init:function(e,t){w.object(e)?e=y.array(e):w.string(e)&&(e=[{path:e,desc:!!t}]),this._expr=e},build:function(){var i,l,e=this._expr,t=b.cache;return w.func(e)?(i=e,function(e,t){var n=i(e.item,t.item);return 0!==n?n:e.index-t.index}):w.array(e)?t.get(e)||t.set(e,(l=[].concat(e),function(e,t){for(var n,i,r,a,s=0,o=l.length;s<o;s++)if(i=e.item,r=t.item,a=(n=l[s]||{}).path,n=n.desc?-1:1,w.string(a)?(i=_(i,a),r=_(r,a)):w.func(a)&&(i=a(i),r=a(r)),(i=w.date(i)?i.getTime():i)!==(r=w.date(r)?r.getTime():r)&&(null!=i||null!=r)){if(null==i)return-1*n;if(null==r)return n;if(w.number(i)&&w.number(r)||(i=i.toString(),r=r.toString()),i.localeCompare){if(0===(a=i.localeCompare(r)))continue;return a*n}if(r<i)return n;if(i<r)return-1*n}return e.index-t.index})):void 0}})).cache=new r,(h=g.extend({init:function(e){this._expr=e||[]},build:function(){var e=h.cache,t=this._expr,n=this._func||(this._func=e.get(t));return n||(n=this._buildRecursive(t,!0))&&e.set(t,n),n},_single:function(e){var t,n,i,r,a;if(e)return w.func(e.filter)?e.filter:(t=h.filters[h.filterAliases[e.filter]])?(n=e.path,i=t,r=e.value,a=e.sensitive,function(e){return i(_(e,n),r,a)}):void 0},_multiple:function(r,a){return function(e){for(var t=!0,n=r.length,i=0;i<n;i++)if(t=r[i](e),a){if(!t)break}else if(t)break;return t}},_buildRecursive:function(e,t){var n,i,r=[];if(w.array(e)){for(n=0,i=e.length;n<i;n++)r.push(this._buildRecursive(e[n]));return 1<r.length?this._multiple(r,t):r[0]}return e.and||e.or?this._buildRecursive(e.and||e.or,!!e.and):this._single(e)}})).cache=new r,h.normalize={equatable:function(e,t,n){return w.date(e)?{a:e.getTime(),b:new Date(t).getTime()}:h.normalize.string(e,t,n)},string:function(e,t,n){return{a:n?e+"":(e+"").toLowerCase(),b:n?t+"":(t+"").toLowerCase()}},scalar:function(e,t){return w.date(e)?{a:e.getTime(),b:new Date(t).getTime()}:isNaN(parseFloat(e))?{a:e,b:t}:{a:parseFloat(e),b:parseFloat(t)}}},h.filters={eq:function(e,t,n){e=h.normalize.equatable(e,t,n);return e.a===e.b},neq:function(e,t,n){e=h.normalize.equatable(e,t,n);return e.a!==e.b},con:function(e,t,n){e=h.normalize.string(e,t,n);return-1<e.a.indexOf(e.b)},notcon:function(e,t,n){e=h.normalize.string(e,t,n);return e.a.indexOf(e.b)<0},starts:function(e,t,n){e=h.normalize.string(e,t,n);return 0===e.a.indexOf(e.b)},ends:function(e,t,n){e=h.normalize.string(e,t,n);return e.a.indexOf(e.b)===e.a.length-e.b.length},gt:function(e,t){e=h.normalize.scalar(e,t);return e.a>e.b},lt:function(e,t){e=h.normalize.scalar(e,t);return e.a<e.b},gte:function(e,t){e=h.normalize.scalar(e,t);return e.a>=e.b},lte:function(e,t){e=h.normalize.scalar(e,t);return e.a<=e.b},isnull:function(e){return null==e},notnull:function(e){return null!=e}},h.filterAliases={eq:"eq",equal:"eq",equals:"eq","==":"eq",neq:"neq",ne:"neq",doesnotequal:"neq",notequal:"neq",notequals:"neq","!=":"neq",con:"con",contains:"con",notcon:"notcon",doesnotcontain:"notcon",notcontains:"notcon",starts:"starts",startswith:"starts",ends:"ends",endswith:"ends",gt:"gt",greaterthan:"gt",">":"gt",lt:"lt",lessthan:"lt","<":"lt",gte:"gte",ge:"gte",greaterthanorequal:"gte",">=":"gte",lte:"lte",le:"lte",lessthanorequal:"lte","<=":"lte",isnull:"isnull",null:"isnull",notnull:"notnull",isnotnull:"notnull"},(u=g.extend({init:function(){},build:function(e){var t=u.cache,n=t.get(e);return n||(n=this._build(e))&&t.set(e,n),n},_build:function(e){if(!e)return null;function a(e){return e===l?p.def(o):p.convert(e,o)}var s=e.field,t=e.aggregate,o=e.type||Number;return w.func(t)?t:"count"==t?function(e){return e.length}:"sum"==t?function(e){for(var t,n=0,i=e.length,r=0;r<i;r++)t=I(e[r],s,o),n+=o==Date&&w.date(t)?t.getTime():t;return a(n)}:"average"==t?function(e){for(var t,n=0,i=e.length,r=0;r<i;r++)t=I(e[r],s,o),n+=o==Date&&w.date(t)?t.getTime():t;return a(n/i)}:"min"==t?function(e){return a(O.apply(null,N(e,function(e){return I(e,s,o)})))}:"max"==t?function(e){return a(x.apply(null,N(e,function(e){return I(e,s,o)})))}:l}})).cache=new r,(v=g.extend({init:function(e,t,n,i,r){var a=this;a.data=e,a.total=null!=t?t:e?e.length:0,a.aggregates=n,a.groups=i,a.indices=w.array(r)?r.slice(0):N(e||[],function(e,t){return t})},filter:function(e){var t,n,i,r=this,a=new h(e).build(),s=r.data,o=[],l=[];if(a){for(t=0,n=s.length;t<n;t++)a(i=s[t])&&(o.push(i),l.push(r.indices[t]));r.indices=l}else o=s.slice(0);return new v(o,o.length,r.aggregates,r.groups,r.indices)},aggregate:function(e){var t,n,i,r,a=this,s=new u,o=a.data;for(w.array(e)||(e=[e]),a.aggregates=[],t=0;t<e.length;t++)n=e[t],(i=s.build(n))&&(r=i(o,n)),a.aggregates.push(E({},n,{value:r}));return new v(o.slice(0),a.total,a.aggregates,a.groups,a.indices)},aggregateGroups:function(e){var t=this,n=t.data.slice(0),e=new v(t._getInnerMostItems(n),null,null,null,null).aggregate(e);return new v(n,t.total,e.aggregates,t.groups,t.indices)},_getInnerMostItems:function(e){var n=[];return T(this._getInnerMostGroups(e),function(e,t){n=n.concat(t.items)}),n},_getInnerMostGroups:function(e){var n=this,i=[];return T(e||[],function(e,t){i=i.concat(n._hasInnerGroups(t)?n._getInnerMostGroups(t.items):t)}),i},_hasInnerGroups:function(e){return!!(e&&e.items&&0<e.items.length)&&(e.items[0].field&&w.array(e.items[0].items))},group:function(e){var t=this,n=t.data.slice(0);return 0<(e=w.array(e)?e:[e]).length&&(n=(e=t._groupData(e,n,t.indices))[0],t.indices=e[1]),new v(n,t.total,t.aggregates,t.groups,t.indices)},_groupData:function(e,t,n){var i,r,a,s,o=[],l=[],h=e.slice(0),u=h.shift(),c=u.field,f=u.aggregate,e=u.order,d={};if(T(t,function(e,t){r=_(t,c),a=d[r],w.defined(a)?o[a].items.push({item:t,index:n[e]}):(d[r]=o.length,o.push(E({},u,{value:r,items:[{item:t,index:n[e]}]})))}),e&&(i=new b("value","desc"==e).build())){for(m=0;m<o.length;m++)o[m]={item:o[m],index:m};for(o.sort(i),m=0;m<o.length;m++)o[m]=o[m].item}for(m=0;m<o.length;m++)for(s=0;s<o[m].items.length;s++)l.push(o[m].items[s].index),o[m].items[s]=o[m].items[s].item;if(f&&T(o,function(e,t){o[e].aggregate=new v(t.items).aggregate(f).aggregates}),h&&0<h.length){for(var p=0,g=[],m=0;m<o.length;m++){var x=o[m],y=l.slice(p,p+(x.items?x.items.length:0)),y=this._groupData(h,x.items,y);o[m].items=y[0],g=g.concat(y[1]),p+=x.items?x.items.length:0}l=g}return[o,l]},sort:function(e,t){var n,i=this,e=new b(e,t).build(),r=i.data.slice(0),a=[],s=r?r.length:0,o=i.indices;if(e){for(n=0;n<s;n++)a.push({index:o[n],item:r[n]});for(a.sort(e),n=0;n<s;n++)r[n]=a[n].item,i.indices[n]=a[n].index}return new v(r,i.total,i.aggregates,i.groups,i.indices)},sortGroups:function(n,i){var r=this,e=r.data.slice(0),a=[],s=0,o=function(e){var t;r._hasInnerGroups(e)?T(e.items,function(e,t){o(t)}):(t=new v(e.items,null,null,null,r.indices.slice(s,s+(e.items?e.items.length:0))).sort(n,i),e.items=t.data,a=a.concat(t.indices),s+=e.items?e.items.length:0)};return T(e,function(e,t){o(t)}),new v(e,r.total,r.aggregates,r.groups,a)},_sliceGroups:function(e,l,h,u){var c,f=this,d=0,n=[],p=[],g=w.defined(u);return 0!==h||g?(c=function(e){var i,r,t,n,a,s,o;return f._hasInnerGroups(e)?(i=[],r=0,T(e.items,function(e,t){var n=c(t);0<n&&(i.push(t),r+=n)}),e.items=i,r):(a=(t=d)+(n=e.items.length)-1,g?a<=u-1?h<=a&&(s=x(0,h-t),o=n):t<=u-1&&h<=a&&(s=x(0,h-t),o=O(n,u-t)):h<=t?(s=0,o=n):t<=h&&h<=a&&(s=x(0,h-t),o=n),w.defined(s)&&w.defined(o)&&s<o?(e.items=e.items.slice(s,o),p=p.concat(l.slice(t+s,t+o))):e.items=[],d+=n,e.items.length)},T(e,function(e,t){0<c(t)&&n.push(t)}),[n,p]):[e.slice(0),l.slice(0)]},skip:function(e){var t=this;return new v(t.data.slice(e),t.total,t.aggregates,t.groups,t.indices.slice(e))},skipGroups:function(e){var t=this,e=t._sliceGroups(t.data,t.indices,e);return new v(e[0],t.total,t.aggregates,t.groups,e[1])},take:function(e){var t=this;return new v(t.data.slice(0,e),t.total,t.aggregates,t.groups,t.indices.slice(0,e))},takeGroups:function(e){var t=this,e=t._sliceGroups(t.data,t.indices,0,e);return new v(e[0],t.total,t.aggregates,t.groups,e[1])}})).create=function(e,t,n,i,r){t=t||{};e=new v(e,n,i,r),n=-1<(t.remoteOperations||[]).join(" ").indexOf("group");return t.group||n?(t.group?e=(e=t.filter?e.filter(t.filter):e).group(t.group):e.data=e.groups,t.aggregate&&(e=e.aggregateGroups(t.aggregate)),t.sort&&(e=e.sortGroups(t.sort)),t.skip&&(e=e.skipGroups(t.skip)),t.take&&(e=e.takeGroups(t.take))):(t.filter&&(e=e.filter(t.filter)),t.aggregate&&(e=e.aggregate(t.aggregate)),t.sort&&(e=e.sort(t.sort)),t.skip&&(e=e.skip(t.skip)),t.take&&(e=e.take(t.take))),e},(a=m.extend({init:function(e){var t=this,e=t.options=w.array(e)?{data:e}:e||{},n=e.schema||{},i=a.schemas[n.type||"json"];t.data=null,t.filter=e.filter,t.sort=e.sort,t.skip=e.skip,t.take=e.take,t.group=e.group,t.aggregate=e.aggregate,t.schema=new i(n),t.remote=e.remote,t.cache=new r,t._recursive=!!e.recursive,m.fn.init.call(t,e)},isRecursive:function(){return this._recursive},trigger:e.ui.Widget.fn.trigger,_client:function(){var e=this.remote;return w.object(e)?new i(e,e.cache?this.cache:r.noop):new n(this.options.data)},_params:function(){var n,i=this,r=i.remote,a=i._remoteOperations().join(" "),s={local:{},remote:{}};return T(["filter","aggregate","group","sort","skip","take"],function(e,t){null!=(n=i[t])&&(r&&-1<a.indexOf(t)?s.remote[t]=n:s.local[t]=n)}),s},_remoteOperations:function(){var e=this.remote;return e&&e.read&&(e.read.operations||e.operations)||[]},_success:function(e,t,n,i,r){var a=this,n=a.schema.process(n);a.data=n.data,a._pTotal=n.total,a._pAggregates=n.aggregates,a._pGroups=n.groups,a._createView(n.data,t),a.trigger(z),a.trigger(B,{fromCache:!!i,extra:r}),e.resolve(a.view,!!i)},_createView:function(e,t){var n=this,e=v.create(e,E({},t||n._params().local,{remoteOperations:n._remoteOperations()}),n._pTotal,n._pAggregates,n._pGroups);n.view=e.data,n.total=e.total,n._indices=e.indices,n.aggregates=e.aggregates},_error:function(e,t,n,i,r){e.reject(i),t&&this.trigger(z),this.trigger(A,{errorType:"transport",error:i,operation:n,extra:r})},read:function(e){var t=this,n=new k,i=t._params();return t.trigger("start",{params:i,extra:e}).isDefaultPrevented()?n.resolve():(t.cancel(),t._client().read(i.remote,S(t._success,t,n,i.local),S(t._error,t,n,!0,"read"),e)),n.promise()},_ensureTracker:function(){var t=this,e=t.tracker,n=t.data;if(!e){if(!n||!w.array(n))throw new Error("shield.DataSource: cannot modify when no data array is available.");e=t.tracker=new f({data:n,model:t.schema.model,events:{change:function(e){t._createView(t.data),e&&e.afterset||t.trigger(B)},error:function(e){t.trigger(A,{errorType:"tracker",path:e?e.path:"undefined path",value:e?e.value:"undefined value",error:e?e.reason:"undefined error",model:e?e.target:"undefined target model"})}}}),t.data=e.data}},getDataIndex:function(e){return this._indices[e]},add:function(e){return this._ensureTracker(),this.tracker.add(e)},insert:function(e,t){return this._ensureTracker(),this.tracker.insert(e,t)},remove:function(e){return this._ensureTracker(),this.tracker.remove(e)},removeAt:function(e){return this._ensureTracker(),this.tracker.removeAt(e)},edit:function(e){return this._ensureTracker(),this.tracker.edit(e)},insertView:function(e,t){return this.insert(this._indices[e],t)},removeAtView:function(e){return this.removeAt(this._indices[e])},editView:function(e){return this.edit(this._indices[e])},save:function(e,t){var n,i,r,a=this,s=a.tracker,o=s?s.changes:{added:[],edited:[],removed:[]},l=s&&a.trigger("save",{changes:o}),h=new k;if(e=!w.defined(e)||!!e,l&&!l.isDefaultPrevented()){for(n=a.data=s.original,i=s.data,r=n.length=0;r<i.length;r++)n[r]=i[r];a.options.data&&!w.func(a.options.data)&&h.done(S(a._syncLocalData,a)),a._client().modify(o,S(h.resolve,h),S(a._error,a,h,!1,"save"),t),s.destroy(),s=a.tracker=null}else h.resolve(o);return e&&h.then(l=function(){a._createView(a.data),a.trigger(B,{extra:t})},l),h.promise()},_syncLocalData:function(){for(var e=this.schema,t=(e.options.fields,this.data),n=[],i=w.array(e.getReverseDataFirstItem(this.options.data)),r=0;r<t.length;r++)n[r]=i?[]:{},e.reverseFields(t[r],n[r]);e.reverseData(n,this.options.data)},cancel:function(){var e=this,t=e.tracker,n=t&&(t.changes.added.length||t.changes.edited.length||t.changes.removed.length);t&&(e.data=t.original,t.destroy(),t=e.tracker=null,n&&(e._createView(e.data),e.trigger(B)))},destroy:function(){var e,t=this,n=["options","data","total","aggregates","filter","sort","aggregate","group","skip","take","schema","remote","view","cache"];for(t.cancel(),t.cache&&t.cache.clear(),e=0;e<n.length;e++)delete t[n[e]];m.fn.destroy.call(t)}})).create=function(e,t){return e instanceof a?e:w.array(e)?new a(E({data:e},t)):new a(E({},e,t))},(s=g.extend({init:function(e){this.options=e},parse:function(e){var t=this.options.parse;if(w.func(t))return t(e);if(w.string(e))try{e=d.parseJSON(e)}catch(e){}return e},data:function(e){var t=this.options.data;return w.func(t)?t(e):w.string(t)?_(e,t):e},aggregates:function(e){var t=this.options.aggregates;return w.func(t)?t(e):w.string(t)?_(e,t):l},groups:function(e){var t=this.options.groups;return w.func(t)?t(e):w.string(t)?_(e,t):l},reverseData:function(e,t){var n,i=this.options.data;if(w.func(i))i(e,t);else if(w.string(i))P(t,i,e);else if(w.array(t))for(n=t.length=0;n<e.length;n++)t[n]=e[n]},getReverseDataFirstItem:function(e){e=this.data(e);return w.array(e)&&0<e.length?e[0]:l},total:function(e,t){var n=this.options.total;return e=e||[],t=t||[],w.func(n)?n(e):w.string(n)?_(e,n):t.length},fields:function(e){var t=this.options.fields,n=this.model=p.define(t);return t?N(e,function(e){return s.mapFields(e,n.fn.fields)}):e},reverseFields:function(){var e,t,n,i=this.options.fields,r=[].slice.call(arguments),a=r[0],s=r.length<=1,o=s?a:r[1];if(w.defined(i))for(n in i)i.hasOwnProperty(n)&&(e=i[n],t=a[n],w.string(e.path)?P(o,e.path,t):w.func(e.path)?e.path(a,t):o[n]=t,s&&delete o[n]);else if(!s&&w.object(a))for(n in a)a.hasOwnProperty(n)&&(o[n]=a[n])},process:function(e){var t=this,n=t.parse(e),i=t.aggregates(e),e=t.groups(e),r=t.fields(t.data(n));return{data:r,aggregates:i,groups:e,total:t.total(n,r)}}})).mapFields=function(e,t){var n,i,r,a={};for(n in e=e||{},t)t.hasOwnProperty(n)&&(i=t[n],w.string(i.path)?(r=_(e,i.path))===l&&(r=_(e,n)):r=w.func(i.path)?i.path(e):e[n],r===l?i.type&&(r=p.def(i.type,i.def,i.nullable)):r=p.convert(r,i.type),a[n]=r);return a},g=s.extend({parse:function(e){var t=this.options;if(w.func(t.parse))e=t.parse(e);else if(w.string(e))try{e=d.parseXML(e)}catch(e){}return e=e&&9===e.nodeType?this._json(this._root(e)):e},_root:function(e){for(var t=e.childNodes,n=0,i=t.length;n<i;n++)if(1===t[n].nodeType)return t[n];return null},_json:function(e){for(var t,n,i={},r={},a="",s=0,o=e.attributes.length;s<o;s++)i["_"+(t=e.attributes[s]).nodeName]=t.nodeValue;for(s=0,o=e.childNodes.length;s<o;s++)switch(n=(t=e.childNodes[s]).nodeName,t.nodeType){case 1:r[n]?(w.array(i[n])||(i[n]=[i[n]]),i[n].push(this._json(t))):(i[n]=this._json(t),r[n]=!0);break;case 3:a+=t.nodeValue;break;case 4:i._cdata=t.nodeValue}return(a=a.replace(/^\s+(.*)\s+$/gim,"$1"))&&(i._text=a),i}}),o=s.extend({parse:function(e){var t,n=this.options,i=n.parse,r=d(e),a=[],s=[];if(w.func(i))return i(e);if(n.result)return n.result;if(!r[0]||"table"!==r[0].tagName.toLowerCase())return e;r.eq(0).find("thead th").each(function(){s.push(d(this).text())}).end().find("tbody tr").each(function(){t={},d(this).children().each(function(e){t[s[e]]=d(this).text()}),a.push(t)});return n.result=a}}),c=s.extend({parse:function(e){var t=this.options,n=t.parse,i=d(e),r=[];return w.func(n)?n(e):t.result||(i[0]&&"select"===i[0].tagName.toLowerCase()?(i.find("option").each(function(e){var t=d(this);r.push({value:t.attr("value"),text:t.text(),selected:t.is(":selected")})}),t.result=r):e)}}),a.schemas={json:s,xml:g,table:o,select:c},f=m.extend({init:function(e){this.original=e.data,this.data=Array.apply(null,e.data),this.model=e.model,this.changes={added:[],edited:[],removed:[]},m.fn.init.call(this,e)},_model:function(e){var t=this,e=new t.model(e);return e.on(B,S(t.trigger,t,B)),e.on(A,S(t.trigger,t,A)),e.on(H,S(t.trigger,t,B,{afterset:!0})),e},add:function(e){return this.insert(this.data.length,e)},insert:function(e,t){var n=this.data,i=this.changes;if(e<0||e>n.length)throw new Error("shield.DataSource: invalid item index: "+e);return t=this._model(t),i.added.push(t),n.splice(e,0,t.data),this.trigger(B,{operation:"insert",index:e,model:t}),t},edit:function(t){var e,n=this.data,i=this.changes;if(isNaN(t)||t<0||t>=n.length)throw new Error("shield.DataSource: invalid item index: "+t);return(e=M(i.added.concat(i.edited),function(e){return e.data===n[t]})[0])||(e=this._model(n[t]),i.edited.push(e),n[t]=e.data),e},remove:function(t){var e=this.changes,e=M(e.added.concat(e.edited),function(e){return e===t})[0],n=-1;if(t instanceof p?e&&(n=R(e.data,this.data)):n=R(t,this.data),-1<n)return this.removeAt(n)},removeAt:function(t){var n=this.data,e=this.changes,i=M(e.added.concat(e.edited),function(e){return e.data===n[t]})[0];if(t<0||t>n.length)throw new Error("shield.DataSource: invalid item index: "+t);return i?i.destroy():i=new this.model(n[t]),e.removed.push(i),n.splice(t,1),this.trigger(B,{operation:"remove",index:t,model:i}),i},destroy:function(){for(var e=this.changes,t=e.added.concat(e.edited).concat(e.removed),n=0;n<t.length;n++)t[n].destroy();e.added.length=e.edited.length=e.removed.length=0,this.data=this.original=null,m.fn.destroy.call(this)}}),(p=m.extend({init:function(e,t){m.fn.init.call(this,t),this.fields=E(!0,{},this.constructor.prototype.fields),this.data=E(!0,{},e)},trigger:e.ui.Widget.fn.trigger,get:function(e){return _(this.data,e)},set:function(e,t){(t=this.validate(e,t))!==l&&(P(this.data,e,t),this.trigger(H))},validate:function(e,t){var n,i=_(this.fields,e);if(!i)return t;if(n=C(i.validator)===F?i.validator:C(i.type.validate)===F?i.type.validate:(n=i.type.toString().split("(")[0].split(" ")[1].toLowerCase(),p.validators[n])){if((n=n(t))===l)return void this.trigger(A,{errorType:"validation",path:e,value:t,error:"validation error"});t=n}if(null!==t||!1!==i.nullable)return t;this.trigger(A,{errorType:"validation",path:e,value:t,error:"null value not allowed"})}})).define=function(e){return p.extend({fields:p.normalize(E(!0,{},e))})},p.normalize=function(e){var t,n,i;for(t in e=e||{})e.hasOwnProperty(t)&&(n=e[t],(i=C(n))===F||i===D?e[t]={type:n}:"string"===i&&(e[t]={path:n}));return e},p.def=function(e,t,n){return t!==l?C(t)===F?t():t:n?null:e===String?"":e===Number?0:e===Date?new Date:e!==Boolean&&(e===Array?[]:e===Object?{}:(t=C(e))===D?[]:"object"===t?{}:t===F?e():null)},p.convert=function(e,t){var n;return null==e?e:t===String?e.toString():t===Number?(n=parseFloat(e),isNaN(n)?e:n):t===Date?(n=new Date(e),isNaN(n.getTime())?e:n):t===Boolean?w.string(e)?!/^(false|0)$/i.test(e):!!e:e},p.validators={string:function(e){return null==e?null:e.toString()},number:function(e){return null===e?null:isNaN(+e)?l:+e},date:function(e){return null===e?null:e instanceof Date?e:(e=new Date(e),isNaN(e.getTime())?l:e)},boolean:function(e){return null===e?null:null==e?l:!!e},array:function(e){return null===e?null:C(e)===D?e:l},object:function(e){return null===e?null:"object"===C(e)?e:l}},g=a.extend({init:function(e){E(e,{recursive:!0}),a.fn.init.call(this,e)}}),E(e,{map:N,DataSource:a,RecursiveDataSource:g,DataQuery:v,Model:p})}(jQuery,shield),function(M,e,r,k){var i,m,t,l,P,F,n,s=e.ui.Widget,v=(e.Class,e.Constants.KeyCode),b=e.error,d=document,D=Math.abs,B=Math.min,A=Math.max,V=Math.round,j=Math.floor,L=M.extend,p=M.proxy,W=M.each,G=M.isWindow,N=e.is.defined,I=e.is.func,U=e.is.number,O=e.is.object,w=(e.is.null,e.is.string),_=e.is.array,X=e.to.int,q=e.to.number,$=e.to.string,Y=/left|center|right/,K=/top|center|bottom/,J=/[\+\-]\d+(\.[\d]+)?%?/,Z=/^\w+/,Q=/%$/,g="mousedown",ee="mouseup",x="mousemove",te="touchstart",a="touchmove",o="disabled",C="px",R="left",E="right",z="top",S="bottom",T="center",ne="overflow",h="position",u="absolute",ie="relative",re="scroll",ae="horizontal",se="vertical",oe="pointer",le="intersect",he="sui-resizable",ue=he+"-"+o,c="sui-draggable",ce=c+"-"+o,fe=c+"-dragging",f="sui-unselectable",y="sui-droppable",de=y+"-"+o,pe=y+"-over",ge=0;function me(){if(N(i))return i;var e,t=M('<div style="width:50px;position:absolute;overflow:hidden;height:50px;display:block;"><div style="width:auto;height:100px;"></div></div>'),n=t.children()[0];return M(d.body).append(t),e=n.offsetWidth,t.css(ne,re),e===(n=n.offsetWidth)&&(n=t[0].clientWidth),t.remove(),i=e-n}function xe(e){var e=M(e||r),t=G(e[0]),n=!!e[0]&&9===e[0].nodeType;return{element:e,isWindow:t,isDocument:n,offset:!t&&e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:t||n?e.width():e.outerWidth(),height:t||n?e.height():e.outerHeight()}}function ye(e,t,n){return[q(e[0])*(Q.test(e[0])?t/100:1),q(e[1])*(Q.test(e[1])?n/100:1)]}function H(e,t){e=e.css(t);return e&&X(e)||0}function ve(e,t){var n=0;return(N(t)?M(t).find(e):M(e)).each(function(e){n=A(n,H(M(this),"z-index"))}),n}function be(e){return"touch"==e.type.toLowerCase().substring(0,5)?{x:e.originalEvent.touches[0].pageX,y:e.originalEvent.touches[0].pageY}:e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:{x:e.clientX+d.body.scrollLeft-d.body.clientLeft,y:e.clientY+d.body.scrollTop-d.body.clientTop}}(o={}).GetWithinInfo=xe,o.GetMaxZIndex=ve,o.GetCoordinates=be,e.ui.Util=o,(m=function(){if(ge++,t)return t;this.init(),t=this}).prototype={_pos:null,init:function(){M(d).on(x+".suiMouseTracker "+a+".suiMouseTracker",p(this._onMouseMove,this))},_onMouseMove:function(e){this._pos=this.getPosFromEvent(e)},getPosFromEvent:be,getPosition:function(e){return N(e)&&(this._pos=this.getPosFromEvent(e)),this._pos},isInWindow:function(e){var e=this.getPosition(e),t=e.x,e=e.y,n=M(r).scrollTop(),i=M(r).scrollLeft();return i<=t&&t<=i+M(r).width()&&n<=e&&e<=n+M(r).height()},destroy:function(){0<--ge||(M(d).off(x+".suiMouseTracker "+a+".suiMouseTracker"),t=null)}},e.MouseTracker=m,(l={}).Set=function(e,t,a){if(!e||!t||!a)throw"Invalid arguments passed to Position.Set";var n,s,o,l,i={my:a.source,at:a.target,collision:a.overflow,inside:a.inside},h=M(t),r=xe(i.inside),u=(d=(t=r).isWindow||t.isDocument?"":t.element.css("overflow-x"),u=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),d=d===re||"auto"===d&&t.width<t.element[0].scrollWidth,{width:u===re||"auto"===u&&t.height<t.element[0].scrollHeight?me():0,height:d?me():0}),c=(i.collision||"flip").split(" "),f={},d=9===(d=(t=h)[0]).nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:G(d)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:d.preventDefault?{width:0,height:0,offset:{top:d.pageY,left:d.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()};h[0].preventDefault&&(i.at="left top"),s=d.width,o=d.height,t=L({},l=d.offset),W(["my","at"],function(){var e,t,n=(i[this]||"").split(" ");(n=1===n.length?Y.test(n[0])?n.concat([T]):K.test(n[0])?[T].concat(n):[T,T]:n)[0]=Y.test(n[0])?n[0]:T,n[1]=K.test(n[1])?n[1]:T,e=J.exec(n[0]),t=J.exec(n[1]),f[this]=[e?e[0]:0,t?t[0]:0],i[this]=[Z.exec(n[0])[0],Z.exec(n[1])[0]]}),1===c.length&&(c[1]=c[0]),i.at[0]===E?t.left+=s:i.at[0]===T&&(t.left+=s/2),i.at[1]===S?t.top+=o:i.at[1]===T&&(t.top+=o/2),n=ye(f.at,s,o),t.left+=n[0],t.top+=n[1];var p,g,m=M(e),x=m.outerWidth(),y=m.outerHeight(),d=H(m,"marginLeft"),e=H(m,"marginTop"),v=x+d+H(m,"marginRight")+u.width,b=y+e+H(m,"marginBottom")+u.height,w=L({},t),_=ye(f.my,m.outerWidth(),m.outerHeight());i.my[0]===E?w.left-=x:i.my[0]===T&&(w.left-=x/2),i.my[1]===S?w.top-=y:i.my[1]===T&&(w.top-=y/2),w.left+=_[0],w.top+=_[1],w.left=V(w.left),w.top=V(w.top),p={marginLeft:d,marginTop:e},W([R,z],function(e,t){P[c[e]]&&P[c[e]][t](w,{targetWidth:s,targetHeight:o,elemWidth:x,elemHeight:y,collisionPosition:p,collisionWidth:v,collisionHeight:b,offset:[n[0]+_[0],n[1]+_[1]],my:i.my,at:i.at,within:r,elem:m})}),I(a.callback)&&(g=function(){var e=l.left-w.left,t=e+s-x,n=l.top-w.top,i=n+o-y,r={target:{element:h,left:l.left,top:l.top,width:s,height:o},element:{element:m,left:w.left,top:w.top,width:x,height:y},horizontal:t<0?R:0<e?E:T,vertical:i<0?z:0<n?S:"middle"};s<=x&&D(e+t)<=s&&(r.horizontal=T),o<=y&&D(n+i)<=o&&(r.vertical="middle"),A(D(e),D(t))>A(D(n),D(i))?r.important=ae:r.important=se,a.callback(r)}),m.offset(w),g&&g()},P={fit:{left:function(e,t){var n,i=t.within,r=i.isWindow?i.scrollLeft:i.offset.left,i=i.width,a=e.left-t.collisionPosition.marginLeft,s=r-a,o=a+t.collisionWidth-i-r;t.collisionWidth>i?0<s&&o<=0?(n=e.left+s+t.collisionWidth-i-r,e.left+=s-n):e.left=!(0<o&&s<=0)&&o<s?r+i-t.collisionWidth:r:0<s?e.left+=s:0<o?e.left-=o:e.left=A(e.left-a,e.left)},top:function(e,t){var n,i=t.within,i=i.isWindow?i.scrollTop:i.offset.top,r=t.within.height,a=e.top-t.collisionPosition.marginTop,s=i-a,o=a+t.collisionHeight-r-i;t.collisionHeight>r?0<s&&o<=0?(n=e.top+s+t.collisionHeight-r-i,e.top+=s-n):e.top=!(0<o&&s<=0)&&o<s?i+r-t.collisionHeight:i:0<s?e.top+=s:0<o?e.top-=o:e.top=A(e.top-a,e.top)}},flip:{left:function(e,t){var n=t.within,i=n.offset.left+n.scrollLeft,r=n.width,n=n.isWindow?n.scrollLeft:n.offset.left,a=e.left-t.collisionPosition.marginLeft,s=a-n,a=a+t.collisionWidth-r-n,o=t.my[0]===R?-t.elemWidth:t.my[0]===E?t.elemWidth:0,l=t.at[0]===R?t.targetWidth:t.at[0]===E?-t.targetWidth:0,h=-2*t.offset[0];s<0?((r=e.left+o+l+h+t.collisionWidth-r-i)<0||r<D(s))&&(e.left+=o+l+h):0<a&&(0<(i=e.left-t.collisionPosition.marginLeft+o+l+h-n)||D(i)<a)&&(e.left+=o+l+h)},top:function(e,t){var n=t.within,i=n.offset.top+n.scrollTop,r=n.height,n=n.isWindow?n.scrollTop:n.offset.top,a=e.top-t.collisionPosition.marginTop,s=a-n,a=a+t.collisionHeight-r-n,o=t.my[1]===z?-t.elemHeight:t.my[1]===S?t.elemHeight:0,l=t.at[1]===z?t.targetHeight:t.at[1]===S?-t.targetHeight:0,h=-2*t.offset[1];s<0?(r=e.top+o+l+h+t.collisionHeight-r-i,e.top+o+l+h>s&&(r<0||r<D(s))&&(e.top+=o+l+h)):0<a&&(i=e.top-t.collisionPosition.marginTop+o+l+h-n,e.top+o+l+h>a&&(0<i||D(i)<a)&&(e.top+=o+l+h))}},flipfit:{left:function(){P.flip.left.apply(this,arguments),P.fit.left.apply(this,arguments)},top:function(){P.flip.top.apply(this,arguments),P.fit.top.apply(this,arguments)}}},e.ui.Position=l,o={enabled:!0,cls:k,iframeFix:!1,resizeCls:k,delta:1,handles:["e","w","n","s","se","sw","ne","nw"],handleWidth:8,handleZIndex:105,minHeight:16,minWidth:16,maxHeight:k,maxWidth:k,events:{}},(n=s.extend({init:function(){s.fn.init.apply(this,arguments),N(this.initialOptions.handles)&&(this.options.handles=this.initialOptions.handles);var e=this,t=M(e.element),n=e.options,i=n.cls;e._eventNS=".shieldResizable"+e.getInstanceId(),e.mouseTracker=new m,t.addClass(he+(i?" "+i:"")),e._initHandles(),e.enabled(n.enabled)},_initHandles:function(){var e,t,n,i=this,r=M(i.element),a=(r.width(),r.height()),s=i.options,o=s.handles,l=s.handleWidth,h=l+C,u=l+2+C,c="-"+(l-2)+C,f=s.handleZIndex;for(i.handles=[],n=0;n<o.length;n++){switch(t={},e=$(o[n]).toLowerCase()){case"e":t={width:h,height:a+C,top:0,right:c};break;case"w":t={width:h,height:a+C,top:0,left:c};break;case"n":t={width:"100%",height:h,top:c};break;case"s":t={width:"100%",height:h,bottom:c};break;case"se":t={width:u,height:u,bottom:c,right:c};break;case"sw":t={width:u,height:u,bottom:c,left:c};break;case"ne":t={width:u,height:u,top:c,right:c};break;case"nw":t={width:u,height:u,top:c,left:c}}t.zIndex=f,i.handles[n]={type:e},i.handles[n][g]=p(i._handleMouseDown,i,n),i.handles[n].element=M('<div class="sui-resizable-handle sui-resizable-dir-'+e+'"></div>').appendTo(r).css(t).on(g,i.handles[n][g])}M(d).on(ee+i._eventNS,p(i._handleMouseUp,i)).on(x+i._eventNS,p(i._handleMouseMove,i))},_destroyHandles:function(){var e,t=this,n=t.handles;for(M(d).off(t._eventNS),e=0;e<n.length;e++)M(t.handles[e].element).off(g,t.handles[e][g]).remove();t.handles=[]},_fixIframes:function(){var e=this.options.iframeFix;e&&(e=!0===e?"iframe":e,this._fixedFrames=M(d.body).find(e).map(function(){var e=M(this);return M("<div/>").css(h,u).appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]}))},_unfixIframes:function(){this._fixedFrames&&(M(this._fixedFrames).remove(),delete this._fixedFrames)},_handleMouseDown:function(e,t){var n=this;n._enabled&&!n.resizing&&(n.resizing=!0,n.resizingHandle=e,n.oldPos=n.mouseTracker.getPosition(t),n.startSent=!1,M(n.element).addClass(f),n._fixIframes())},_handleMouseMove:function(e){var t,n,i,r,a,s,o,l,h,u=this,c=M(u.element),f=u.options,d=f.delta,p=f.minWidth,g=f.maxWidth,m=f.minHeight,x=f.maxHeight,f=f.resizeCls,y=u.resizingHandle,v=u.handles,b=u.mouseTracker,w=u.oldPos;if(b.isInWindow(e)&&u.resizing&&N(y)&&(i=(b=b.getPosition(e)).x-w.x,r=b.y-w.y,n=v[y].type,D(i)>=d||D(r)>=d)){switch(/^(se|sw|ne|nw)$/i.test(n)||(/^(e|w)$/i.test(n)?r=0:i=0),a=i=D(i)<d?0:i,s=r=D(r)<d?0:r,l=o=0,n){case"w":o=-(a=-i);break;case"n":l=-(s=-r);break;case"nw":o=-(a=-i),l=-(s=-r);break;case"sw":o=-(a=-i);break;case"ne":l=-(s=-r)}var e=c.width(),_=c.height(),b=H(c,z),w=H(c,R);if(0<a?(N(g)&&g<e+a&&(a=g-e,0!==o&&(o=-a)),w+o<0&&(o=-(a-=w-o))):a<0&&N(p)&&e+a<p&&(a=p-e,0!==o&&(o=-a)),0<s?(N(x)&&x<_+s&&(s=x-_,0!==l&&(l=-s)),b+l<0&&(l=-(s-=b-l))):s<0&&N(m)&&_+s<m&&(s=m-_,0!==l&&(l=-s)),0!==a||0!==s)if(u.startSent||(u.startSent=!0,u.trigger("start"),f&&c.addClass(f)),!u.trigger("resize",{deltaX:a,deltaY:s}).isDefaultPrevented()){if(c.width(e+a).height(_+s),0===o&&0===l||c.css({top:b+l+C,left:w+o+C}),u.oldPos.x=u.oldPos.x+i,u.oldPos.y=u.oldPos.y+r,0!==r)for(h=0;h<v.length;h++)t=v[h],/^(e|w)$/i.test(t.type)&&M(t.element).height(_+s);u.trigger("resized")}}},_handleMouseUp:function(e){var t=this,n=!!t.startSent,i=t.options.resizeCls;t._unfixIframes(),t.resizing&&(t.resizing=!1,t.resizingHandle=k,t.oldPos=k,t.startSent=!1,n&&t.trigger("stop"),M(t.element).removeClass(f+(i?" "+i:"")))},resize:function(e,t){var n=this.options;e=A(B(e,n.maxWidth),n.minWidth),t=A(B(t,n.maxHeight),n.minHeight),M(this.element).width(e).height(t)},enabled:function(){var e=M(this.element),t=[].slice.call(arguments);if(!(0<t.length))return this._enabled;(t=!!t[0])?e.removeClass(ue):e.addClass(ue),this._enabled=t},destroy:function(){var e=this,t=e.options.cls;e.mouseTracker.destroy(),e.mouseTracker=null,M(e.element).removeClass(he+(t?" "+t:"")),e._destroyHandles(),s.fn.destroy.call(e)}})).defaults=o,e.ui.plugin("Resizable",n),F={droppables:{default:[]},Register:function(e){var t=e.options.scope;F.droppables[t]=F.droppables[t]||[],F.droppables[t].push(e)},UnRegister:function(e){for(var t=e.options.scope,n=F.droppables[t],i=0;i<n.length;i++)n[i]===e&&n.splice(i,1)},PrepareOffsets:function(e,t){for(var n,i,r=F.droppables[e.options.scope]||[],a=M(e.helper||e.element),s=0;s<r.length;s++)n=r[s].enabled(),i=r[s].visible(),r[s].ddIsEnabled=n,r[s].ddIsVisible=i,!n||!i||e&&!r[s].accepts(e.element)||e&&e.element.get(0)===r[s].element.get(0)||(r[s].ddOffset=r[s].element.offset(),r[s].proportions({width:r[s].element[0].offsetWidth,height:r[s].element[0].offsetHeight}));e.proportions({width:a[0].offsetWidth,height:a[0].offsetHeight})},DragStart:function(e,t){F.PrepareOffsets(e,t)},Drag:function(e,t){for(var n=F.droppables[e.options.scope]||[],i=n.length,r=0;r<i;r++)!n[r].ddIsEnabled||!n[r].ddIsVisible||e&&!n[r].accepts(e.element)||e&&e.element.get(0)===n[r].element.get(0)||(F.Intersects(e,n[r],t)?n[r].ddIsOver||(n[r].ddIsOver=!0,n[r].over(e,t)):n[r].ddIsOver&&(n[r].ddIsOver=!1,n[r].out(e,t)))},Drop:function(e,t){for(var n,i,r,a=F.droppables[e.options.scope]||[],s=a.length,o=0;o<s;o++)!a[o].ddIsEnabled||!a[o].ddIsVisible||e&&!a[o].accepts(e.element)||e&&e.element.get(0)===a[o].element.get(0)||(a[o].stop(),r=F.Intersects(e,a[o],t),a[o].ddIsOver=!1,r&&((r=a[o].drop(e,t)).isDefaultPrevented()&&(n=!0),r.skipAnimation&&(i=!0)));return{cancelled:n,skipAnimation:i}},Intersects:function(e,t,n){var i,r,a,s,o,l,h,u=t.options.tolerance,c=O(u)?u.x:u,u=O(u)?u.y:u,f=t.proportions(),t=t.ddOffset,d=f.width,f=f.height,p=t.left,t=t.top,g=c==oe?(h=(g=new m).getPosition(n),g.destroy(),p<=h.x&&p+d>=h.x):(r=(i=e.proportions()).width,a=i.height,o=(s=M(e.helper||e.element).offset()).left,l=s.top,"fit"==c?F._linesOverlap(o,o+r,p,p+d,r):c==le?F._linesOverlap(o,o+r,p,p+d,r/2):F._linesOverlap(o,o+r,p,p+d,0));return!!g&&(p=u==oe?(h||(h=(c=new m).getPosition(n),c.destroy()),t<=h.y&&t+f>=h.y):(i||(r=(i=e.proportions()).width,a=i.height,o=(s=M(e.helper||e.element).offset()).left,l=s.top),"fit"==u?F._linesOverlap(l,l+a,t,t+f,a):u==le?F._linesOverlap(l,l+a,t,t+f,a/2):F._linesOverlap(l,l+a,t,t+f,0)),g&&p)},_linesOverlap:function(e,t,n,i,r){return N(r)||(r=0),e<n&&t<i?r<t-n:!(n<e&&i<t)||r<i-e}},e.ui.DDManager=F,o={enabled:!0,iframeFix:!1,cls:k,dragCls:k,scope:"default",handle:k,direction:k,min:k,max:k,step:k,allowedPositions:k,stack:!0,helper:k,appendTo:"parent",animation:{enabled:!0,revertDuration:200},events:{}},(n=s.extend({init:function(){s.fn.init.apply(this,arguments);var e=this,t=M(e.element),n=e.options,i=n.cls;e._destroyed&&(e._destroyed=!1),e._eventNS=".shieldDraggable"+e.getInstanceId(),e.mouseTracker=new m,t.addClass(c+(i?" "+i:"")),(i=t.css(h))!==ie&&i!==u&&(e._origPosStyle=i,t.css(h,ie)),e.enabled(n.enabled),e.startSent=!1},proportions:function(){var e=this;if(!(0<arguments.length))return e._proportions||(e._proportions={width:e.element[0].offsetWidth,height:e.element[0].offsetHeight});e._proportions=arguments[0]},_fixIframes:function(){var e=this.options.iframeFix;e&&(e=!0===e?"iframe":e,this._fixedFrames=M(d.body).find(e).map(function(){var e=M(this);return M("<div/>").css(h,u).appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]}))},_unfixIframes:function(){this._fixedFrames&&(M(this._fixedFrames).remove(),delete this._fixedFrames)},_handleMouseDown:function(e){var t=this,n=t._eventNS;!t._enabled||t._destroyed||t._dragging||(M(d.body).addClass(f),t._dragging=!0,t.startSent=!1,t.helper=t._isCustomHelper=null,t.stepPosition=t.mousePos=t.mouseTracker.getPosition(e),M(d).on(x+n+" "+a+n,p(t._handleMouseMove,t)).on(ee+n+" touchend"+n,p(t._handleMouseUp,t)).on("keydown"+n,p(t._handleKeyDown,t)),t._fixIframes())},_initHelper:function(e){var t,n=this,i=n.element,r=n.options,a=r.helper,s=r.appendTo,o=r.cls,r=r.dragCls;n._helperInitialized||(a&&"original"!==a?((t=I(a)?a.call(n,{position:n.oriPosition,event:e}):"clone"==a?i.clone():M(a)).parents("body").length||("parent"===s?i.after(t):s&&"body"!==s?t.appendTo(M(s)):t.appendTo(d.body)),/(fixed|absolute)/i.test(t.css(h))||t.css(h,u),l.Set(t,i,{source:"left top",target:"left top",overflow:"none"}),n._isCustomHelper=!0):(t=i,n._isCustomHelper=!1),(n.helper=t).addClass(f+" "+c+(o?" "+o:"")+" "+fe+(r?" "+r:"")),n.oriPosition={left:H(t,R),top:H(t,z)},n._helperInitialized=!0)},_handleMouseMove:function(e){var t,n,i,r,a,s,o,l,h,u,c=this,f=c.options,d=f.step,p=f.direction,g=f.allowedPositions,m=g!==k&&0<g.length,x=f.min,f=f.max,y=c.mouseTracker,v=y.getPosition(e);if(y.isInWindow(e)&&c._dragging){if(c._initHelper(e),h=(y=M(c.helper)).width(),u=y.height(),i=H(y,z),r=H(y,R),m){for(var b,w=k,_=k,P=k,C=k,E=r+(v.x-c.stepPosition.x),S=i+(v.y-c.stepPosition.y),T=0;T<g.length;T++)(b=g[T]).x!==k&&(P===k||P>D(E-b.x))&&(P=D(E-b.x),w=T),b.y!==k&&(C===k||C>D(S-b.y))&&(C=D(S-b.y),_=T);a=r,s=i,w!==k&&(a=g[w].x,c.stepPosition.x+=g[w].x-r),_!==k&&(s=g[_].y,c.stepPosition.y+=g[_].y-i)}else{if(o=p==se?0:v.x-c.mousePos.x,l=p==ae?0:v.y-c.mousePos.y,N(d)){if(m=I(d)?d.call(this,{deltaX:o,deltaY:l,element:y,domEvent:e,helperLeft:H(y,R),helperTop:H(y,z),mouse:v}):d,U(m)?t=n=m:O(m)&&(t=m.x,n=m.y),N(t)&&D(o)<t&&N(n)&&D(l)<n)return;N(t)&&1<t&&o%t!=0&&(o=(0<=o?1:-1)*j(D(o)/t)*t),N(n)&&1<n&&l%n!=0&&(l=(0<=l?1:-1)*j(D(l)/n)*n)}a=r+o,s=A(0,i+l)}p==ae&&(x!==k&&(a=A(x,a))===x&&(o=0),f!==k&&(a=B(f-h,a))===f-h&&(o=0)),p==se&&(x&&(s=A(x,s))===x&&(l=0),f&&(s=B(f-u,s))===f-u&&(l=0)),y.css({left:a,top:s}),c.mousePos=v,c.startSent||(c.startSent=!0,c.trigger("start",{element:y,domEvent:e}),c._adjustZIndex(),F.DragStart(c,e)),c.trigger("drag",{deltaX:o,deltaY:l,element:y,domEvent:e}),F.Drag(c,e)}},_handleMouseUp:function(e){var t,n,i=this,r=i.element,a=i.helper,s=i.options.animation;i._unfixIframes(),M(d.body).removeClass(f),i._dragging&&(i.startSent?(t=(n=F.Drop(i,e)).cancelled,n=n.skipAnimation,n=(e=i.trigger("stop",{left:H(a,R),top:H(a,z),element:a,domEvent:e,cancelled:t,skipAnimation:n})).skipAnimation,!0===e.cancelled||e.isDefaultPrevented()?M(a).animate({left:i.oriPosition.left,top:i.oriPosition.top},!n&&s&&s.enabled?s.revertDuration:0,p(i._endDrag,i)):(i._isCustomHelper&&(l.Set(r,a,{source:"left top",target:"left top",overflow:"none"}),i._adjustZIndex(r)),i._endDrag())):i._endDrag())},_adjustZIndex:function(e){var t=this.options.stack;!1!==t&&(N(e)||(e=this.helper),M(e).css("z-index",ve(!0===t?"."+c:t)+1))},_handleKeyDown:function(e){var t=this;e.keyCode===v.ESC&&t._dragging&&(t.helper.css({left:t.oriPosition.left+C,top:t.oriPosition.top+C}),t.trigger("cancel"),t._unfixIframes(),t._endDrag())},_endDrag:function(){var e=this,t=e.options.dragCls;e._dragging=!1,e._isCustomHelper?M(e.helper).remove():M(e.helper).removeClass(f+" "+fe+(t?" "+t:"")),M(d).off(e._eventNS),e.mousePos=e.oriPosition=e.helper=e._isCustomHelper=e._helperInitialized=null},enabled:function(){var e=this,t=M(e.element),n=e.options,n=n.handle?M(n.handle):t,i=[].slice.call(arguments);if(!(0<i.length))return e._enabled;(i=!!i[0])?(t.removeClass(ce),e._mouseDownProxy||(e._mouseDownProxy=p(e._handleMouseDown,e),n.on(g+" "+te,e._mouseDownProxy))):(t.addClass(ce),e._mouseDownProxy&&(n.off(g+" "+te,e._mouseDownProxy),e._mouseDownProxy=null)),e._enabled=i},destroy:function(){var e=this,t=e.options.cls;e.enabled(!1),e.mouseTracker&&(e.mouseTracker.destroy(),e.mouseTracker=null),M(e.element).removeClass(c+" "+ce+(t?" "+t:"")),e._origPosStyle&&(M(e.element).css(h,e._origPosStyle),e._origPosStyle=null),e._destroyed=!0,s.fn.destroy.call(e)}})).defaults=o,e.ui.plugin("Draggable",n),o={enabled:!0,accepts:"*",cls:k,hoverCls:k,tolerance:"intersect",scope:"default",events:{}},(n=s.extend({init:function(){s.fn.init.apply(this,arguments);var e=this,t=M(e.element),n=e.options,i=n.dieOnError,r=n.accepts,a=n.cls;w(r)||_(r)||r instanceof M||I(r)?(e._eventNS=".shieldDroppable"+e.getInstanceId(),t.addClass(y+(a?" "+a:"")),F.Register(e),e.enabled(n.enabled)):b("shieldDroppable: The accepts option must be a string, array, function or jQuery object.",i)},accepts:function(e){var t=this.options.accepts;return I(t)?t.call(this,e):M(e).is(t)},proportions:function(){var e=this;if(!(0<arguments.length))return e._proportions||(e._proportions={width:e.element[0].offsetWidth,height:e.element[0].offsetHeight});e._proportions=arguments[0]},over:function(e,t){var n=this.options.hoverCls;this.trigger("over",{draggable:e.element,droppable:this.element,domEvent:t}).isDefaultPrevented()||M(this.element).addClass(pe+(n?" "+n:""))},out:function(e,t){var n=this.options.hoverCls;this.trigger("out",{draggable:e.element,droppable:this.element,domEvent:t}),M(this.element).removeClass(pe+(n?" "+n:""))},stop:function(){var e=this.options.hoverCls;M(this.element).removeClass(pe+(e?" "+e:""))},drop:function(e,t){return this.trigger("drop",{draggable:e.element,droppable:this.element,cancelled:t.cancelled,skipAnimation:t.skipAnimation,domEvent:t})},enabled:function(){var e=[].slice.call(arguments);if(!(0<e.length))return this._enabled;(e=!!e[0])?M(this.element).removeClass(de):M(this.element).addClass(de),this._enabled=e},destroy:function(){var e=this,t=e.options.cls;F.UnRegister(e),M(e.element).removeClass(y+de+f+(t?" "+t:"")),e._enabled=e._proportions=k,s.fn.destroy.call(e)}})).defaults=o,e.ui.plugin("Droppable",n)}(jQuery,shield,this),function(o,e,L,W){function G(e){return o("<div/>").text(e).html().replace('"',"&quot;").replace(/(?:[\x00-\x08]|[\x0B-\x0C]|[\x0E-\x1F])/g,"")}function U(e){return o("<div/>").html(e).text()}function ie(e){return Z(e)||(M(e)&&(e=e.replace(/\s+/g,"")),e=new Date(e)),(25569+e.getTime()/864e5).toString()}function m(e){return Q(e)?Z(e)?e:new Date(M(e)?e.replace(/\s+/g,""):e):new Date}function X(e){return m(e).toISOString().replace(/\.\d+/,"")}function E(e){return Q(e)&&M(e)&&0<e.length?e.charAt(0).toUpperCase()+e.substr(1):e}function S(e){return e?1:0}function re(e){return("FF"+e).replace("#","").toUpperCase()}function ae(e,t){return function(e){for(var t,n=F(e),i="";0<n;)t=(n-1)%26,i=String.fromCharCode(65+t)+i,n=F((n-t)/26);return i}(t)+e}function T(e,t){return'<?xml version="1.0"'+(e?' encoding="UTF-8"':"")+(t?' standalone="yes"':"")+"?>\n"}function q(){return T(1,1)}var l,n,r,$,u,h,c=e.exp=e.exp||{},t=e.Class,C=(e.DataSource,e.support.browser),x=e.iid,_=document,Y=o.extend,K=o.map,w=o.each,i=e.is,M=i.string,k=i.array,J=i.number,se=i.boolean,Z=i.date,Q=i.defined,ee=i.null,D=i.func,B=i.object,F=e.to.int,oe=e.to.key,te=e.error,ne=e.keys,A=(e.get,e.Constants.XHTML_NS),N="application/octet-stream",P="download",I="Untitled",y="creator",s="helvetica",f="times",d="courier",p="normal",g="bold",a="italic",v="bolditalic",b=19.049976/25.4;u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Q((i=L).btoa)||(i.btoa=function(e){var t,n,i,r,a=0,s=0,o="",l=[];if(!e)return e;for(;t=(r=e.charCodeAt(a++)<<16|e.charCodeAt(a++)<<8|e.charCodeAt(a++))>>12&63,n=r>>6&63,i=63&r,l[s++]=u.charAt(r>>18&63)+u.charAt(t)+u.charAt(n)+u.charAt(i),a<e.length;);var o=l.join(""),h=e.length%3;return(h?o.slice(0,h-3):o)+"===".slice(h||3)}),Q(i.atob)||(i.atob=function(e){var t,n,i,r,a,s=0,o=0,l=[];if(!e)return e;for(e+="";t=(a=u.indexOf(e.charAt(s++))<<18|u.indexOf(e.charAt(s++))<<12|(i=u.indexOf(e.charAt(s++)))<<6|(r=u.indexOf(e.charAt(s++))))>>16&255,n=a>>8&255,a=255&a,l[o++]=64==i?String.fromCharCode(t):64==r?String.fromCharCode(t,n):String.fromCharCode(t,n,a),s<e.length;);return l.join("")}),function(){if(L.URL=L.URL||L.webkitURL,L.Blob&&L.URL)try{new L.Blob;return c.Blob=L.Blob}catch(e){}var s=L.BlobBuilder||L.WebKitBlobBuilder||L.MozBlobBuilder||function(){function o(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]}function e(){this.data=[]}function l(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n}function h(e){this.code=this[this.name=e]}var t=e.prototype,n=l.prototype,u=L.FileReaderSync,i="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),r=i.length,a=L.URL||L.webkitURL||L,s=a.createObjectURL,c=a.revokeObjectURL,f=a,d=L.btoa,p=L.atob,g=L.ArrayBuffer,m=L.Uint8Array,x=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(l.fake=n.fake=!0;r--;)h.prototype[i[r]]=r+1;return(f=a.createObjectURL?f:L.URL=function(e){var t=_.createElementNS(A,"a");return t.href=e,"origin"in t||("data:"===t.protocol.toLowerCase()?t.origin=null:(e=e.match(x),t.origin=e&&e[1])),t}).createObjectURL=function(e){var t=e.type;return ee(t)&&(t=N),e instanceof l?(t="data:"+t,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):d?t+";base64,"+d(e.data):t+","+encodeURIComponent(e.data)):s?s.call(a,e):void 0},f.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&c&&c.call(a,e)},t.append=function(e){var t=this.data;if(Q(m)&&(e instanceof g||e instanceof m)){for(var n="",i=new m(e),r=i.length,a=0;a<r;a++)n+=String.fromCharCode(i[a]);t.push(n)}else if("Blob"===o(e)||"File"===o(e)){if(!u)throw new h("NOT_READABLE_ERR");var s=new u;t.push(s.readAsBinaryString(e))}else e instanceof l?"base64"===e.encoding&&p?t.push(p(e.data)):"URI"===e.encoding?t.push(decodeURIComponent(e.data)):"raw"===e.encoding&&t.push(e.data):(e+="",t.push(L.unescape(encodeURIComponent(e))))},t.getBlob=function(e){return arguments.length||(e=null),new l(this.data.join(""),e,"raw")},t.toString=function(){return"[object BlobBuilder]"},n.slice=function(e,t,n){var i=arguments.length;return i<3&&(n=null),new l(this.data.slice(e,1<i?t:this.data.length),n,this.encoding)},n.toString=function(){return"[object Blob]"},n.close=function(){this.size=0,delete this.data},e}(),e=(c.Blob=function(e,t){var n,i,t=t&&t.type||"",r=new s,a=L.Uint8Array;if(e)for(n=0,i=e.length;n<i;n++)Q(a)&&a&&e[n]instanceof a?r.append(e[n].buffer):r.append(e[n]);return!(t=r.getBlob(t)).slice&&t.webkitSlice&&(t.slice=t.webkitSlice),t},Object.getPrototypeOf||function(e){return e.__proto__});c.Blob.prototype=e(new c.Blob)}(),h=L.saveAs||function(){if(C.ie&&C.version<10)return W;function f(e){function t(){M(e)?g().revokeObjectURL(e):e.remove()}L.chrome?t():setTimeout(t,n)}function d(e,t,n){for(var i,r=(t=[].concat(t)).length;r--;)if(i=e["on"+t[r]],D(i))try{i.call(e,n||e)}catch(e){a(e)}}function p(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function i(i,n,e){function r(){var e;!h&&s||(s=g().createObjectURL(i)),o?o.location.href=s:(e=L.open(s,"_blank"),Q(e)||"undefined"==typeof safari||(L.location.href=s)),l.readyState=l.DONE,u(),f(s)}function a(e){return function(){if(l.readyState!==l.DONE)return e.apply(this,arguments)}}e||(i=p(i));var s,o,t,l=this,e=i.type,h=!1,u=function(){d(l,"writestart progress write writeend".split(" "))},c={create:!0,exclusive:!1};if(l.readyState=l.INIT,n=n||I,x)return s=g().createObjectURL(i),m.href=s,m.download=n,void setTimeout(function(){var e,t;e=m,t=new MouseEvent("click"),e.dispatchEvent(t),u(),f(s),l.readyState=l.DONE});L.chrome&&e&&e!==b&&(t=i.slice||i.webkitSlice,i=t.call(i,0,i.size,b),h=!0),y&&n!==P&&(n+="."+P),e!==b&&!y||(o=L),v?(w+=i.size,v(L.TEMPORARY,w,a(function(e){e.root.getDirectory("saved",c,a(function(e){function t(){e.getFile(n,c,a(function(n){n.createWriter(a(function(t){t.onwriteend=function(e){o.location.href=n.toURL(),l.readyState=l.DONE,d(l,"writeend",e),f(n)},t.onerror=function(){var e=t.error;e.code!==e.ABORT_ERR&&r()},"writestart progress write abort".split(" ").forEach(function(e){t["on"+e]=l["on"+e]}),t.write(i),l.abort=function(){t.abort(),l.readyState=l.DONE},l.readyState=l.WRITING}),r)}),r)}e.getFile(n,{create:!1},a(function(e){e.remove(),t()}),a(function(e){(e.code===e.NOT_FOUND_ERR?t:r)()}))}),r)}),r)):r()}var g=function(){return L.URL||L.webkitURL||L},m=_.createElementNS(A,"a"),x=P in m,y=L.webkitRequestFileSystem,v=L.requestFileSystem||y||L.mozRequestFileSystem,a=function(e){(L.setImmediate||L.setTimeout)(function(){throw e},0)},b=N,w=0,n=500,e=i.prototype;return Q(navigator)&&navigator.msSaveOrOpenBlob?function(e,t,n){return n||(e=p(e)),navigator.msSaveOrOpenBlob(e,t||I)}:(e.abort=function(){this.readyState=this.DONE,d(this,"abort")},e.readyState=e.INIT=0,e.WRITING=1,e.DONE=2,e.error=e.onwritestart=e.onprogress=e.onwrite=e.onabort=e.onerror=e.onwriteend=null,function(e,t,n){return new i(e,t,n)})}(),c.saveAs=function(e){var t=e.content,n=e.contentType,i=e.name,r=e.noAutoBom,a=e.proxy,s="suidlifrm"+x();Q(h)&&!e.forceProxy?h(new c.Blob([t],{type:n}),i,r):a?(o(l).remove(),l=o('<div style="display:none;"><iframe name="'+s+'"></iframe></div>').appendTo(_.body),o('<form action="'+a+'" target="'+s+'" method="POST"><input type="hidden" name="fileName" value="'+i+'"/><input type="hidden" name="contentType" value="'+n+'"/><input type="hidden" name="base64content" value="'+L.btoa(t)+'"/></form>').appendTo(l).submit()):te("shield.export.saveAs: No proxy url set for older browser support",e.dieOnError)},c.saveAsNative=Q(h),n=t.extend({init:function(e){this.options=Y(!0,{},e)},getExt:null,getContentType:null,getContent:null,saveAs:function(e){var t,n,i,r=e.fileName,a=!Q(e.forceExt)||!!e.forceExt,s=this.getExt(),o=!c.saveAsNative||e.forceProxy?{type:"string"}:{},o=this.getContent(o);Q(o)?(r=r||I,n=s,(t=r+="")&&n&&0<=(i=t.indexOf(n))&&i===t.length-n.length||!a||(r+=s),c.saveAs({content:o,contentType:this.getContentType(),name:r,proxy:e.proxy,forceProxy:e.forceProxy,noAutoBom:e.noAutoBom,dieOnError:e.dieOnError})):te("shield.export.ExportBase.saveAs: Error generating content",this.options.dieOnError)},destroy:function(){}}),$=n.extend({getExt:function(){return".xml"},getContentType:function(){return"text/xml;charset=utf-8"},getContent:function(e){for(var t=this.options,n=X(t.created||new Date),i=(t.author,t.worksheets||[]),r=20,a=[],s=[],t=U("&#x53;&#x68;&#x69;&#x65;&#x6C;&#x64;&#x20;&#x55;&#x49;&#x20;&#x46;&#x72;&#x61;&#x6D;&#x65;&#x77;&#x6F;&#x72;&#x6B;"),n=T()+'<?mso-application progid="Excel.Sheet"?><Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40"><DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"><Created>'+n+"</Created>"+(t?"<Author>"+t+"</Author>":"")+'</DocumentProperties><ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><ProtectStructure>False</ProtectStructure><ProtectWindows>False</ProtectWindows></ExcelWorkbook>',o=0;o<i.length;o++){for(var l,h,u,c,f,d,p,g,m,x,y=i[o],v=y.name,b=y.columns||[],w=[],_=y.rows||[],P=[],C=0;C<b.length;C++)u=b[C],w.push("<Column"+(Q(u.autoWidth)?' ss:AutoFitWidth="'+S(u.autoWidth)+'"':"")+(Q(u.width)?' ss:Width="'+u.width+'"':"")+(Q(u.index)?' ss:Index="'+u.index+'"':"")+"/>");for(C=0;C<_.length;C++){for(l=(c=_[C]).cells||[],f="<Row"+(Q(c.height)?' ss:Height="'+c.height+'"':"")+(Q(c.index)?' ss:Index="'+c.index+'"':"")+">",h=0;h<l.length;h++)p=(d=l[h]).type,m=d.value,x=d.style,g=null,"DateTime"==(p=Q(p)&&!ee(p)?p===Date?"DateTime":p===Number?"Number":p===Boolean?"Boolean":"String":Z(m)?"DateTime":J(m)?"Number":se(m)?"Boolean":"String")&&(m=X(m)),B(x)&&(g="s"+r++,a.push('<Style ss:ID="'+g+'"><Alignment'+(x.textAlign?' ss:Horizontal="'+E(x.textAlign)+'"':"")+(x.verticalAlign?' ss:Vertical="'+E(x.verticalAlign)+'"':"")+(Q(x.wrap)?' ss:WrapText="'+S(x.wrap)+'"':"")+"/>"+(Q(x.format)?'<NumberFormat ss:Format="'+G(x.format)+'"/>':"")+"<Font"+(Q(x.bold)?' ss:Bold="'+S(x.bold)+'"':"")+(Q(x.italic)?' ss:Italic="'+S(x.italic)+'"':"")+(Q(x.color)?' ss:Color="'+x.color+'"':"")+(Q(x.fontName)?' ss:FontName="'+x.fontName+'"':"")+(Q(x.fontSize)?' ss:Size="'+x.fontSize+'"':"")+"/><Interior"+(Q(x.background)?' ss:Color="'+x.background+'" ss:Pattern="Solid"':"")+"/></Style>")),f+="<Cell"+(g?' ss:StyleID="'+g+'"':"")+(Q(d.index)?' ss:Index="'+d.index+'"':"")+(Q(d.colSpan)?' ss:MergeAcross="'+d.colSpan+'"':"")+(Q(d.rowSpan)?' ss:MergeDown="'+d.rowSpan+'"':"")+'><Data ss:Type="'+p+'">'+(Q(m)?G(m):"")+"</Data></Cell>";f+="</Row>",P.push(f)}s.push('<Worksheet ss:Name="'+(v?G(v):"Sheet1")+'"><Table>'+w.join("")+P.join("")+"</Table></Worksheet>")}return(n+='<Styles><Style ss:ID="Default" ss:Name="Normal"><Alignment ss:Vertical="Bottom"/><Borders/><Font/><Interior/><NumberFormat/><Protection/></Style>'+a.join("")+"</Styles>")+s.join("")+"</Workbook>"}}),e=n.extend({getExt:function(){return".xlsx"},getContentType:function(){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},getContent:function(e){var t=this.options,n=t.dieOnError;if(!Q(L.JSZip))return t.noLegacyFallback?void te("shield.export.OOXMLWorkbook.getContent: No ZIP library found",n):new $(t).getContent();for(var i,r,a,s,n=X(t.created||new Date),o=(t.author,t.worksheets||[]),t=o.length,l=new L.JSZip,h=[],u={},c=[],f=100,d=['<font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font>'],p=['<fill><patternFill patternType="none"/></fill>','<fill><patternFill patternType="gray125"/></fill>'],g=['<xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>'],O=q()+'<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>'+K(o,function(e,t){return'<Override PartName="/xl/worksheets/sheet'+(t+1)+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>'}).join("")+'<Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/></Types>',t=(q(),q()+'<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>Microsoft Excel</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>'+t+'</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="'+t+'" baseType="lpstr">'+K(o,function(e,t){return"<vt:lpstr>"+(e.name?G(e.name):"Sheet"+(t+1))+"</vt:lpstr>"}).join("")+"</vt:vector></TitlesOfParts><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>15.0300</AppVersion></Properties>"),m=U("&#x53;&#x68;&#x69;&#x65;&#x6C;&#x64;&#x20;&#x55;&#x49;&#x20;&#x46;&#x72;&#x61;&#x6D;&#x65;&#x77;&#x6F;&#x72;&#x6B;"),m=q()+'<cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>'+(m||"")+'</dc:creator><dcterms:created xsi:type="dcterms:W3CDTF">'+n+"</dcterms:created></cp:coreProperties>",n=q()+'<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x15" xmlns:x15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"><fileVersion appName="xl" lastEdited="6" lowestEdited="4" rupBuild="14420"/><workbookPr filterPrivacy="1" defaultThemeVersion="124226"/><sheets>'+K(o,function(e,t){return'<sheet name="'+(e.name?G(e.name):"Sheet"+(t+1))+'" sheetId="'+(t+1)+'" r:id="rId'+(t+1)+'"/>'}).join("")+"</sheets></workbook>",x=(q(),1),R=q()+'<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+K(o,function(e,t){var n=x++;return'<Relationship Id="rId'+n+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+n+'.xml"/>'}).join("")+'<Relationship Id="rId'+x+++'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/><Relationship Id="rId'+x+++'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId'+x+++'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/></Relationships>',y=(q(),0);y<o.length;y++){for(var v=o[y],b=v.columns||[],w=b.length,_=v.rows||[],z=_.length,P="",C=[],E=[],S=0;S<z;S++){for(var T=_[S],H=[],V=T.cells||[],j=V.length,M=0;M<j;M++){var k,F,D=V[M],B=D.type,A=D.value,N=Y({},D.style||{});Q(B)&&!ee(B)?B===Date?(k=W,A=ie(A),N.format||(N.format="m/d/yyyy hh:mm")):k=B===Number?W:B===Boolean?"b":"inlineStr":Z(A)?(k=W,A=ie(A),N.format||(N.format="m/d/yyyy hh:mm")):k=J(A)?W:se(A)?"b":"inlineStr",s=B=void 0,F="",N=!(N=N)||ne(N).length<=0?W:(B=oe(N),u[B]?u[B].cellXfsIndex:(Q(N.format)&&(f++,c.push('<numFmt numFmtId="'+f+'" formatCode="'+G(N.format).replace(" ","\\ ")+'"/>'),F+=' numFmtId="'+f+'" applyNumberFormat="1"'),N.background&&(p.push('<fill><patternFill patternType="solid"><fgColor rgb="'+re(N.background)+'"/></patternFill></fill>'),F+=' fillId="'+(p.length-1)+'" applyFill="1"'),(Q(N.bold)||Q(N.color)||Q(N.fontName)||Q(N.fontSize)||Q(N.italic))&&(d.push("<font>"+(Q(N.bold)?'<b val="'+!!N.bold+'"/>':"")+(Q(N.color)?'<color rgb="'+re(N.color)+'"/>':"")+(Q(N.fontName)?'<name val="'+N.fontName+'"/>':"")+(Q(N.fontSize)?'<sz val="'+N.fontSize+'"/>':"")+(Q(N.italic)?'<i val="'+!!N.italic+'"/>':"")+"</font>"),F+=' fontId="'+(d.length-1)+'" applyFont="1"'),(Q(N.textAlign)||Q(N.verticalAlign)||Q(N.wrap))&&(s="<alignment"+(Q(N.textAlign)?' horizontal="'+N.textAlign+'"':"")+(Q(N.verticalAlign)?' vertical="'+N.verticalAlign+'"':"")+(Q(N.wrap)?' wrapText="'+!!N.wrap+'"':"")+"/>"),F||s?(g.push("<xf"+(F||"")+(s?">"+s+"</xf>":"/>")),u[B]={cellXfsIndex:g.length-1},g.length-1):W)),F=(A+"").length,(!Q(C[M])||C[M]<F)&&(C[M]=F),H.push("<c"+(Q(D.index)?' r="'+ae(Q(T.index)?T.index:S+1,D.index)+'"':"")+(Q(k)?' t="'+k+'"':"")+(Q(N)?' s="'+N+'"':"")+">"+("inlineStr"==k?"<is><t>"+G(A)+"</t></is>":"<v>"+A+"</v>")+"</c>")}E.push("<row"+(Q(T.index)?' r="'+T.index+'"':"")+(Q(T.height)?' ht="'+T.height+'" customHeight="1"':"")+">"+H.join("")+"</row>")}if(0<w){for(P="<cols>",M=0;M<w;M++){var I=b[M];P+="<col"+(Q(I.index)?' min="'+I.index+'" max="'+I.index+'"':' min="'+(M+1)+'" max="'+(M+1)+'"')+(Q(I.width)?' width="'+(r=I.width,a=Q(a=void 0)?a:7,((r-5)/7*100+.5)/100)+'"':"")+(!0!==I.autoWidth&&Q(I.width)?"":' width="'+(C[M]*(a=Q(a=void 0)?a:7)+5)/a*256/256+'"')+(!0===I.autoWidth?' bestFit="1"':"")+(Q(I.autoWidth)||Q(I.width)?' customWidth="1"':"")+"/>"}P+="</cols>"}v=q()+'<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><dimension ref="A1"/><sheetViews><sheetView tabSelected="1" workbookViewId="0"/></sheetViews><sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'+P+"<sheetData>"+E.join("")+'</sheetData><pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/></worksheet>',h.push(v)}for(i=q()+'<styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="'+c.length+'">'+c.join("")+'</numFmts><fonts count="'+d.length+'" x14ac:knownFonts="1">'+d.join("")+'</fonts><fills count="'+p.length+'">'+p.join("")+'</fills><borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+g.length+'">'+g.join("")+'</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles><dxfs count="0"/><tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleMedium9"/><extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"><x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext><ext uri="{9260A510-F301-46a8-8635-F512D64BE5F5}" xmlns:x15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"><x15:timelineStyles defaultTimelineStyle="TimeSlicerStyleLight1"/></ext></extLst></styleSheet>',l.file("[Content_Types].xml",O),l.file("_rels/.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>'),l.file("docProps/app.xml",t),l.file("docProps/core.xml",m),l.file("xl/workbook.xml",n),l.file("xl/styles.xml",i),l.file("xl/sharedStrings.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"/>'),l.file("xl/_rels/workbook.xml.rels",R),l.file("xl/theme/theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria" panose="020F0302020204030204"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface=" "/><a:font script="Hang" typeface=" "/><a:font script="Hans" typeface=""/><a:font script="Hant" typeface=""/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:majorFont><a:minorFont><a:latin typeface="Calibri" panose="020F0502020204030204"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface=" "/><a:font script="Hang" typeface=" "/><a:font script="Hans" typeface=""/><a:font script="Hant" typeface=""/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:shade val="93000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>'),y=0;y<h.length;y++)l.file("xl/worksheets/sheet"+(y+1)+".xml",h[y]);return e&&"string"!=e.type&&L.JSZip.support.uint8array?l.generate({type:"uint8array"}):l.generate({type:"string"})},saveAs:function(e){var t=this.options;return Q(L.JSZip)?n.fn.saveAs.call(this,e):t.noLegacyFallback?void te("shield.export.OOXMLWorkbook.saveAs: No ZIP library found",t.dieOnError):new $(t).saveAs(e)}}),r={unit:"pt",textColor:"0 g",drawColor:"0 G",fontSize:12,lineHeight:1.15,lineWidth:.200025,producer:"ShieldUI PDF Builder",created:new Date},i=n.extend({_version:"1.3",_formats:{a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"credit-card":[153,243]},_documentProps:["title","subject","author","keywords",y],_capJoinStyles:{0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},_noMargins:{left:0,top:0,bottom:0},init:function(e){this.options=Y(!0,r,e,{});var e=this,t=e.options;t.dieOnError;e._scaleFactor=e._getScaleFactor(),e._fontSize=t.fontSize,e._textColor=t.textColor,e._objectNumber=2,e._printToDoc=!0,e._offsets=[],e._fonts={},e._fontmap={},e._pages=[],e._pagesContext=[],e._pageDim=[],e._content=[],e._additionalObjects=[],e._page=e._lineCapID=e._lineJoinID=e._contentLength=0,e._fontKey=e._tmp=e._currentPage=e._pageWidth=e._pageHeight=e._pageMode=e._zoomMode=e._layoutMode=W,e._cellPadding=3,e._cellMargin=13,e._lastCellPos={x:W,y:W,w:W,h:W,ln:W},e._cellHeaderFunction=e._tablePrintHeader=e._cellMargins=e._cellTableHeaderRow=e._cellPrintingHeaderRow=e._tableFontSize=W,e._cellPages=1,e.addFonts(),e._fontKey="F1"},getExt:function(){return".pdf"},getContentType:function(){return"application/pdf"},getContent:function(e){return e&&"string"!=e.type?this._getArrayBuffer():this._build()},_toString:function(e){return(""+e).toLowerCase()},_getScaleFactor:function(){var e=this.options.unit;switch(e){case"pt":return 1;case"mm":return 72/25.4000508;case"cm":return 72/2.54000508;case"in":return 72;case"px":return 96/72;case"pc":case"em":return 12;case"ex":return 6;default:return void te("shieldExport: Invalid measurement unit: "+e,this.options.dieOnError)}},_setNumberPrecision:function(e,t){return e.toFixed(t)},_setPadding:function(e,t,n){return("0"+parseInt(e,t)).slice(-n)},_write:function(e){var t=this;t._printToDoc?(t._contentLength+=e.length+1,t._content.push(e)):t._pages[t._currentPage].push(e)},_createObject:function(){var e=this;return e._objectNumber++,e._offsets[e._objectNumber]=e._contentLength,e._write(e._objectNumber+" 0 obj"),e._objectNumber},_createAdditionalObject:function(){var e={objId:2*this._pages.length+1+this._additionalObjects.length,content:""};return this._additionalObjects.push(e),e},_createObjectDeferred:function(){var e=this;return e._objectNumber++,e._offsets[e._objectNumber]=function(){return e._contentLength},e._objectNumber},_createObjectDeferredBegin:function(e){this._offsets[e]=this._contentLength},_writeStream:function(e){this._write("stream"),this._write(e),this._write("endstream")},_writePages:function(){for(var e,t,n,i,r=this,a=(r.options,r._pages,r._pageDim),s=1;s<=r._page;s++)r._createObject(),t=(r._pageWidth=a[s].width)*r._scaleFactor,n=(r._pageHeight=a[s].height)*r._scaleFactor,r._write("<</Type /Page"),r._write("/Parent 1 0 R"),r._write("/Resources 2 0 R"),r._write("/MediaBox [0 0 "+r._setNumberPrecision(t,2)+" "+r._setNumberPrecision(n,2)+"]"),r._write("/Contents "+(r._objectNumber+1)+" 0 R"),r._write(">>"),r._write("endobj"),t=r._pages[s].join("\n"),r._createObject(),r._write("<</Length "+t.length+">>"),r._writeStream(t),r._write("endobj");for(r._offsets[1]=r._contentLength,r._write("1 0 obj"),r._write("<</Type /Pages"),i="/Kids [",e=0;e<r._page;e++)i+=3+2*e+" 0 R ";r._write(i+"]"),r._write("/Count "+r._page),r._write(">>"),r._write("endobj")},_writeFont:function(e){var t=this;e.objectNumber=t._createObject(),t._write("<</BaseFont/"+e.PostScriptName+"/Type/Font"),"string"==typeof e.encoding&&t._write("/Encoding/"+e.encoding),t._write("/Subtype/Type1>>"),t._write("endobj")},_writeFonts:function(){var e,t=this._fonts;for(e in t)t.hasOwnProperty(e)&&this._writeFont(t[e])},_writeXObjectDictionary:function(){},_writeResourceDictionary:function(){var e,t=this,n=t._fonts;for(e in t._write("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),t._write("/Font <<"),n)n.hasOwnProperty(e)&&t._write("/"+e+" "+n[e].objectNumber+" 0 R");t._write(">>"),t._write("/XObject <<"),t._writeXObjectDictionary(),t._write(">>")},_writeResources:function(){var e=this,t=e._offsets;e._writeFonts(),t[2]=e._contentLength,e._write("2 0 obj"),e._write("<<"),e._writeResourceDictionary(),e._write(">>"),e._write("endobj")},_writeAdditionalObjects:function(){for(var e,t=this,n=t._offsets,i=t._additionalObjects,r=0;r<i.length;r++)n[(e=i[r]).objId]=t._contentLength,t._write(e.objId+" 0 obj"),t._write(e.content),t._write("endobj");t._objectNumber+=i.length},_writeToFontDictionary:function(e,t,n){this._fontmap.hasOwnProperty(t)||(this._fontmap[t]={}),this._fontmap[t][n]=e},_to8bitStream:function(e,t){var n,i,r,a,s,o,l=this._fonts,h=this._fontKey,u=(t=t||{}).sourceEncoding||"Unicode",c=t.outputEncoding;if((t.autoencode||c)&&l[h].metadata&&l[h].metadata[u]&&l[h].metadata[u].encoding&&(u=l[h].metadata[u].encoding,!(c=!c&&l[h].encoding?l[h].encoding:c)&&u.codePages&&(c=u.codePages[0]),c=M(c)?u[c]:c)){for(i=!1,n=[],o=0,s=e.length;o<s;o++)(a=c[e.charCodeAt(o)])?n.push(String.fromCharCode(a)):n.push(e[o]),n[o].charCodeAt(0)>>8&&(i=!0);e=n.join("")}for(o=e.length;void 0===i&&0!==o;)e.charCodeAt(o-1)>>8&&(i=!0),o--;if(!i)return e;for(n=t.noBOM?[]:[254,255],o=0,s=e.length;o<s;o++){if((r=(a=e.charCodeAt(o))>>8)>>8)return void te("shieldExport: Character at position "+o+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE",this.options.dieOnError);n.push(r),n.push(a-(r<<8))}return String.fromCharCode.apply(W,n)},_escape:function(e,t){return this._to8bitStream(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},_writeInfo:function(){var e,t,n,i,r,a=this,s=a.options,o=s.producer,l=s.created,h=a._documentProps;for(Q(o)&&a._write("/Producer ("+o+")"),r=0;r<h.length;r++)i=s[n=h[r]],(i="author"!==n&&n!==y?i:U("&#x53;&#x68;&#x69;&#x65;&#x6C;&#x64;&#x20;&#x55;&#x49;&#x20;&#x46;&#x72;&#x61;&#x6D;&#x65;&#x77;&#x6F;&#x72;&#x6B;"))&&a._write("/"+E(n)+" ("+a._escape(i)+")");t=(l=(o=m(l)).getTimezoneOffset())<0?"+":"-",e=Math.floor(Math.abs(l/60)),l=Math.abs(l%60),t=[t,a._setPadding(e,10,2),"'",a._setPadding(l,10,2),"'"].join(""),a._write(["/CreationDate (D:",o.getFullYear(),a._setPadding(o.getMonth()+1,10,2),a._setPadding(o.getDate(),10,2),a._setPadding(o.getHours(),10,2),a._setPadding(o.getMinutes(),10,2),a._setPadding(o.getSeconds(),10,2),t,")"].join(""))},_writeCatalog:function(){var e,t=this;switch(t._write("/Type /Catalog"),t._write("/Pages 1 0 R"),t._zoomMode||(t._zoomMode="fullwidth"),t._zoomMode){case"fullwidth":t._write("/OpenAction [3 0 R /FitH null]");break;case"fullheight":t._write("/OpenAction [3 0 R /FitV null]");break;case"fullpage":t._write("/OpenAction [3 0 R /Fit]");break;case"original":t._write("/OpenAction [3 0 R /XYZ null null 1]");break;default:"%"===(e=""+t._zoomMode).substr(e.length-1)&&(t._zoomMode=parseInt(t._zoomMode,10)/100),J(t._zoomMode)&&t._write("/OpenAction [3 0 R /XYZ null null "+t._setNumberPrecision(t._zoomMode,2)+"]")}switch(t._layoutMode||(t._layoutMode="continuous"),t._layoutMode){case"continuous":t._write("/PageLayout /OneColumn");break;case"single":t._write("/PageLayout /SinglePage");break;case"two":case"twoleft":t._write("/PageLayout /TwoColumnLeft");break;case"tworight":t._write("/PageLayout /TwoColumnRight")}t._pageMode&&t._write("/PageMode /"+t._pageMode)},_writeTrailer:function(){var e=this._objectNumber;this._write("/Size "+(e+1)),this._write("/Root "+e+" 0 R"),this._write("/Info "+(e-1)+" 0 R")},addFont:function(e,t,n,i){var r="F"+(ne(this._fonts).length+1).toString(10);this._fonts[r]={id:r,PostScriptName:e,fontName:t,fontStyle:n,encoding:i,metadata:{}};return this._writeToFontDictionary(r,t,n),r},addFonts:function(){for(var e,t,n=[["Helvetica",s,p],["Helvetica-Bold",s,g],["Helvetica-Oblique",s,a],["Helvetica-BoldOblique",s,v],["Courier",d,p],["Courier-Bold",d,g],["Courier-Oblique",d,a],["Courier-BoldOblique",d,v],["Times-Roman",f,p],["Times-Bold",f,g],["Times-Italic",f,a],["Times-BoldItalic",f,v]],i=0,r=n.length;i<r;i++)e=this.addFont(n[i][0],n[i][1],n[i][2],"StandardEncoding"),t=n[i][0].split("-"),this._writeToFontDictionary(e,t[0],t[1]||"")},getActiveFontObj:function(){var e=this._fonts,t=this._fontKey;return e&&t&&e[t]?e[t]:W},getFontObj:function(e,t){var n=this._fonts,e=this.getFont(e,t);return n&&e&&n[e]?n[e]:W},getFont:function(e,t){var n,i=this,r=i._fonts,a=i._fontmap;switch(e=Q(e)?e:r[i._fontKey].fontName,t=Q(t)?t:i._fontKey?r[i._fontKey].fontStyle:W,Q(e)&&(e=e.toLowerCase()),t){case"sans-serif":case"verdana":case"arial":e=s;break;case"fixed":case"monospace":case"terminal":e=d;break;default:e=f}try{n=a[e][t]}catch(e){}return n||null==(n=a[f][t])&&(n=a[f][p]),n},_setPage:function(e){var t=this,n=t._pageDim;0<e&&e<=t._page&&(t._currentPage=e,t._pageWidth=n[e].width,t._pageHeight=n[e].height)},_beginPage:function(e,t){var n,i=this,r=i._formats,a=i._pages,s=i._pageDim,o=i._pagesContext,l=M(t)&&t.toLowerCase();if(M(e)&&(n=e.toLowerCase(),r.hasOwnProperty(n)&&(e=r[n][0]/i._scaleFactor,t=r[n][1]/i._scaleFactor)),k(e)&&(t=e[1],e=e[0]),l){switch(l.substr(0,1)){case"l":e<t&&(l="s");break;case"p":t<e&&(l="s")}"s"===l&&(i._tmp=e,e=t,t=i._tmp)}i._printToDoc=!1,i._page++,a[i._page]=[],s[i._page]={width:Number(e)||i._pageWidth,height:Number(t)||i._pageHeight},o[i._page]={},i._setPage(i._page)},addPage:function(){var e=this,t=e.options,n=t.drawColor,t=t.lineWidth;e._beginPage.apply(e,arguments),e._write(e._setNumberPrecision(t*e._scaleFactor,2)+" w"),e._write(n),0!==e._lineCapID&&e._write(e._lineCapID+" J"),0!==e._lineJoinID&&e._write(e._lineJoinID+" j")},deletePage:function(e){var t=this,n=t._pages,i=t._pageDim;0<e&&e<=t._page&&(n.splice(e,1),i.splice(e,1),t._page--,t._currentPage>t._page&&(t._currentPage=t._page),t._setPage(t._currentPage))},getFontSize:function(){return this._fontSize},getLineHeight:function(){return this.getFontSize()*this.options.lineHeight},getCoordinateString:function(e){return this._setNumberPrecision(e*this._scaleFactor,2)},getVerticalCoordinateString:function(e){return this._setNumberPrecision((this._pageHeight-e)*this._scaleFactor,2)},getPageSize:function(){return{width:this._pageWidth,height:this._pageHeight}},getNumberOfPages:function(){return this._pages.length-1},getPages:function(){return this._pages},getPageInfo:function(e){return{objId:2*(e-1)+3,pageNumber:e,pageContext:this._pagesContext[e]}},getCurrentPageInfo:function(){return this.getPageInfo(this._currentPage)},movePage:function(e,t){var n,i,r,a,s=this,o=s._pages,l=s._pageDim,h=s._pagesContext;if(t<e){for(n=o[e],i=l[e],r=h[e],a=e;t<a;a--)o[a]=o[a-1],l[a]=l[a-1],h[a]=h[a-1];o[t]=n,l[t]=i,h[t]=r,s._setPage(t)}else if(e<t){for(n=o[e],i=l[e],r=h[e],a=e;a<t;a++)o[a]=o[a+1],l[a]=l[a+1],h[a]=h[a+1];o[t]=n,l[t]=i,h[t]=r,s._setPage(t)}return s},insertPage:function(){var e=this,t=[].slice.call(arguments),n=t.shift();return e.addPage.apply(e,t),e.movePage(e._currentPage,n),e},setDisplayMode:function(e,t,n){return this._zoomMode=e,this._layoutMode=t,this._pageMode=n,this},_ESC:function(e,t){var n=this.options;return e=e.split("\t").join(new Array(n.TabLen||9).join(" ")),this._escape(e,t)},text:function(e,t,n,i,r,a){var s,o,l,h,u,c,f,d,p,g,m=this,x="",y="Td",v="",b=m.getCurrentPageInfo().pageContext,w=m.getLineHeight();if(M(e)&&(e=e.match(/[\n\r]/)?e.split(/\r\n|\r|\n/g):[e]),M(r)&&(a=r,r=null),M(i)&&(a=i,i=null),J(i)&&(r=i,i=null),r&&(r*=Math.PI/180,s=Math.cos(r),r=Math.sin(r),x=[m._setNumberPrecision(s,2),m._setNumberPrecision(r,2),m._setNumberPrecision(-1*r,2),m._setNumberPrecision(s,2),""].join(" "),y="Tm"),"noBOM"in(i=i||{})||(i.noBOM=!0),"autoencode"in i||(i.autoencode=!0),!0===i.stroke?!0!==b.lastTextWasStroke&&(v="1 Tr\n",b.lastTextWasStroke=!0):(b.lastTextWasStroke&&(v="0 Tr\n"),b.lastTextWasStroke=!1),Q(m._runningPageHeight)||(m._runningPageHeight=0),M(e))e=m._ESC(e,i);else{if(!(e instanceof Array))return void te('Type of text must be string or Array. "'+e+'" is not recognized.',m.options.dieOnError);for(l=[],u=(o=e.concat()).length;u--;)l.push(m._ESC(o.shift(),i));if(Math.ceil((m._pageHeight-n-m._runningPageHeight)*m._scaleFactor/m.getLineHeight()),a){if(g=K(e,function(e){return m._getStringWidth(e)*m.getFontSize()/m._scaleFactor}),p=Math.max.apply(Math,g),"center"===a)c=t-p/2,t-=g[0]/2;else{if("right"!==a)return void te('Unrecognized alignment option, use "center" or "right".',m.options.dieOnError);c=t-p,t-=g[0]}for(f=t,e=l[0]+") Tj\n",h=1,u=l.length;h<u;h++)d=p-g[h],"center"===a&&(d/=2),e+=c-f+d+" -"+w+" Td ("+l[h],f=c+d,h<u-1&&(e+=") Tj\n")}else e=l.join(") Tj\nT* (")}return r=m._setNumberPrecision((m._pageHeight-n)*m._scaleFactor,2),m._write("BT\n/"+m._fontKey+" "+m.getFontSize()+" Tf\n"+m.getLineHeight()+" TL\n"+v+m._textColor+"\n"+x+m._setNumberPrecision(t*m._scaleFactor,2)+" "+r+" "+y+"\n("+e+") Tj\nET"),m},lstext:function(e,t,n,i){for(var r=0,a=e.length;r<a;r++,t+=i)this.text(e[r],t,n)},line:function(e,t,n,i){return this.lines([[n-e,i-t]],e,t)},clip:function(){this._write("W"),this._write("S")},lines:function(e,t,n,i,r,a){var s,o,l,h,u,c,f,d,p,g,m,x=this;for(J(e)&&(x._tmp=n,n=t,t=e,e=x._tmp),i=i||[1,1],x._write(x._setNumberPrecision(t*x._scaleFactor,3)+" "+x._setNumberPrecision((x._pageHeight-n)*x._scaleFactor,3)+" m "),s=i[0],o=i[1],h=e.length,g=t,m=n,l=0;l<h;l++)2===(u=e[l]).length?(g=u[0]*s+g,m=u[1]*o+m,x._write(x._setNumberPrecision(g*x._scaleFactor,3)+" "+x._setNumberPrecision((x._pageHeight-m)*x._scaleFactor,3)+" l")):(c=u[0]*s+g,f=u[1]*o+m,d=u[2]*s+g,p=u[3]*o+m,g=u[4]*s+g,m=u[5]*o+m,x._write(x._setNumberPrecision(c*x._scaleFactor,3)+" "+x._setNumberPrecision((x._pageHeight-f)*x._scaleFactor,3)+" "+x._setNumberPrecision(d*x._scaleFactor,3)+" "+x._setNumberPrecision((x._pageHeight-p)*x._scaleFactor)+" "+x._setNumberPrecision(g*x._scaleFactor)+" "+x._setNumberPrecision((x._pageHeight-m)*x._scaleFactor)+" c"));return a&&x._write(" h"),null!==r&&x._write(x.getStyle(r)),x},rect:function(e,t,n,i,r){var a=this;a.getStyle(r);return a._write([a._setNumberPrecision(e*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-t)*a._scaleFactor,2),a._setNumberPrecision(n*a._scaleFactor,2),a._setNumberPrecision(-i*a._scaleFactor,2),"re"].join(" ")),null!==r&&a._write(a.getStyle(r)),a},triangle:function(e,t,n,i,r,a,s){return this.lines([[n-e,i-t],[r-n,a-i],[e-r,t-a]],e,t,[1,1],s,!0),this},roundedRect:function(e,t,n,i,r,a,s){var o=4/3*(Math.SQRT2-1);return this.lines([[n-2*r,0],[r*o,0,r,a-a*o,r,a],[0,i-2*a],[0,a*o,-r*o,a,-r,a],[2*r-n,0],[-r*o,0,-r,-a*o,-r,-a],[0,2*a-i],[0,-a*o,r*o,-a,r,-a]],e+r,t,[1,1],s),this},ellipse:function(e,t,n,i,r){var a=this,s=4/3*(Math.SQRT2-1)*n,o=4/3*(Math.SQRT2-1)*i;return a._write([a._setNumberPrecision((e+n)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-t)*a._scaleFactor,2),"m",a._setNumberPrecision((e+n)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-(t-o))*a._scaleFactor,2),a._setNumberPrecision((e+s)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-(t-i))*a._scaleFactor,2),a._setNumberPrecision(e*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-(t-i))*a._scaleFactor,2),"c"].join(" ")),a._write([a._setNumberPrecision((e-s)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-(t-i))*a._scaleFactor,2),a._setNumberPrecision((e-n)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-(t-o))*a._scaleFactor,2),a._setNumberPrecision((e-n)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-t)*a._scaleFactor,2),"c"].join(" ")),a._write([a._setNumberPrecision((e-n)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-(t+o))*a._scaleFactor,2),a._setNumberPrecision((e-s)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-(t+i))*a._scaleFactor,2),a._setNumberPrecision(e*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-(t+i))*a._scaleFactor,2),"c"].join(" ")),a._write([a._setNumberPrecision((e+s)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-(t+i))*a._scaleFactor,2),a._setNumberPrecision((e+n)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-(t+o))*a._scaleFactor,2),a._setNumberPrecision((e+n)*a._scaleFactor,2),a._setNumberPrecision((a._pageHeight-t)*a._scaleFactor,2),"c"].join(" ")),null!==r&&a._write(a.getStyle(r)),a},circle:function(e,t,n,i){return this.ellipse(e,t,n,n,i)},setFontSize:function(e){return this._fontSize=e,this},setFont:function(e,t){return this._fontKey=this.getFont(e,t),this},setFontStyle:function(e){return this._fontKey=this.getFont(W,e),this},getFontList:function(){var e,t,n,i={},r=this._fontmap;for(e in r)if(r.hasOwnProperty(e))for(t in i[e]=n=[],r[e])r[e].hasOwnProperty(t)&&n.push(t);return i},addFontScriptName:function(e,t,n){this.addFont(e,t,n,"StandardEncoding")},setLineWidth:function(e){return this._write((e*this._scaleFactor).toFixed(2)+" w"),this},setDrawColor:function(e,t,n,i){var r=this,i=!Q(t)||!Q(i)&&e===t===n?M(e)?e+" G":r._setNumberPrecision(e/255,2)+" G":(Q(i)?M(e)?[e,t,n,i,"K"]:[r._setNumberPrecision(e,2),r._setNumberPrecision(t,2),r._setNumberPrecision(n,2),r._setNumberPrecision(i,2),"K"]:M(e)?[e,t,n,"RG"]:[r._setNumberPrecision(e/255,2),r._setNumberPrecision(t/255,2),r._setNumberPrecision(n/255,2),"RG"]).join(" ");return r._write(i),r},setFillColor:function(e,t,n,i){var r,a=this;return!Q(t)||!Q(i)&&e===t===n?r=M(e)?e+" g":a._setNumberPrecision(e/255,2)+" g":!Q(i)||B(i)?(r=(M(e)?[e,t,n,"rg"]:[a._setNumberPrecision(e/255,2),a._setNumberPrecision(t/255,2),a._setNumberPrecision(n/255,2),"rg"]).join(" "),i&&0===i.a&&(r=["255","255","255","rg"].join(" "))):r=(M(e)?[e,t,n,i,"k"]:[a._setNumberPrecision(e,2),a._setNumberPrecision(t,2),a._setNumberPrecision(n,2),a._setNumberPrecision(i,2),"k"]).join(" "),a._write(r),a},setTextColor:function(e,t,n){var i,r=this;return M(e)&&/^#[0-9A-Fa-f]{6}$/.test(e)&&(e=(i=parseInt(e.substr(1),16))>>16&255,t=i>>8&255,n=255&i),0===e&&0===t&&0===n||!Q(t)?r._textColor=r._setNumberPrecision(e/255,3)+" g":r._textColor=[r._setNumberPrecision(e/255,3),r._setNumberPrecision(t/255,3),r._setNumberPrecision(n/255,3),"rg"].join(" "),r},_build:function(){var e,t,n,i,r=this;for(r._printToDoc=!0,r._objectNumber=2,r._write("%PDF-"+r._version),r._writePages(),r._writeAdditionalObjects(),r._writeResources(),r._createObject(),r._write("<<"),r._writeInfo(),r._write(">>"),r._write("endobj"),r._createObject(),r._write("<<"),r._writeCatalog(),r._write(">>"),r._write("endobj"),e=r._contentLength,t="0000000000",r._write("xref"),r._write("0 "+(r._objectNumber+1)),r._write(t+" 65535 f "),i=1;i<=r._objectNumber;i++)n=r._offsets[i],D(n)?r._write((t+r._offsets[i]()).slice(-10)+" 00000 n "):r._write((t+r._offsets[i]).slice(-10)+" 00000 n ");return r._write("trailer"),r._write("<<"),r._writeTrailer(),r._write(">>"),r._write("startxref"),r._write(e),r._write("%%EOF"),r._printToDoc=!1,r._content.join("\n")},getStyle:function(e){var t="S";return"F"===e?t="F".toLowerCase():"FD"===e||"DF"===e?t="B":e!=="F".toLowerCase()&&"f*"!==e&&"both"!==e&&"B*"!==e||(t=e),t},_getArrayBuffer:function(){for(var e=this._build(),t=e.length,n=new ArrayBuffer(t),i=new Uint8Array(n);t--;)i[t]=e.charCodeAt(t);return n},_getCharWidths:function(e,t){for(var n,t=t||{},i=this.getActiveFontObj(),r=t.widths||i.metadata.Unicode.widths,a=r.fof||1,s=t.kerning||i.metadata.Unicode.kerning,o=s.fof||1,l=0,h=r[0]||a,u=[],c=0,f=e.length;c<f;c++)n=e.charCodeAt(c),u.push((r[n]||h)/a+(s[n]&&s[n][l]||0)/o),l=n;return u},_sum:function(e){for(var t=e.length,n=0;t;)n+=e[--t];return n},_getStringWidth:function(e,t){return this._sum(this._getCharWidths.call(this,e,t))},_getTextDimensions:function(t){var n=this.getActiveFontObj(),e=n.fontName,i=this._tableFontSize||this.getFontSize(),n=n.fontStyle,r=_.createElement("font");try{r.style.fontStyle=n}catch(e){r.style.fontWeight=n}r.style.fontName=e,r.style.fontSize=i+"pt";try{r.textContent=t}catch(e){r.innerText=t}return _.body.appendChild(r),n={w:(r.offsetWidth+1)*b,h:(r.offsetHeight+1)*b},_.body.removeChild(r),n},_setLastCellPosition:function(e,t,n,i,r){this._lastCellPos={x:e,y:t,w:n,h:i,ln:r}},_getLastCellPosition:function(){return this._lastCellPos},_cellAddPage:function(){var e=this,t=e._cellMargins||e._noMargins;e.addPage(),e._setLastCellPosition(t.left,t.top),e._cellPages++},_setTableHeaderConfig:function(e){this._cellTableHeaderRow=e},_splitWord:function(e,t,n,i){for(var r,a=[],s=0,o=e.length,l=0;s!==o&&l+t[s]<n;)l+=t[s],s++;for(a.push(e.slice(0,s)),r=s,l=0;s!==o;)l+t[s]>i&&(a.push(e.slice(r,s)),l=0,r=s),l+=t[s],s++;return r!==s&&a.push(e.slice(r,s)),a},_splitParagraph:function(e,t,n){var i,r,a,s,o,l,h=this,u=n||{},c=[],f=[c],d=u.textIndent||0,p=0,g=0,m=e.split(" "),x=h._getCharWidths(" ",u)[0],y=-1===u.lineIndent?m[0].length+2:u.lineIndent||0;for(y&&(o=new Array(y).join(" "),l=[],w(m,function(e,t){1<(t=t.split(/\s*\n/)).length?l=l.concat(K(t,function(e,t){return(t&&e.length?"\n":"")+e})):l.push(t[0])}),m=l,y=h._getStringWidth(o,u)),r=0,a=m.length;r<a;r++){var v=0,b=m[r];if(y&&"\n"==b[0]&&(b=b.substr(1),v=1),i=h._getCharWidths(b,u),t<d+p+(g=h._sum(i))||v){if(t<g){for(s=h._splitWord(b,i,t-(d+p),t),c.push(s.shift()),c=[s.pop()];s.length;)f.push([s.shift()]);g=h._sum(i.slice(b.length-c[0].length))}else c=[b];f.push(c),d=g+y,p=x}else c.push(b),d+=p+g,p=x}return K(f,y?function(e,t){return(t?o:"")+e.join(" ")}:function(e){return e.join(" ")})},_splitText:function(e,t,n){var i,r,a=this,n=n||{},s=k(e)?e.join(" "):e,s=a._getTextDimensions(s).w/s.length,o=[],l=function(e){var t,n={0:1},i={};return e.widths&&e.kerning?{widths:e.widths,kerning:e.kerning}:(e=a.getFontObj(e.fontName,e.fontStyle)||a.getActiveFontObj()).metadata[t="Unicode"]?{widths:e.metadata[t].widths||n,kerning:e.metadata[t].kerning||i}:{widths:n,kerning:i}}.call(a,n),h=k(e)?e:e.split(/\r?\n/),u=+a._scaleFactor*t/s;for(l.textIndent=n.textIndent?+n.textIndent*a._scaleFactor/s:0,l.lineIndent=n.lineIndent,i=0,r=h.length;i<r;i++)o=o.concat(a._splitParagraph(h[i],u,l));return o},_getLineHeight:function(e,t,n){for(var i,r,a=0,s=this._cellPadding,o=0;o<e.length;o++)r=e[o],i=k(n)?n[o]:n[r],k(i)||(!Q(i)||ee(i)?i="":i+=""),i=k(n)?(n[o]=this._splitText(i,t[r]-s),n[o].length):(n[r]=this._splitText(i,t[r]-s),n[r].length),a<(r=this.getLineHeight()*i+1.6*s)&&(a=r);return a},_cell:function(e,t,n,i,r,a,s){var o,l,h,u=this,c=u._getLastCellPosition(),f=u._cellMargins||u._noMargins,d=u._cellPadding;if(Q(c.ln)&&(t=c.ln===a?(e=c.x+c.w,c.y):(c.y+c.h+i+u._cellMargin>=u._pageHeight-f.bottom&&(u._cellAddPage(),u._tablePrintHeader&&u._cellTableHeaderRow&&u._renderHeader(a,!0)),(c=u._getLastCellPosition()).y+(c.h||0))),Q(r[0]))if(u._cellPrintingHeaderRow?u.rect(e,t,n,i,"FD"):u.rect(e,t,n,i),"right"===s)for(k(r)||(r=[r]),h=0;h<r.length;h++)o=r[h],l=u._getStringWidth(o)*u.getFontSize(),u.text(o,e+n-l-d,t+u.getLineHeight()*(h+1));else u.text(r,e+d,t+u.getLineHeight());return u._setLastCellPosition(e,t,n,i,a),u},_renderHeader:function(e,t){var n,i,r,a,s=this,o=[];if(s._cellTableHeaderRow){for(s._cellPrintingHeaderRow=!0,Q(s._cellHeaderFunction)&&(a=s._cellHeaderFunction.call(s,s._cellPages),s._setLastCellPosition(a[0],a[1],a[2],a[3],-1)),s.setFontStyle(g),i=0,r=s._cellTableHeaderRow.length;i<r;i++)s.setFillColor(236,237,238),n=s._cellTableHeaderRow[i],t&&(n[1]=s._cellMargins&&s._cellMargins.top||0,o.push(n)),n=[].concat(n),s._cell.apply(s,n.concat(e));0<o.length&&s._setTableHeaderConfig(o),s.setFontStyle(p),s._cellPrintingHeaderRow=!1}else te("shieldExport: No table header configuration",s.options.dieOnError)},table:function(e,t,n,i,r){function a(e){return e[s]}var s,o,l,h,u,c,f,d,p,g,m,x,y,v=this,b=v._cellPadding,w=[],_=[],P={},C=[],E=!0,S=v.getFontSize(),T=v._noMargins;if(n){if(y=n.slice(0),r&&(!1===r.printHeader&&(E=!1),r.fontSize&&(S=r.fontSize),r.margins&&(T=r.margins)),v._lastCellPos={x:W,y:W,w:W,h:W,ln:W},v._cellPages=1,v._tablePrintHeader=E,v._cellMargins=T,v.setFontSize(S),v._tableFontSize=S,!Q(i)||ee(i))w=ne(y[0]);else if(i[0]&&!M(i[0]))for(l=0,h=i.length;l<h;l++)s=i[l],w.push(s.field),_.push(s.title),P[s.field]=Q(s.width)?F(s.width)*v._getScaleFactor():W;else w=i;for(l=0,h=w.length;l<h;l++)if(s=w[l],!Q(P[s])){for((d=[]).push(v._getTextDimensions(_[l]||s).w+2*b),p=0,u=(f=K(y,a)).length;p<u;p++)c=f[p],d.push(v._getTextDimensions(c).w+2*b);P[s]=Math.max.apply(Math,d)}if(E){for(x=v._getLineHeight(w,P,_.length?_:w),l=0,h=w.length;l<h;l++)s=w[l],o=_.length?_[l]:s,k(o)||(o+=""),C.push([e,t,P[s],x,o]);v._setTableHeaderConfig(C),v._renderHeader(1,!1)}for(l=0,h=y.length;l<h;l++)for(g=y[l],x=v._getLineHeight(w,P,g),p=0,m=w.length;p<m;p++)s=w[p],v._cell(e,t,P[s],x,g[s],l+2,i[p].align);return v}te("shieldExport: No data specified for PDF table",v.options.dieOnError)}}),t=n.extend({getExt:function(){return".csv"},getContentType:function(){return"text/csv;charset=utf-8"},getContent:function(e){function t(e){return(e+"").replace(c,'""')}var n,i,r,a=this.options,s=a.delimiter||",",o=a.header,l=a.records||[],h=l.length,u="",c=/\"/g;if(a.printHeader&&o){for(n=0;n<o.length;n++)u+=(0<n?s:"")+'"'+t(o[n])+'"';u+="\n"}for(n=0;n<h;n++){for(i=0,r=l[n].length;i<r;i++)u+=(0<i?s:"")+'"'+t(l[n][i])+'"';u+="\n"}return u}}),Y(c,{PDFDocument:i,CSVDocument:t,OOXMLWorkbook:e,ExcelXMLSpreadsheet:$})}(jQuery,shield,this);
shield.version='1.7.44';